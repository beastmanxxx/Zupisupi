<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Welcome</title>
    <link rel="manifest" href="/manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Honk&family=Macondo&family=Mrs+Sheppards&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Login Screen Styles */
        .login-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .logo-section {
            margin-bottom: 30px;
        }

        .logo-section img {
            height: 80px;
            width: auto;
            margin-bottom: 20px;
        }

        .logo-section h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .logo-section p {
            color: #718096;
            font-size: 16px;
        }

        .google-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            background: white;
            border: 2px solid #dadce0;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 500;
            color: #3c4043;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            margin: 30px 0;
        }

        .google-login-btn:hover {
            background: #f8f9fa;
            border-color: #dadce0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .google-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .divider {
            margin: 20px 0;
            position: relative;
            color: #a0aec0;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e2e8f0;
        }

        .divider span {
            background: white;
            padding: 0 15px;
        }

        /* Main App Styles (Hidden Initially) */
        .main-app {
            display: none;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            height: 90px;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo img {
            height: 55px;
            width: auto;
            object-fit: contain;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            background: none;
            border: none;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a5568;
            position: relative;
        }

        .icon-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .icon-btn svg {
            width: 28px;
            height: 28px;
        }

        .cart-btn {
            position: relative;
        }

        .cart-icon-container {
            position: relative;
            display: inline-block;
        }

        .cart-icon {
            filter: brightness(0.6);
            font-size: 24px;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .logout-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #ff3742;
            transform: translateY(-2px);
        }

        .main-content {
            margin-top: 105px;
            padding: 0;
            text-align: center;
            background: white;
            min-height: calc(100vh - 90px);
        }

        .welcome-message {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        /* Slideshow Styles */
        .slideshow-container {
            position: relative;
            max-width: 800px;
            margin: 15px 10px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .slides {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slides.active {
            display: block;
        }

        .slides img {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 200px;
            object-fit: contain;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Slideshow indicators */
        .dots-container {
            text-align: center;
            margin-top: 20px;
        }

        .dot {
            height: 12px;
            width: 12px;
            margin: 0 5px;
            background-color: #bdc3c7;
            border-radius: 50%;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active, .dot:hover {
            background-color: #717171;
        }

        /* Categories Section Styles */
        .categories-section {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-title {
            text-align: center;
            font-size: 36px;
            color: #000000;
            margin-bottom: 30px;
            font-weight: 400;
            font-family: "Mrs Sheppards", cursive;
            letter-spacing: -0.5px;
            text-shadow: 3px 3px 8px rgba(255, 215, 0, 0.8);
        }

        .categories-grid {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            margin-top: 20px;
            padding: 10px 0;
            scroll-behavior: smooth;
        }

        .categories-grid::-webkit-scrollbar {
            height: 8px;
        }

        .categories-grid::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .categories-grid::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        .categories-grid::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .category-item {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 100px;
            flex-shrink: 0;
        }

        .category-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .category-image {
            width: 100%;
            height: 75px;
            object-fit: cover;
        }

        .category-info {
            padding: 8px;
            text-align: center;
        }

        .category-name {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
            line-height: 1.2;
        }

        /* Featured Products Section Styles */
        .products-section {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        @media (max-width: 480px) {
            .products-grid {
                gap: 10px;
            }
            
            .product-card {
                border-radius: 10px;
            }
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .product-image {
            width: 100%;
            height: 150px;
            object-fit: contain;
            display: block;
            background: #f8f9fa;
        }

        @media (max-width: 768px) {
            .product-image {
                height: 120px;
            }
        }

        @media (max-width: 480px) {
            .product-image {
                height: 100px;
            }
        }

        .product-info {
            padding: 20px;
        }

        @media (max-width: 768px) {
            .product-info {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .product-info {
                padding: 12px;
            }
        }

        .product-name {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .product-name {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .product-name {
                font-size: 14px;
            }
        }

        .product-description {
            display: none;
        }

        .product-price {
            font-size: 20px;
            font-weight: 700;
            color: #27ae60;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .product-price {
                font-size: 18px;
                margin-bottom: 12px;
            }
        }

        @media (max-width: 480px) {
            .product-price {
                font-size: 16px;
                margin-bottom: 10px;
            }
        }

        .product-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .product-buttons {
                gap: 6px;
            }
        }

        @media (max-width: 480px) {
            .product-buttons {
                gap: 5px;
            }
        }

        .btn-cart, .btn-order {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .btn-cart, .btn-order {
                padding: 10px 12px;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .btn-cart, .btn-order {
                padding: 8px 10px;
                font-size: 12px;
            }
        }

        .btn-cart {
            background: #2c3e50;
            color: white;
        }

        .btn-cart:hover {
            background: #1a252f;
            transform: translateY(-2px);
        }

        .btn-order {
            background: #f1c40f;
            color: #2c3e50;
        }

        .btn-order:hover {
            background: #f39c12;
            transform: translateY(-2px);
        }

        /* Product Detail Modal */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .product-modal-content {
            background: white;
            border-radius: 12px;
            width: 85%;
            max-width: 450px;
            max-height: 75vh;
            overflow-y: auto;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }

        .product-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
        }

        .product-modal-header h2 {
            font-size: 18px;
            margin: 0;
        }

        .product-modal-body {
            padding: 20px;
        }

        .product-modal-image {
            width: 100%;
            height: 180px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }

        .product-modal-name {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .product-modal-price {
            font-size: 22px;
            font-weight: 700;
            color: #e74c3c;
            margin-bottom: 15px;
        }

        .product-modal-description {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .product-modal-quantity {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 15px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .quantity-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: #3498db;
            color: white;
        }

        .quantity-input {
            width: 50px;
            height: 30px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
        }

        .total-price {
            font-size: 16px;
            font-weight: 700;
            color: #27ae60;
            margin-left: auto;
        }

        .product-modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .product-modal-buttons .btn-cart,
        .product-modal-buttons .btn-order {
            flex: 1;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Cart Section Styles */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 2000;
            overflow-y: auto;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h2 {
            margin: 0;
            color: #2c3e50;
        }

        .cart-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .cart-items {
            padding: 20px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 8px;
            background: #f8f9fa;
            margin-right: 15px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #27ae60;
            font-weight: 700;
        }

        .cart-item-remove {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .cart-empty {
            text-align: center;
            color: #666;
            padding: 40px 20px;
        }

        .cart-total {
            padding: 20px;
            border-top: 2px solid #eee;
            background: #f8f9fa;
        }

        .cart-total-amount {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .cart-checkout {
            width: 100%;
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            display: none;
        }

        @media (max-width: 768px) {
            .cart-sidebar {
                width: 100%;
                right: -100%;
            }
        }

        /* New App Bottom Navigation - Only visible in main app */
        .app-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 0;
            height: 65px;
        }

        /* Hide navbar by default */
        .app-bottom-nav.hidden {
            display: none !important;
        }

        .app-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-width: 60px;
            position: relative;
        }

        .app-nav-item:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateY(-2px);
        }

        .app-nav-item.active {
            background: #3498db;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .app-nav-icon {
            font-size: 18px;
            margin-bottom: 3px;
            transition: transform 0.3s ease;
        }

        .app-nav-item.active .app-nav-icon {
            transform: scale(1.1);
        }

        .app-nav-label {
            font-size: 11px;
            font-weight: 600;
            text-align: center;
        }

        /* Cart count badge in bottom navbar */
        .cart-nav-item .app-nav-icon {
            position: relative;
        }

        .cart-nav-item .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            min-width: 18px;
        }

        /* Add bottom padding to main content to avoid overlap */
        .main-app {
            padding-bottom: 75px; /* Space for new navbar */
        }

        /* Desktop responsive design with bottom navbar */
        @media (min-width: 769px) {
            .main-app {
                padding-bottom: 75px; /* Space for new navbar */
            }
            
            .login-container {
                max-width: 400px;
            }
        }

        /* App Sections Styles */
        .app-section {
            display: none;
        }

        .app-section.active {
            display: block;
        }

        /* Search Section Styles */
        .search-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .search-header {
            margin-bottom: 30px;
        }

        .search-bar-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: #3498db;
        }

        .search-btn {
            padding: 15px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #2980b9;
        }

        /* Orders Section Styles */
        .orders-page, .profile-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .coming-soon {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .coming-soon-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .coming-soon h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        /* Cart Section Styles */
        .cart-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .cart-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .cart-items-main {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .cart-item-main {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item-main:last-child {
            border-bottom: none;
        }

        .cart-item-image-main {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 8px;
            background: #f8f9fa;
            margin-right: 15px;
            cursor: pointer;
        }

        .cart-item-info-main {
            flex: 1;
            cursor: pointer;
        }

        .cart-item-name-main {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .cart-item-price-main {
            color: #27ae60;
            font-weight: 700;
            font-size: 14px;
        }

        .cart-item-remove-main {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .cart-item-remove-main:hover {
            background: #c0392b;
        }

        .cart-empty-main {
            text-align: center;
            color: #666;
            padding: 60px 20px;
            font-size: 16px;
        }

        .cart-total-main {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .cart-total-amount-main {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .cart-checkout-main {
            width: 100%;
            max-width: 300px;
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .cart-checkout-main:hover {
            background: #229954;
        }

        /* Profile Section Styles */
        .profile-content {
            max-width: 400px;
            margin: 0 auto;
        }

        .profile-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .profile-avatar {
            margin-bottom: 20px;
        }

        .profile-avatar img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-info h3 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: #666;
            font-size: 16px;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .profile-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .profile-btn:hover {
            background: #c0392b;
        }

        /* Admin Panel Styles */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .admin-modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 1px solid #eee;
        }

        .admin-header h2 {
            margin: 0;
            color: #2c3e50;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #333;
        }

        .admin-tabs {
            display: flex;
            border-bottom: 1px solid #eee;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #3498db;
            border-bottom: 2px solid #3498db;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h3 {
            margin-top: 0;
            color: #2c3e50;
        }

        .slide-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .slide-form input {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .slide-form button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .slide-form button:hover {
            background: #2980b9;
        }

        .slide-item, .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .slide-info, .user-info {
            flex: 1;
        }

        .slide-title-admin, .user-name {
            font-weight: bold;
            color: #2c3e50;
        }

        .slide-url, .user-email {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-success {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-success:hover {
            background: #229954;
        }

        .admin-badge {
            background: #f39c12;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            margin-left: 10px;
        }

        .slide-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            color: white;
            padding: 30px 20px 20px;
            text-align: left;
        }

        .slide-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .slide-description {
            font-size: 16px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .login-container {
                padding: 30px 20px;
            }

            .nav-container {
                padding: 0 15px;
            }

            .nav-actions {
                gap: 15px;
            }

            .slides img {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 150px;
                object-fit: contain;
            }

            .slideshow-container {
                margin: 10px 5px 0;
            }

            .categories-grid {
                gap: 15px;
                padding: 10px 15px;
            }

            .category-item {
                min-width: 90px;
            }

            .category-image {
                height: 60px;
            }

            .category-name {
                font-size: 13px;
                color: #2c3e50;
                font-weight: 600;
            }

            .category-info {
                padding: 8px;
            }

            /* Admin Panel Mobile Styles */
            .admin-modal-content {
                width: 95%;
                max-height: 90vh;
                margin: 20px;
            }

            .admin-header {
                padding: 15px 20px;
            }

            .admin-header h2 {
                font-size: 20px;
            }

            .admin-tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                padding: 12px 8px;
                font-size: 14px;
                min-width: 0;
                flex: 1;
            }

            .tab-content {
                padding: 20px 15px;
            }

            .slide-form {
                flex-direction: column;
                gap: 15px;
            }

            .slide-form input {
                min-width: auto;
                width: 100%;
            }

            .slide-form button {
                width: 100%;
                padding: 12px;
            }

            .slide-item, .user-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .action-buttons {
                width: 100%;
                justify-content: flex-end;
            }

            .slide-info, .user-info {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="logo-section">
            <img src="logo.png" alt="Logo">
            <h1>Welcome Back</h1>
            <p>Please sign in to continue</p>
        </div>

        <button class="google-login-btn" onclick="loginWithGoogle()">
            <svg class="google-icon" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            Continue with Google
        </button>

        <div class="divider">
            <span>Secure login with Google</span>
        </div>
    </div>

    <!-- Main App (Hidden until login) -->
    <div class="main-app" id="mainApp">
        <nav class="navbar">
            <div class="nav-container">
                <a href="#" class="logo">
                    <img src="logo.png" alt="Logo">
                </a>

                <div class="nav-actions">

                    <button class="icon-btn admin-btn" id="adminBtn" style="display: none;" onclick="openAdminPanel()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                        </svg>
                    </button>

                    <button class="logout-btn" onclick="logout()">
                        Logout
                    </button>
                </div>
            </div>
        </nav>

        <div class="main-content">
            <!-- Slideshow -->
            <div class="slideshow-container" id="slideshowContainer">
                <!-- Slides will be dynamically added by admin -->
            </div>
            
            <!-- Slideshow Dots -->
            <div class="dots-container" id="dotsContainer">
                <!-- Dots will be dynamically added based on slides -->
            </div>

            <!-- Home Section -->
            <div id="homeSection" class="app-section active">
                <!-- Categories Section -->
                <div class="categories-section">
                    <h2 class="section-title">Categories</h2>
                    <div class="categories-grid" id="categoriesGrid">
                        <!-- Categories will be dynamically added -->
                    </div>
                </div>

                <div class="products-section">
                    <h2 class="section-title">Featured Products</h2>
                    <div class="products-grid" id="productsGrid">
                        <!-- Products will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Search Section -->
            <div id="searchSection" class="app-section">
                <div class="search-page">
                    <div class="search-header">
                        <h2 class="section-title">Search Products</h2>
                        <div class="search-bar-container">
                            <input type="text" id="searchInput" placeholder="Search products..." class="search-input">
                            <button class="search-btn" onclick="performSearch()">🔍</button>
                        </div>
                    </div>
                    <div class="search-results">
                        <div class="products-grid" id="searchProductsGrid">
                            <!-- Search results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Section -->
            <div id="ordersSection" class="app-section">
                <div class="orders-page">
                    <h2 class="section-title">My Orders</h2>
                    <div class="orders-content" id="ordersContent">
                        <p style="text-align: center; color: #666; padding: 40px;" id="noOrdersMessage">No orders yet. Place your first order!</p>
                    </div>
                </div>
            </div>

            <!-- Cart Section -->
            <div id="cartSection" class="app-section">
                <div class="cart-page">
                    <h2 class="section-title">Shopping Cart</h2>
                    <div class="cart-content">
                        <div class="cart-items-main" id="cartItemsMain">
                            <!-- Cart items will be populated here -->
                        </div>
                        <div class="cart-total-main" id="cartTotalMain" style="display: none;">
                            <div class="cart-total-amount-main" id="cartTotalAmountMain">Total: ₹0</div>
                            <button class="cart-checkout-main" onclick="checkout()">Checkout</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="app-section">
                <div class="profile-page">
                    <h2 class="section-title">Profile</h2>
                    <div class="profile-content">
                        <div class="profile-card">
                            <div class="profile-avatar">
                                <img src="https://via.placeholder.com/100" alt="Profile Picture" id="profilePicture">
                            </div>
                            <div class="profile-info">
                                <h3 id="profileName">User Name</h3>
                                <p id="profileEmail">user@example.com</p>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button class="profile-btn" onclick="logout()">
                                <span>🚪</span>
                                Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanel" class="admin-modal" style="display: none;">
        <div class="admin-modal-content">
            <div class="admin-header">
                <h2>Admin Panel</h2>
                <button class="close-btn" onclick="closeAdminPanel()">&times;</button>
            </div>
            
            <div class="admin-tabs">
                <button class="tab-btn active" onclick="showTab('slides')">Slides</button>
                <button class="tab-btn" onclick="showTab('categories')">Categories</button>
                <button class="tab-btn" onclick="showTab('products')">Products</button>
                <button class="tab-btn" onclick="showTab('users')">Users</button>
            </div>

            <!-- Slides Section -->
            <div id="slidesTab" class="tab-content active">
                <h3>Slideshow Management</h3>
                <div class="slide-form">
                    <input type="text" id="slideTitle" placeholder="Image Title" />
                    <input type="url" id="slideUrl" placeholder="Google Drive Image Link" />
                    <button onclick="addSlide()">Add Slide</button>
                </div>
                <div class="slides-list" id="slidesList">
                    <!-- Current slides will be populated here -->
                </div>
            </div>

            <!-- Categories Section -->
            <div id="categoriesTab" class="tab-content">
                <h3>Category Management</h3>
                <div class="slide-form">
                    <input type="text" id="categoryName" placeholder="Category Name" />
                    <input type="url" id="categoryImageUrl" placeholder="Category Image URL" />
                    <button onclick="addCategory()">Add Category</button>
                </div>
                <div class="categories-list" id="categoriesAdminList">
                    <!-- Current categories will be populated here -->
                </div>
            </div>

            <!-- Products Section -->
            <div id="productsTab" class="tab-content">
                <h3>Product Management</h3>
                <form class="admin-form" onsubmit="event.preventDefault(); addProduct();">
                    <input type="text" id="productName" placeholder="Product Name" required>
                    <input type="url" id="productImageUrl" placeholder="Product Image URL" required>
                    <textarea id="productDescription" placeholder="Product Description" required></textarea>
                    <input type="number" id="productPrice" placeholder="Price (₹)" step="0.01" required>
                    <input type="text" id="productSubImages" placeholder="Sub Images URLs (comma separated)">
                    <select id="productCategory">
                        <option value="">Select Category</option>
                    </select>
                    <button type="submit" class="btn-primary">Add Product</button>
                </form>
                
                <!-- Search Bar for Products -->
                <div class="search-container" style="margin: 20px 0;">
                    <input type="text" id="productSearchInput" placeholder="Search products by name..." 
                           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px;"
                           oninput="searchProducts()">
                </div>
                
                <div class="admin-list" id="productsAdminList">
                    <!-- Products will be populated here -->
                </div>
            </div>

            <!-- Users Section -->
            <div id="usersTab" class="tab-content">
                <h3>User Management</h3>
                <div class="users-list" id="usersList">
                    <!-- Registered users will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productModal" class="product-modal">
        <div class="product-modal-content">
            <div class="product-modal-header">
                <h2>Product Details</h2>
                <button class="close-btn" onclick="closeProductModal()">&times;</button>
            </div>
            <div class="product-modal-body" id="productModalBody">
                <!-- Product details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div id="cartOverlay" class="cart-overlay" onclick="closeCart()"></div>
    <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
            <h2>Shopping Cart</h2>
            <button class="cart-close" onclick="closeCart()">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be populated here -->
        </div>
        <div class="cart-total" id="cartTotal" style="display: none;">
            <div class="cart-total-amount" id="cartTotalAmount">Total: ₹0</div>
            <button class="cart-checkout" onclick="checkout()">Checkout</button>
        </div>

        <!-- App Bottom Navigation -->
        <div class="app-bottom-nav hidden">
            <div class="app-nav-item active" onclick="setActiveTab('home')">
                <div class="app-nav-icon">🏠</div>
                <div class="app-nav-label">Home</div>
            </div>
            <div class="app-nav-item" onclick="setActiveTab('search')">
                <div class="app-nav-icon">🔍</div>
                <div class="app-nav-label">Search</div>
            </div>
            <div class="app-nav-item cart-nav-item" onclick="setActiveTab('cart')">
                <div class="app-nav-icon">
                    🛒
                    <span class="cart-count" id="cartCountBottom">0</span>
                </div>
                <div class="app-nav-label">Cart</div>
            </div>
            <div class="app-nav-item" onclick="setActiveTab('orders')">
                <div class="app-nav-icon">📦</div>
                <div class="app-nav-label">Orders</div>
            </div>
            <div class="app-nav-item" onclick="setActiveTab('profile')">
                <div class="app-nav-icon">👤</div>
                <div class="app-nav-label">Profile</div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA_H9jJwyhfUrFoYCWZERf8R8W1o2TmqO0",
            authDomain: "desi-cart-wuaze.firebaseapp.com",
            projectId: "desi-cart-wuaze",
            storageBucket: "desi-cart-wuaze.firebasestorage.app",
            messagingSenderId: "891883106075",
            appId: "1:891883106075:web:c66fa32fe6fa8e8c36edbe"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        // Global functions for HTML onclick handlers
        window.loginWithGoogle = async function() {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                console.log('User signed in:', user.displayName);
                showMainApp(user);
            } catch (error) {
                console.error('Error during sign-in:', error);
                alert('Login failed. Please try again.');
            }
        };

        window.logout = async function() {
            try {
                await signOut(auth);
                console.log('User signed out');
                showLoginScreen();
            } catch (error) {
                console.error('Error during sign-out:', error);
            }
        };

        // Show main app after login
        function showMainApp(user) {
            currentUser = user;
            document.body.style.background = 'white';
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Show bottom navbar when user is logged in
            const appNavbar = document.querySelector('.app-bottom-nav');
            if (appNavbar) {
                appNavbar.classList.remove('hidden');
            }
            
            const welcomeMsg = document.querySelector('.welcome-message');
            if (welcomeMsg && user.displayName) {
                welcomeMsg.textContent = `Welcome, ${user.displayName}!`;
            }
            
            // Add user to registered users and update admin visibility
            addRegisteredUser(user);
            updateAdminVisibility(user);
            
            // Load slides, categories and products after user login
            setTimeout(async () => {
                await loadSlidesFromFirebase();
                await loadCategoriesFromFirebase();
                await loadProductsFromFirebase();
            }, 1000);
        }

        // Show login screen
        function showLoginScreen() {
            document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
            
            // Hide bottom navbar when user is not logged in
            const appNavbar = document.querySelector('.app-bottom-nav');
            if (appNavbar) {
                appNavbar.classList.add('hidden');
            }
        }

        // Listen for authentication state changes
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
                showMainApp(user);
            } else {
                // User is signed out
                showLoginScreen();
            }
        });

        // Slideshow functionality
        let slideIndex = 0;
        let slideInterval;

        function showSlide(index) {
            const slides = document.querySelectorAll('.slides');
            const dots = document.querySelectorAll('.dot');
            
            // Hide all slides and remove active class from dots
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            // Show current slide only if slides exist
            if (slides[index] && slidesData.length > 0) {
                slides[index].classList.add('active');
                if (dots[index]) {
                    dots[index].classList.add('active');
                }
            }
        }

        function nextSlide() {
            if (slidesData.length > 0) {
                slideIndex = (slideIndex + 1) % slidesData.length;
                showSlide(slideIndex);
            }
        }

        function startSlideshow() {
            slideInterval = setInterval(nextSlide, 5000); // Change every 5 seconds
        }

        function stopSlideshow() {
            if (slideInterval) {
                clearInterval(slideInterval);
            }
        }

        // Manual slide navigation
        window.currentSlide = function(index) {
            slideIndex = index - 1; // Convert to 0-based index
            showSlide(slideIndex);
            stopSlideshow();
            startSlideshow(); // Restart auto-scroll
        };

        // Admin and User Management
        let currentUser = null;
        let adminUsers = ['moghaeashu@gmail.com']; // Permanent admin
        let registeredUsers = [];
        let slidesData = [];
        let categoriesData = [];
        let productsData = [];
        let selectedCategory = '';
        let cartItems = [];

        // Load data from Firebase and localStorage
        async function loadData() {
            // Load admin and user data from localStorage
            const savedAdmins = localStorage.getItem('adminUsers');
            const savedUsers = localStorage.getItem('registeredUsers');
            
            if (savedAdmins) adminUsers = JSON.parse(savedAdmins);
            if (savedUsers) registeredUsers = JSON.parse(savedUsers);
            
            // Load slides from Firebase Firestore
            await loadSlidesFromFirebase();
            
            // Load categories from Firebase Firestore
            await loadCategoriesFromFirebase();
            
            // Load products from Firebase Firestore
            await loadProductsFromFirebase();
        }

        // Save admin/user data to localStorage
        function saveData() {
            localStorage.setItem('adminUsers', JSON.stringify(adminUsers));
            localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
        }

        // Load slides from Firebase Firestore
        async function loadSlidesFromFirebase() {
            try {
                console.log('Loading slides from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'slides'));
                slidesData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found slide:', doc.id, doc.data());
                    slidesData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort slides by order if available, otherwise by creation time
                slidesData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total slides loaded:', slidesData.length);
                updateSlideshow();
            } catch (error) {
                console.error('Error loading slides from Firebase:', error);
                // Fallback to show empty state
                slidesData = [];
                updateSlideshow();
            }
        }

        // Convert Google Drive sharing URL to direct image URL
        function convertGoogleDriveUrl(url) {
            if (url.includes('drive.google.com/file/d/')) {
                const fileId = url.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
                if (fileId && fileId[1]) {
                    // Try multiple formats for better compatibility
                    return `https://lh3.googleusercontent.com/d/${fileId[1]}=w800-h400-c`;
                }
            }
            return url; // Return original URL if not a Google Drive link
        }

        // Add slide to Firebase Firestore
        async function addSlideToFirebase(title, url) {
            try {
                // Convert Google Drive URL to direct image URL
                const convertedUrl = convertGoogleDriveUrl(url);
                console.log('Original URL:', url);
                console.log('Converted URL:', convertedUrl);
                
                const docRef = await addDoc(collection(db, 'slides'), {
                    title: title,
                    url: convertedUrl,
                    originalUrl: url,
                    order: slidesData.length,
                    createdAt: new Date(),
                    createdBy: currentUser?.email || 'unknown'
                });
                console.log('Slide added with ID: ', docRef.id);
                await loadSlidesFromFirebase(); // Refresh slides
                return true;
            } catch (error) {
                console.error('Error adding slide to Firebase:', error);
                return false;
            }
        }

        // Remove slide from Firebase Firestore
        async function removeSlideFromFirebase(slideId) {
            try {
                await deleteDoc(doc(db, 'slides', slideId));
                console.log('Slide removed from Firebase');
                await loadSlidesFromFirebase(); // Refresh slides
                return true;
            } catch (error) {
                console.error('Error removing slide from Firebase:', error);
                return false;
            }
        }

        // Load categories from Firebase Firestore
        async function loadCategoriesFromFirebase() {
            try {
                console.log('Loading categories from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'categories'));
                categoriesData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found category:', doc.id, doc.data());
                    categoriesData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort categories by order if available, otherwise by creation time
                categoriesData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total categories loaded:', categoriesData.length);
                updateCategoriesDisplay();
            } catch (error) {
                console.error('Error loading categories from Firebase:', error);
                categoriesData = [];
                updateCategoriesDisplay();
            }
        }

        // Add category to Firebase Firestore
        async function addCategoryToFirebase(name, imageUrl) {
            try {
                const convertedUrl = convertGoogleDriveUrl(imageUrl);
                console.log('Adding category:', name, convertedUrl);
                
                const docRef = await addDoc(collection(db, 'categories'), {
                    name: name,
                    imageUrl: convertedUrl,
                    originalImageUrl: imageUrl,
                    order: categoriesData.length,
                    createdAt: new Date(),
                    createdBy: currentUser?.email || 'unknown'
                });
                console.log('Category added with ID: ', docRef.id);
                await loadCategoriesFromFirebase();
                return true;
            } catch (error) {
                console.error('Error adding category to Firebase:', error);
                return false;
            }
        }

        // Remove category from Firebase Firestore
        async function removeCategoryFromFirebase(categoryId) {
            try {
                await deleteDoc(doc(db, 'categories', categoryId));
                console.log('Category removed from Firebase');
                await loadCategoriesFromFirebase();
                return true;
            } catch (error) {
                console.error('Error removing category from Firebase:', error);
                return false;
            }
        }

        // Update categories display on main page
        function updateCategoriesDisplay() {
            const categoriesGrid = document.getElementById('categoriesGrid');
            if (!categoriesGrid) return;
            
            categoriesGrid.innerHTML = '';
            
            categoriesData.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.onclick = () => filterProductsByCategory(category.name);
                categoryItem.innerHTML = `
                    <img src="${category.imageUrl}" alt="${category.name}" class="category-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="category-info">
                        <h3 class="category-name">${category.name}</h3>
                    </div>
                `;
                categoriesGrid.appendChild(categoryItem);
            });
            
            // Update category dropdown in admin panel
            updateCategoryDropdown();
        }

        // Update category dropdown in admin panel
        function updateCategoryDropdown() {
            const categorySelect = document.getElementById('productCategory');
            if (!categorySelect) return;
            
            categorySelect.innerHTML = '<option value="">Select Category</option>';
            categoriesData.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
        }

        // Filter products by category
        function filterProductsByCategory(categoryName) {
            selectedCategory = categoryName;
            updateProductsDisplay();
        }

        // Admin category management functions
        window.addCategory = async function() {
            const name = document.getElementById('categoryName').value;
            const imageUrl = document.getElementById('categoryImageUrl').value;
            
            if (!name || !imageUrl) {
                alert('Please fill in both category name and image URL');
                return;
            }
            
            if (categoriesData.length >= 10) {
                alert('Maximum 10 categories allowed');
                return;
            }
            
            const success = await addCategoryToFirebase(name, imageUrl);
            if (success) {
                loadCategoriesAdminData();
                // Clear form
                document.getElementById('categoryName').value = '';
                document.getElementById('categoryImageUrl').value = '';
            } else {
                alert('Error adding category. Please try again.');
            }
        };

        window.removeCategory = async function(categoryId) {
            console.log('Attempting to remove category with ID:', categoryId);
            const success = await removeCategoryFromFirebase(categoryId);
            if (success) {
                loadCategoriesAdminData();
            } else {
                alert('Error removing category. Please try again.');
            }
        }

        function loadCategoriesAdminData() {
            const categoriesAdminList = document.getElementById('categoriesAdminList');
            if (!categoriesAdminList) return;
            
            categoriesAdminList.innerHTML = '';
            
            categoriesData.forEach((category, index) => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'slide-item';
                categoryItem.innerHTML = `
                    <div class="slide-info">
                        <div class="slide-title-admin">${category.name}</div>
                        <div class="slide-url">${category.originalImageUrl || category.imageUrl}</div>
                        <small style="color: #999;">ID: ${category.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeCategory('${category.id}')">Remove</button>
                    </div>
                `;
                categoriesAdminList.appendChild(categoryItem);
            });
        }

        // Load products from Firebase Firestore
        async function loadProductsFromFirebase() {
            try {
                console.log('Loading products from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'products'));
                productsData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found product:', doc.id, doc.data());
                    productsData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort products by order if available, otherwise by creation time
                productsData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total products loaded:', productsData.length);
                updateProductsDisplay();
            } catch (error) {
                console.error('Error loading products from Firebase:', error);
                productsData = [];
                updateProductsDisplay();
            }
        }

        // Add product to Firebase Firestore
        async function addProductToFirebase(name, imageUrl, description, price, subImages, category) {
            try {
                const convertedUrl = convertGoogleDriveUrl(imageUrl);
                const subImagesArray = subImages ? subImages.split(',').map(url => convertGoogleDriveUrl(url.trim())) : [];
                console.log('Adding product:', name, convertedUrl);
                
                const docRef = await addDoc(collection(db, 'products'), {
                    name: name,
                    imageUrl: convertedUrl,
                    originalImageUrl: imageUrl,
                    description: description,
                    price: parseFloat(price),
                    subImages: subImagesArray,
                    originalSubImages: subImages,
                    category: category || '',
                    order: productsData.length,
                    createdAt: new Date(),
                    createdBy: currentUser?.email || 'unknown'
                });
                console.log('Product added with ID: ', docRef.id);
                await loadProductsFromFirebase();
                return true;
            } catch (error) {
                console.error('Error adding product to Firebase:', error);
                return false;
            }
        }

        // Remove product from Firebase Firestore
        async function removeProductFromFirebase(productId) {
            try {
                await deleteDoc(doc(db, 'products', productId));
                console.log('Product removed from Firebase');
                await loadProductsFromFirebase();
                return true;
            } catch (error) {
                console.error('Error removing product from Firebase:', error);
                return false;
            }
        }

        // Update products display on main page
        function updateProductsDisplay() {
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;

            productsGrid.innerHTML = '';

            // Filter products by selected category
            const filteredProducts = selectedCategory 
                ? productsData.filter(product => product.category === selectedCategory)
                : productsData;

            // Show all products in rows of 2
            const displayProducts = filteredProducts;

            displayProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => openProductModal(product.id);
                productCard.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">₹${product.price}</div>
                        <div class="product-buttons">
                            <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                            <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });

            // Show message if no products found for selected category
            if (filteredProducts.length === 0 && selectedCategory) {
                productsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1;">No products found in "${selectedCategory}" category.</p>`;
            }
        }

        // Admin product management functions
        window.addProduct = async function() {
            const name = document.getElementById('productName').value;
            const imageUrl = document.getElementById('productImageUrl').value;
            const description = document.getElementById('productDescription').value;
            const price = document.getElementById('productPrice').value;
            const subImages = document.getElementById('productSubImages').value;
            const category = document.getElementById('productCategory').value;
            
            if (!name || !imageUrl || !description || !price) {
                alert('Please fill in all required fields (name, image, description, price)');
                return;
            }
            
            if (productsData.length >= 20) {
                alert('Maximum 20 products allowed');
                return;
            }
            
            if (await addProductToFirebase(name, imageUrl, description, price, subImages, category)) {
                document.getElementById('productName').value = '';
                document.getElementById('productImageUrl').value = '';
                document.getElementById('productDescription').value = '';
                document.getElementById('productPrice').value = '';
                document.getElementById('productSubImages').value = '';
                document.getElementById('productCategory').value = '';
                alert('Product added successfully!');
            } else {
                alert('Failed to add product. Please try again.');
            }
        };

        // Load products admin data with search functionality
        function loadProductsAdminData() {
            const productsAdminList = document.getElementById('productsAdminList');
            if (!productsAdminList) return;
            
            productsAdminList.innerHTML = '';
            
            // Get search term
            const searchInput = document.getElementById('productSearchInput');
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            
            // Filter products based on search term
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm)
            );
            
            filteredProducts.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'admin-item';
                productItem.innerHTML = `
                    <div class="item-info">
                        <strong>${product.name}</strong><br>
                        <span>Price: ₹${product.price}</span><br>
                        <span>Category: ${product.category || 'No category'}</span><br>
                        <small style="color: #999;">ID: ${product.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeProduct('${product.id}')">Remove</button>
                    </div>
                `;
                productsAdminList.appendChild(productItem);
            });
            
            // Show message if no products found
            if (filteredProducts.length === 0 && searchTerm) {
                productsAdminList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No products found matching your search.</p>';
            }
        }

        // Search products function
        window.searchProducts = function() {
            loadProductsAdminData();
        };

        window.removeProduct = async function(productId) {
            console.log('Attempting to remove product with ID:', productId);
            const success = await removeProductFromFirebase(productId);
            if (success) {
                loadProductsAdminData();
            } else {
                alert('Error removing product. Please try again.');
            }
        };

        // Product detail modal functions
        window.openProductModal = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (!product) return;
            
            const modal = document.getElementById('productModal');
            const modalBody = document.getElementById('productModalBody');
            modalBody.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-modal-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik03NSA3NUgxMjVWMTI1SDc1Vjc1WiIgZmlsbD0iI0RERERERCIvPgo8L3N2Zz4K'">
                <h3 class="product-modal-name">${product.name}</h3>
                <div class="product-modal-price">₹${product.price}</div>
                <p class="product-modal-description">${product.description}</p>
                ${product.category ? `<p><strong>Category:</strong> ${product.category}</p>` : ''}
                
                <div class="product-modal-quantity">
                    <span class="quantity-label">Quantity:</span>
                    <div class="quantity-controls">
                        <button class="quantity-btn" onclick="changeQuantity('${product.id}', -1)">-</button>
                        <input type="number" id="quantity-${product.id}" class="quantity-input" value="1" min="1" max="10" onchange="updateTotalPrice('${product.id}')">
                        <button class="quantity-btn" onclick="changeQuantity('${product.id}', 1)">+</button>
                    </div>
                    <div class="total-price" id="total-${product.id}">Total: ₹${product.price}</div>
                </div>
                
                <div class="product-modal-buttons">
                    <button class="btn-cart" onclick="addToCartWithQuantity('${product.id}')">Add to Cart</button>
                    <button class="btn-order" onclick="orderNowWithQuantity('${product.id}')">Order Now</button>
                </div>
            `;
            
            modal.style.display = 'flex';
        };

        // Open product modal from cart (without Add to Cart button)
        window.openProductModalFromCart = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (!product) return;
            
            const modal = document.getElementById('productModal');
            const modalBody = document.getElementById('productModalBody');
            modalBody.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-modal-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik03NSA3NUgxMjVWMTI1SDc1Vjc1WiIgZmlsbD0iI0RERERERCIvPgo8L3N2Zz4K'">
                <h3 class="product-modal-name">${product.name}</h3>
                <div class="product-modal-price">₹${product.price}</div>
                <p class="product-modal-description">${product.description}</p>
                ${product.category ? `<p><strong>Category:</strong> ${product.category}</p>` : ''}
                
                <div class="product-modal-buttons">
                    <button class="btn-order" onclick="orderNowWithQuantity('${product.id}')">Order Now</button>
                </div>
            `;
            
            modal.style.display = 'flex';
        };

        window.closeProductModal = function() {
            document.getElementById('productModal').style.display = 'none';
        };

        // Quantity control functions
        window.changeQuantity = function(productId, change) {
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const currentQuantity = parseInt(quantityInput.value);
            const newQuantity = Math.max(1, Math.min(10, currentQuantity + change));
            quantityInput.value = newQuantity;
            
            const product = productsData.find(p => p.id === productId);
            if (product) {
                updateTotalPrice(productId, product.price);
            }
        };

        window.updateTotalPrice = function(productId, unitPrice) {
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const totalElement = document.getElementById(`total-${productId}`);
            const quantity = parseInt(quantityInput.value) || 1;
            const total = unitPrice * quantity;
            totalElement.textContent = `Total: ₹${total}`;
        };

        // Updated cart and order functions with quantity
        window.addToCartWithQuantity = function(productId) {
            const product = productsData.find(p => p.id === productId);
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const quantity = parseInt(quantityInput.value) || 1;
            
            if (product) {
                // Check if product already in cart
                const existingItem = cartItems.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cartItems.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        imageUrl: product.imageUrl,
                        quantity: quantity
                    });
                }
                
                updateCartCount();
                alert(`${quantity} x ${product.name} added to cart!`);
                closeProductModal();
            }
        };

        let orderItems = [];

        window.orderNowWithQuantity = function(productId) {
            const product = productsData.find(p => p.id === productId);
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const quantity = parseInt(quantityInput.value) || 1;
            
            if (product) {
                const orderItem = {
                    id: Date.now().toString(),
                    productId: product.id,
                    name: product.name,
                    price: product.price,
                    imageUrl: product.imageUrl,
                    quantity: quantity,
                    total: product.price * quantity,
                    orderDate: new Date().toLocaleDateString()
                };
                
                orderItems.push(orderItem);
                alert(`Order placed for ${quantity} x ${product.name}! Total: ₹${orderItem.total}`);
                closeProductModal();
            }
        };

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('productModal');
            if (event.target === modal) {
                closeProductModal();
            }
        });

        // Show all products when clicking outside categories
        window.showAllProducts = function() {
            selectedCategory = '';
            updateProductsDisplay();
        };

        // Cart functionality
        window.openCart = function() {
            document.getElementById('cartSidebar').classList.add('open');
            document.getElementById('cartOverlay').style.display = 'block';
            updateCartDisplay();
        };

        window.closeCart = function() {
            document.getElementById('cartSidebar').classList.remove('open');
            document.getElementById('cartOverlay').style.display = 'none';
        };

        window.addToCart = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (product) {
                // Check if product already in cart
                const existingItem = cartItems.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cartItems.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        imageUrl: product.imageUrl,
                        quantity: 1
                    });
                }
                
                // Update cart count
                updateCartCount();
                alert(`${product.name} added to cart!`);
            }
        };

        function updateCartCount() {
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            
            // Update bottom navbar cart count
            const cartCountBottom = document.getElementById('cartCountBottom');
            if (cartCountBottom) {
                cartCountBottom.textContent = totalItems;
                cartCountBottom.style.display = totalItems > 0 ? 'flex' : 'none';
            }
        }

        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartTotalAmount = document.getElementById('cartTotalAmount');
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<div class="cart-empty">Your cart is empty</div>';
                cartTotal.style.display = 'none';
                return;
            }
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cartItems.forEach(item => {
                total += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="cart-item-image" onclick="openProductModalFromCart('${item.id}')" style="cursor: pointer;">
                    <div class="cart-item-info" onclick="openProductModalFromCart('${item.id}')" style="cursor: pointer;">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">₹${item.price} x ${item.quantity}</div>
                    </div>
                    <button class="cart-item-remove" onclick="removeFromCart('${item.id}')">Remove</button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalAmount.textContent = `Total: ₹${total}`;
            cartTotal.style.display = 'block';
        }

        // Update cart display for main page section
        function updateCartDisplayMain() {
            const cartItemsContainer = document.getElementById('cartItemsMain');
            const cartTotal = document.getElementById('cartTotalMain');
            const cartTotalAmount = document.getElementById('cartTotalAmountMain');
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<div class="cart-empty-main">Your cart is empty<br>Add some products to get started!</div>';
                cartTotal.style.display = 'none';
                return;
            }
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cartItems.forEach(item => {
                total += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item-main';
                cartItem.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="cart-item-image-main" onclick="openProductModalFromCart('${item.id}')">
                    <div class="cart-item-info-main" onclick="openProductModalFromCart('${item.id}')">
                        <div class="cart-item-name-main">${item.name}</div>
                        <div class="cart-item-price-main">₹${item.price} x ${item.quantity}</div>
                    </div>
                    <button class="cart-item-remove-main" onclick="removeFromCart('${item.id}')">Remove</button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalAmount.textContent = `Total: ₹${total}`;
            cartTotal.style.display = 'block';
        }

        window.removeFromCart = function(productId) {
            cartItems = cartItems.filter(item => item.id !== productId);
            updateCartCount();
            updateCartDisplay();
            updateCartDisplayMain();
        };

        window.checkout = function() {
            if (cartItems.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            alert(`Checkout successful! Total amount: ₹${total}`);
            cartItems = [];
            updateCartCount();
            updateCartDisplay();
            closeCart();
        };

        window.orderNow = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (product) {
                alert(`Ordering ${product.name} for ₹${product.price}!`);
                // Here you can add order processing logic
            }
        };

        // App Navigation functionality
        window.setActiveTab = function(tab) {
            // Remove active class from all tabs
            document.querySelectorAll('.app-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked tab
            event.target.closest('.app-nav-item').classList.add('active');
            
            // Hide all sections
            document.querySelectorAll('.app-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            switch(tab) {
                case 'home':
                    document.getElementById('homeSection').classList.add('active');
                    break;
                case 'search':
                    document.getElementById('searchSection').classList.add('active');
                    loadAllProductsInSearch();
                    break;
                case 'cart':
                    document.getElementById('cartSection').classList.add('active');
                    updateCartDisplayMain();
                    break;
                case 'orders':
                    document.getElementById('ordersSection').classList.add('active');
                    loadOrdersData();
                    break;
                case 'profile':
                    document.getElementById('profileSection').classList.add('active');
                    loadProfileData();
                    break;
            }
        };

        // Search functionality
        window.performSearch = function() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                searchProductsInSection(searchTerm);
            } else {
                loadAllProductsInSearch();
            }
        };

        // Add real-time search
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.trim();
                    if (searchTerm) {
                        searchProductsInSection(searchTerm);
                    } else {
                        loadAllProductsInSearch();
                    }
                });
            }
        });

        function loadAllProductsInSearch() {
            const searchProductsGrid = document.getElementById('searchProductsGrid');
            if (!searchProductsGrid) return;
            
            searchProductsGrid.innerHTML = '';
            
            productsData.forEach(product => {
                const productCard = createProductCard(product);
                searchProductsGrid.appendChild(productCard);
            });
        }

        function searchProductsInSection(searchTerm) {
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                (product.category && product.category.toLowerCase().includes(searchTerm.toLowerCase()))
            );
            
            const searchProductsGrid = document.getElementById('searchProductsGrid');
            if (!searchProductsGrid) return;
            
            searchProductsGrid.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                searchProductsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1; padding: 40px;">No products found for "${searchTerm}".</p>`;
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = createProductCard(product);
                searchProductsGrid.appendChild(productCard);
            });
        }

        function createProductCard(product) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.onclick = () => openProductModal(product.id);
            productCard.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                <div class="product-info">
                    <h3 class="product-name">${product.name}</h3>
                    <div class="product-price">₹${product.price}</div>
                    <div class="product-buttons">
                        <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                        <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                    </div>
                </div>
            `;
            return productCard;
        }

        function updateProfileInfo() {
            if (currentUser) {
                document.getElementById('profileName').textContent = currentUser.displayName || 'User';
                document.getElementById('profileEmail').textContent = currentUser.email || 'user@email.com';
                document.getElementById('profileImage').src = currentUser.photoURL || '';
            }
        }

        function updateOrdersDisplay() {
            const ordersContent = document.getElementById('ordersContent');
            const noOrdersMessage = document.getElementById('noOrdersMessage');
            
            if (orderItems.length === 0) {
                noOrdersMessage.style.display = 'block';
                return;
            }
            
            noOrdersMessage.style.display = 'none';
            
            // Clear existing orders except the no orders message
            const existingOrders = ordersContent.querySelectorAll('.order-item');
            existingOrders.forEach(order => order.remove());
            
            orderItems.forEach(order => {
                const orderElement = document.createElement('div');
                orderElement.className = 'order-item';
                orderElement.innerHTML = `
                    <img src="${order.imageUrl}" alt="${order.name}" class="order-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik0zMCAzMEg1MFY1MEgzMFYzMFoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+Cg=='">
                    <div class="order-details">
                        <div class="order-name">${order.name}</div>
                        <div class="order-info">Quantity: ${order.quantity}</div>
                        <div class="order-info">Unit Price: ₹${order.price}</div>
                        <div class="order-total">Total: ₹${order.total}</div>
                    </div>
                    <div class="order-date">${order.orderDate}</div>
                `;
                ordersContent.appendChild(orderElement);
            });
        }

        function searchProducts(searchTerm) {
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.description.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;
            
            productsGrid.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                productsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1;">No products found for "${searchTerm}".</p>`;
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => openProductModal(product.id);
                productCard.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">₹${product.price}</div>
                        <div class="product-buttons">
                            <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                            <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // Check if user is admin
        function isAdmin(email) {
            return adminUsers.includes(email);
        }

        // Show/hide admin button based on user role
        function updateAdminVisibility(user) {
            const adminBtn = document.getElementById('adminBtn');
            if (adminBtn && user && isAdmin(user.email)) {
                adminBtn.style.display = 'block';
            } else if (adminBtn) {
                adminBtn.style.display = 'none';
            }
        }

        // Add user to registered users list
        function addRegisteredUser(user) {
            const existingUser = registeredUsers.find(u => u.email === user.email);
            if (!existingUser) {
                registeredUsers.push({
                    name: user.displayName,
                    email: user.email,
                    isAdmin: isAdmin(user.email)
                });
                saveData();
            }
        }

        // Admin Panel Functions
        window.openAdminPanel = function() {
            document.getElementById('adminPanel').style.display = 'flex';
            loadAdminData();
        };

        window.closeAdminPanel = function() {
            document.getElementById('adminPanel').style.display = 'none';
        };

        window.showTab = function(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'slides') {
                loadSlidesData();
            } else if (tabName === 'categories') {
                loadCategoriesAdminData();
            } else if (tabName === 'products') {
                loadProductsAdminData();
            } else if (tabName === 'users') {
                loadUsersData();
            }
        };

        // Slideshow Management
        window.addSlide = async function() {
            const title = document.getElementById('slideTitle').value;
            const url = document.getElementById('slideUrl').value;
            
            if (!title || !url) {
                alert('Please fill in both title and URL');
                return;
            }
            
            if (slidesData.length >= 5) {
                alert('Maximum 5 slides allowed');
                return;
            }
            
            // Add to Firebase instead of localStorage
            const success = await addSlideToFirebase(title, url);
            if (success) {
                loadSlidesData();
                // Clear form
                document.getElementById('slideTitle').value = '';
                document.getElementById('slideUrl').value = '';
            } else {
                alert('Error adding slide. Please try again.');
            }
        };

        window.removeSlide = async function(slideId) {
            console.log('Attempting to remove slide with ID:', slideId);
            const success = await removeSlideFromFirebase(slideId);
            if (success) {
                loadSlidesData();
            } else {
                alert('Error removing slide. Please try again.');
            }
        }

        function loadSlidesData() {
            const slidesList = document.getElementById('slidesList');
            slidesList.innerHTML = '';
            
            slidesData.forEach((slide, index) => {
                const slideItem = document.createElement('div');
                slideItem.className = 'slide-item';
                slideItem.innerHTML = `
                    <div class="slide-info">
                        <div class="slide-title-admin">${slide.title}</div>
                        <div class="slide-url">${slide.originalUrl || slide.url}</div>
                        <small style="color: #999;">ID: ${slide.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeSlide('${slide.id}')">Remove</button>
                    </div>
                `;
                slidesList.appendChild(slideItem);
            });
        }

        // User Management
        window.toggleAdmin = function(email) {
            if (email === 'moghaeashu@gmail.com') {
                alert('Cannot modify permanent admin');
                return;
            }
            
            const userIndex = registeredUsers.findIndex(u => u.email === email);
            if (userIndex !== -1) {
                const isCurrentlyAdmin = adminUsers.includes(email);
                
                if (isCurrentlyAdmin) {
                    adminUsers = adminUsers.filter(admin => admin !== email);
                    registeredUsers[userIndex].isAdmin = false;
                } else {
                    adminUsers.push(email);
                    registeredUsers[userIndex].isAdmin = true;
                }
                
                saveData();
                loadUsersData();
            }
        };

        function loadUsersData() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            registeredUsers.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                const isPermanentAdmin = user.email === 'moghaeashu@gmail.com';
                
                userItem.innerHTML = `
                    <div class="user-info">
                        <div class="user-name">${user.name}${user.isAdmin ? '<span class="admin-badge">ADMIN</span>' : ''}</div>
                        <div class="user-email">${user.email}</div>
                    </div>
                    <div class="action-buttons">
                        ${!isPermanentAdmin ? 
                            `<button class="${user.isAdmin ? 'btn-danger' : 'btn-success'}" onclick="toggleAdmin('${user.email}')">
                                ${user.isAdmin ? 'Remove Admin' : 'Make Admin'}
                            </button>` : 
                            '<span style="color: #f39c12; font-size: 12px;">Permanent Admin</span>'
                        }
                    </div>
                `;
                usersList.appendChild(userItem);
            });
        }

        function loadAdminData() {
            loadSlidesData();
            loadUsersData();
        }

        // Update slideshow with current data
        function updateSlideshow() {
            console.log('Updating slideshow with', slidesData.length, 'slides');
            const slideshowContainer = document.querySelector('.slideshow-container');
            const dotsContainer = document.querySelector('.dots-container');
            
            if (!slideshowContainer || !dotsContainer) {
                console.error('Slideshow containers not found');
                return;
            }
            
            // Clear existing slides
            const existingSlides = slideshowContainer.querySelectorAll('.slides');
            existingSlides.forEach(slide => slide.remove());
            
            // Clear existing dots
            dotsContainer.innerHTML = '';
            
            // If no slides, show empty message
            if (slidesData.length === 0) {
                slideshowContainer.innerHTML = '<div style="padding: 50px; text-align: center; color: #666;">No slides added yet. Admin can add slides through the admin panel.</div>';
                console.log('Showing empty state message');
                return;
            }
            
            // Add new slides
            slidesData.forEach((slide, index) => {
                console.log(`Adding slide ${index + 1}:`, slide.title, slide.url);
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slides';
                if (index === 0) slideDiv.classList.add('active');
                
                slideDiv.innerHTML = `
                    <img src="${slide.url}" 
                         alt="${slide.title}" 
                         style="width: 100%; height: 250px; object-fit: cover;"
                         onload="console.log('Image loaded successfully:', this.src)"
                         onerror="
                            console.error('Failed to load image:', this.src);
                            const fileId = '${slide.url}'.match(/\/d\/([a-zA-Z0-9_-]+)/);
                            if (fileId && fileId[1]) {
                                console.log('Trying alternative URL format...');
                                this.src = 'https://drive.google.com/uc?export=view&id=' + fileId[1];
                                this.onerror = function() {
                                    console.log('Alternative format also failed, trying thumbnail...');
                                    this.src = 'https://drive.google.com/thumbnail?id=' + fileId[1] + '&sz=w800-h400';
                                    this.onerror = function() {
                                        console.log('All formats failed, showing placeholder');
                                        this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4=';
                                    };
                                };
                            }
                         ">
                    <div class="slide-content">
                        <div class="slide-title">${slide.title}</div>
                        <div class="slide-description">Discover amazing products and deals</div>
                    </div>
                `;
                
                slideshowContainer.appendChild(slideDiv);
                
                // Add dot
                const dot = document.createElement('span');
                dot.className = 'dot';
                if (index === 0) dot.classList.add('active');
                dot.onclick = () => currentSlide(index + 1);
                dotsContainer.appendChild(dot);
            });
            
            // Reset slideshow
            slideIndex = 0;
            stopSlideshow();
            if (slidesData.length > 1) {
                startSlideshow();
            }
            
            console.log('Slideshow updated successfully');
        }

        // Cart functionality
        document.addEventListener('DOMContentLoaded', async function() {
            await loadData(); // Load data from Firebase and localStorage
            
            const cartBtn = document.querySelector('.cart-btn');
            if (cartBtn) {
                cartBtn.addEventListener('click', function() {
                    alert('Cart clicked! Add your cart functionality here.');
                });
            }
            
            // Initialize slideshow when page loads
            setTimeout(() => {
                updateSlideshow();
            }, 500);
        });
    </script>
</body>
</html>
