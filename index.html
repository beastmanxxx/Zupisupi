<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="applogo.png" sizes="32x32" type="image/png">
    <link rel="icon" href="applogo.png" sizes="16x16" type="image/png">

    <title>Zupisupi</title>
    <link href="https://fonts.googleapis.com/css2?family=Honk&family=Macondo&family=Mrs+Sheppards&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: white !important;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Desktop mobile simulation only */
        @media (min-width: 769px) {
            body {
                max-width: 414px;
                margin: 0 auto;
            }
        }

        /* Login Screen Styles - Hidden by default */
        .login-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 90%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .logo-section {
            margin-bottom: 30px;
        }

        .logo-section img {
            height: 80px;
            width: auto;
            margin-bottom: 20px;
        }

        .logo-section h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .logo-section p {
            color: #718096;
            font-size: 16px;
        }

        /* Authentication Form Styles */
        .auth-form {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-top: 30px;
        }

        .form-group {
            position: relative;
            margin-bottom: 5px;
        }

        .form-group input {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            background: #f8f9fa;
            box-sizing: border-box;
            line-height: 1.5;
        }

        .form-group input:focus {
            border-color: #3498db;
            background: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-group input::placeholder {
            color: #a0aec0;
        }

        .auth-btn {
            width: 100%;
            padding: 18px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            margin-top: 10px;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .form-switch {
            text-align: center;
            margin-top: 20px;
        }

        .form-switch p {
            color: #718096;
            font-size: 14px;
            margin: 0;
        }

        .form-switch a {
            color: #3498db;
            text-decoration: none;
            font-weight: 600;
        }

        .form-switch a:hover {
            text-decoration: underline;
        }

        /* Main App Styles (Show by default) */
        .main-app {
            display: block;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        /* Desktop mobile simulation for navbar */
        @media (min-width: 769px) {
            .navbar {
                left: 50%;
                transform: translateX(-50%);
                width: 414px;
                max-width: 414px;
            }
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            height: 90px;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo img {
            height: 55px;
            width: auto;
            object-fit: contain;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            background: none;
            border: none;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a5568;
            position: relative;
        }

        .icon-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .icon-btn svg {
            width: 28px;
            height: 28px;
        }

        .cart-btn {
            position: relative;
        }

        .cart-icon-container {
            position: relative;
            display: inline-block;
        }

        .cart-icon {
            filter: brightness(0.6);
            font-size: 24px;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .logout-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #ff3742;
            transform: translateY(-2px);
        }

        .main-content {
            margin-top: 105px;
            padding: 0;
            text-align: center;
            background: white;
            min-height: calc(100vh - 90px);
        }

        .welcome-message {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        /* Slideshow Styles */
        .slideshow-container {
            position: relative;
            max-width: 800px;
            margin: 15px 10px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .slides {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .slides.active {
            display: block;
        }

        .slides img {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 200px;
            object-fit: contain;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Slideshow indicators */
        .dots-container {
            text-align: center;
            margin-top: 20px;
        }

        .dot {
            height: 12px;
            width: 12px;
            margin: 0 5px;
            background-color: #bdc3c7;
            border-radius: 50%;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active, .dot:hover {
            background-color: #717171;
        }

        /* Categories Section Styles */
        .categories-section {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-title {
            text-align: center;
            font-size: 36px;
            color: #000000;
            margin-bottom: 30px;
            font-weight: 400;
            font-family: "Mrs Sheppards", cursive;
            letter-spacing: -0.5px;
            text-shadow: 3px 3px 8px rgba(255, 215, 0, 0.8);
        }

        .categories-grid {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            margin-top: 20px;
            padding: 10px 0;
            scroll-behavior: smooth;
        }

        .categories-grid::-webkit-scrollbar {
            height: 8px;
        }

        .categories-grid::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .categories-grid::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        .categories-grid::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .category-item {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 100px;
            flex-shrink: 0;
        }

        .category-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .category-image {
            width: 100%;
            height: 75px;
            object-fit: cover;
        }

        .category-info {
            padding: 8px;
            text-align: center;
        }

        .category-name {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
            line-height: 1.2;
        }

        /* Featured Products Section Styles */
        .products-section {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        @media (max-width: 480px) {
            .products-grid {
                gap: 10px;
            }
            
            .product-card {
                border-radius: 10px;
            }
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .product-image {
            width: 100%;
            height: 150px;
            object-fit: contain;
            display: block;
            background: #f8f9fa;
        }

        @media (max-width: 768px) {
            .product-image {
                height: 120px;
            }
        }

        @media (max-width: 480px) {
            .product-image {
                height: 100px;
            }
        }

        .product-info {
            padding: 20px;
        }

        @media (max-width: 768px) {
            .product-info {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .product-info {
                padding: 12px;
            }
        }

        .product-name {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .product-name {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .product-name {
                font-size: 14px;
            }
        }

        .product-description {
            display: none;
        }

        .product-price {
            font-size: 20px;
            font-weight: 700;
            color: #27ae60;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .product-price {
                font-size: 18px;
                margin-bottom: 12px;
            }
        }

        @media (max-width: 480px) {
            .product-price {
                font-size: 16px;
                margin-bottom: 10px;
            }
        }

        .product-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .product-buttons {
                gap: 6px;
            }
        }

        @media (max-width: 480px) {
            .product-buttons {
                gap: 5px;
            }
        }

        .btn-cart, .btn-order {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .btn-cart, .btn-order {
                padding: 10px 12px;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .btn-cart, .btn-order {
                padding: 8px 10px;
                font-size: 12px;
            }
        }

        .btn-cart {
            background: #2c3e50;
            color: white;
        }

        .btn-cart:hover {
            background: #1a252f;
            transform: translateY(-2px);
        }

        .btn-order {
            background: #f1c40f;
            color: #2c3e50;
        }

        .btn-order:hover {
            background: #f39c12;
            transform: translateY(-2px);
        }

        /* Product Detail Modal */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .product-modal-content {
            background: white;
            border-radius: 12px;
            width: 85%;
            max-width: 450px;
            max-height: 75vh;
            overflow-y: auto;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }

        .product-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
        }

        .product-modal-header h2 {
            font-size: 18px;
            margin: 0;
        }

        .product-modal-body {
            padding: 20px;
        }

        .product-modal-image {
            width: 100%;
            height: 180px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }

        .product-modal-name {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .product-modal-price {
            font-size: 22px;
            font-weight: 700;
            color: #e74c3c;
            margin-bottom: 15px;
        }

        .product-modal-description {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .product-modal-quantity {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 15px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .quantity-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: #3498db;
            color: white;
        }

        .quantity-input {
            width: 50px;
            height: 30px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
        }

        .total-price {
            font-size: 16px;
            font-weight: 700;
            color: #27ae60;
            margin-left: auto;
        }

        .product-modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .product-modal-buttons .btn-cart,
        .product-modal-buttons .btn-order {
            flex: 1;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Cart Section Styles */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 2000;
            overflow-y: auto;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h2 {
            margin: 0;
            color: #2c3e50;
        }

        .cart-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .cart-items {
            padding: 20px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 8px;
            background: #f8f9fa;
            margin-right: 15px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #27ae60;
            font-weight: 700;
        }

        .cart-item-remove {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .cart-empty {
            text-align: center;
            color: #666;
            padding: 40px 20px;
        }

        .cart-total {
            padding: 20px;
            border-top: 2px solid #eee;
            background: #f8f9fa;
        }

        .cart-total-amount {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .cart-checkout {
            width: 100%;
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            display: none;
        }

        @media (max-width: 768px) {
            .cart-sidebar {
                width: 100%;
                right: -100%;
            }
        }

        /* New App Bottom Navigation - Only visible in main app */
        .app-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 0;
            height: 65px;
        }

        /* Desktop mobile simulation for bottom nav */
        @media (min-width: 769px) {
            .app-bottom-nav {
                left: 50%;
                transform: translateX(-50%);
                width: 414px;
                max-width: 414px;
            }
        }

        /* Hide navbar by default */
        .app-bottom-nav.hidden {
            display: none !important;
        }

        .app-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-width: 60px;
            position: relative;
        }

        .app-nav-item:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateY(-2px);
        }

        .app-nav-item.active {
            background: #3498db;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .app-nav-icon {
            font-size: 18px;
            margin-bottom: 3px;
            transition: transform 0.3s ease;
        }

        .app-nav-item.active .app-nav-icon {
            transform: scale(1.1);
        }

        .app-nav-label {
            font-size: 11px;
            font-weight: 600;
            text-align: center;
        }

        /* Cart count badge in bottom navbar */
        .cart-nav-item .app-nav-icon {
            position: relative;
        }

        .cart-nav-item .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            min-width: 18px;
        }

        /* Add bottom padding to main content to avoid overlap */
        .main-app {
            padding-bottom: 75px; /* Space for new navbar */
        }

        /* Desktop responsive design with bottom navbar */
        @media (min-width: 769px) {
            .main-app {
                padding-bottom: 75px; /* Space for new navbar */
            }
            
            .login-container {
                max-width: 400px;
            }
        }

        /* App Sections Styles */
        .app-section {
            display: none;
        }

        .app-section.active {
            display: block;
        }

        /* Search Section Styles */
        .search-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .search-header {
            margin-bottom: 30px;
        }

        .search-bar-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: #3498db;
        }

        .search-btn {
            padding: 15px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #2980b9;
        }

        /* Orders Section Styles */
        .orders-page, .profile-page, .cart-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Cart Section Main Page Styles */
        .cart-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin-top: 20px;
        }

        .cart-items-main {
            margin-bottom: 20px;
        }

        .cart-item-main {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            margin-bottom: 15px;
            background: white;
            transition: box-shadow 0.3s ease;
        }

        .cart-item-main:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .cart-item-image-main {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 8px;
            background: #f8f9fa;
            margin-right: 15px;
            cursor: pointer;
        }

        .cart-item-info-main {
            flex: 1;
            cursor: pointer;
        }

        .cart-item-name-main {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .cart-item-price-main {
            color: #27ae60;
            font-weight: 700;
            font-size: 14px;
        }

        .cart-item-remove-main {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .cart-item-remove-main:hover {
            background: #c0392b;
        }

        .cart-total-main {
            border-top: 2px solid #eee;
            padding-top: 20px;
            text-align: center;
        }

        .cart-total-amount-main {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .cart-checkout-main {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .cart-checkout-main:hover {
            background: #229954;
        }

        .cart-empty-main {
            text-align: center;
            color: #666;
            padding: 60px 20px;
            font-size: 18px;
            line-height: 1.5;
        }

        .coming-soon {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .coming-soon-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .coming-soon h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        /* Cart Section Styles */
        .cart-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .cart-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .cart-items-main {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .cart-item-main {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .cart-item-main:last-child {
            border-bottom: none;
        }

        .cart-item-image-main {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 8px;
            background: #f8f9fa;
            margin-right: 15px;
            cursor: pointer;
        }

        .cart-item-info-main {
            flex: 1;
            cursor: pointer;
        }

        .cart-item-name-main {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .cart-item-price-main {
            color: #27ae60;
            font-weight: 700;
            font-size: 14px;
        }

        .cart-item-remove-main {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .cart-item-remove-main:hover {
            background: #c0392b;
        }

        .cart-empty-main {
            text-align: center;
            color: #666;
            padding: 60px 20px;
            font-size: 16px;
        }

        .cart-total-main {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .cart-total-amount-main {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .cart-checkout-main {
            width: 100%;
            max-width: 300px;
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .cart-checkout-main:hover {
            background: #229954;
        }

        /* Custom Notification Styles */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            pointer-events: none;
        }

        .notification {
            background: #27ae60;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: auto;
            max-width: 350px;
            word-wrap: break-word;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.warning {
            background: #f39c12;
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            float: right;
            font-size: 18px;
            cursor: pointer;
            margin-left: 10px;
            padding: 0;
            line-height: 1;
        }

        /* Profile Section Styles */
        .profile-content {
            max-width: 400px;
            margin: 0 auto;
        }

        .profile-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .profile-avatar {
            margin-bottom: 20px;
        }

        .profile-avatar img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-info h3 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: #666;
            font-size: 16px;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .profile-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .profile-btn:hover {
            background: #c0392b;
        }

        /* Admin Panel Styles */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .admin-modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 1px solid #eee;
        }

        .admin-header h2 {
            margin: 0;
            color: #2c3e50;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #333;
        }

        .admin-tabs {
            display: flex;
            border-bottom: 1px solid #eee;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #3498db;
            border-bottom: 2px solid #3498db;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h3 {
            margin-top: 0;
            color: #2c3e50;
        }

        .slide-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .slide-form input {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .slide-form button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .slide-form button:hover {
            background: #2980b9;
        }

        .slide-item, .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .slide-info, .user-info {
            flex: 1;
        }

        .slide-title-admin, .user-name {
            font-weight: bold;
            color: #2c3e50;
        }

        .slide-url, .user-email {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-success {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-success:hover {
            background: #229954;
        }

        .admin-badge {
            background: #f39c12;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            margin-left: 10px;
        }

        .slide-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            color: white;
            padding: 30px 20px 20px;
            text-align: left;
        }

        .slide-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .slide-description {
            font-size: 16px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .login-container {
                padding: 30px 20px;
            }

            .nav-container {
                padding: 0 15px;
            }

            .nav-actions {
                gap: 15px;
            }

            .slides img {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 150px;
                object-fit: contain;
            }

            .slideshow-container {
                margin: 10px 5px 0;
            }

            .categories-grid {
                gap: 15px;
                padding: 10px 15px;
            }

            .category-item {
                min-width: 90px;
            }

            .category-image {
                height: 60px;
            }

            .category-name {
                font-size: 13px;
                color: #2c3e50;
                font-weight: 600;
            }

            .category-info {
                padding: 8px;
            }

            /* Admin Panel Mobile Styles */
            .admin-modal-content {
                width: 95%;
                max-height: 90vh;
                margin: 20px;
            }

            .admin-header {
                padding: 15px 20px;
            }

            .admin-header h2 {
                font-size: 20px;
            }

            .admin-tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                padding: 12px 8px;
                font-size: 14px;
                min-width: 0;
                flex: 1;
            }

            .tab-content {
                padding: 20px 15px;
            }

            .slide-form {
                flex-direction: column;
                gap: 15px;
            }

            .slide-form input {
                min-width: auto;
                width: 100%;
            }

            .slide-form button {
                width: 100%;
                padding: 12px;
            }

            .slide-item, .user-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .action-buttons {
                width: 100%;
                justify-content: flex-end;
            }

            .slide-info, .user-info {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Custom Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Login Modal (Hidden by default) -->
    <div class="login-modal" id="loginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; justify-content: center; align-items: center;">
        <div class="login-container" style="display: flex; position: relative;">
            <button onclick="closeLoginModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">×</button>
            
            <div class="logo-section">
                <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
                <h1>Welcome</h1>
                <p>Login or register to use app features</p>
            </div>

            <!-- Login Form -->
            <form class="auth-form" id="loginForm" style="display: block !important;">
                <div class="form-group">
                    <input type="text" id="loginEmailOrPhone" placeholder="Email or Phone Number" required>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="Password" required>
                </div>
                <button type="submit" class="auth-btn">Login</button>
                <div class="form-switch">
                    <p>Don't have an account? <a href="#" onclick="switchToRegister()">Register here</a></p>
                </div>
            </form>

            <!-- Register Form -->
            <form class="auth-form" id="registerForm" style="display: none !important;">
                <div class="form-group">
                    <input type="text" id="registerName" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <input type="email" id="registerEmail" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <input type="tel" id="registerPhone" placeholder="Phone Number" required>
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" placeholder="Password (min 6 characters)" required>
                </div>
                <div class="form-group">
                    <input type="password" id="confirmPassword" placeholder="Confirm Password" required>
                </div>
                <button type="submit" class="auth-btn">Register</button>
                <div class="form-switch">
                    <p>Already have an account? <a href="#" onclick="switchToLogin()">Login here</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Main App (Hidden until login) -->
    <div class="main-app" id="mainApp">
        <nav class="navbar">
            <div class="nav-container">
                <a href="#" class="logo">
                    <img src="logo.png" alt="Logo">
                </a>

                <div class="nav-actions">

                    <button class="icon-btn admin-btn" id="adminBtn" style="display: none;" onclick="openAdminPanel()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                        </svg>
                    </button>

                    <button class="logout-btn" id="authBtn" onclick="showLoginModal()">
                        Login
                    </button>
                </div>
            </div>
        </nav>

        <div class="main-content">
            <!-- Slideshow -->
            <div class="slideshow-container" id="slideshowContainer">
                <!-- Slides will be dynamically added by admin -->
            </div>
            
            <!-- Slideshow Dots -->
            <div class="dots-container" id="dotsContainer">
                <!-- Dots will be dynamically added based on slides -->
            </div>

            <!-- Home Section -->
            <div id="homeSection" class="app-section active">
                <!-- Categories Section -->
                <div class="categories-section">
                    <h2 class="section-title">Categories</h2>
                    <div class="categories-grid" id="categoriesGrid">
                        <!-- Categories will be dynamically added -->
                    </div>
                </div>

                <div class="products-section">
                    <h2 class="section-title">Featured Products</h2>
                    <div class="products-grid" id="productsGrid">
                        <!-- Products will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Search Section -->
            <div id="searchSection" class="app-section">
                <div class="search-page">
                    <div class="search-header">
                        <h2 class="section-title">Search Products</h2>
                        <div class="search-bar-container">
                            <input type="text" id="searchInput" placeholder="Search products..." class="search-input">
                            <button class="search-btn" onclick="performSearch()">🔍</button>
                        </div>
                    </div>
                    <div class="search-results">
                        <div class="products-grid" id="searchProductsGrid">
                            <!-- Search results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Section -->
            <div id="ordersSection" class="app-section">
                <div class="orders-page">
                    <h2 class="section-title">My Orders</h2>
                    <div class="orders-content" id="ordersContent">
                        <p style="text-align: center; color: #666; padding: 40px;" id="noOrdersMessage">No orders yet. Place your first order!</p>
                    </div>
                </div>
            </div>

            <!-- Cart Section -->
            <div id="cartSection" class="app-section">
                <div class="cart-page">
                    <h2 class="section-title">Shopping Cart</h2>
                    <div class="cart-content">
                        <div class="cart-items-main" id="cartItemsMain">
                            <!-- Cart items will be populated here -->
                        </div>
                        <div class="cart-total-main" id="cartTotalMain" style="display: none;">
                            <div class="cart-total-amount-main" id="cartTotalAmountMain">Total: ₹0</div>
                            <button class="cart-checkout-main" onclick="checkout()">Checkout</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="app-section">
                <div class="profile-page">
                    <h2 class="section-title">Profile</h2>
                    <div class="profile-actions" style="display: flex; flex-direction: column; gap: 5px;">
                        <div onclick="showAddressForm()" style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #3498db;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #3498db, #2980b9); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">📍</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">Your Address</div>
                                <div style="font-size: 12px; color: #7f8c8d;">Manage delivery address</div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">›</div>
                        </div>
                        
                        <div onclick="openTermsModal()" style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #9b59b6;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #9b59b6, #8e44ad); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">📋</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">Terms & Conditions</div>
                                <div style="font-size: 12px; color: #7f8c8d;">App terms and policies</div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">›</div>
                        </div>
                        
                        <div onclick="openPrivacyModal()" style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #27ae60;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">🔒</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">Privacy Policy</div>
                                <div style="font-size: 12px; color: #7f8c8d;">Data protection and privacy</div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">›</div>
                        </div>
                        
                        <div onclick="openFAQModal()" style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #f39c12;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #f39c12, #e67e22); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">❓</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">FAQ</div>
                                <div style="font-size: 12px; color: #7f8c8d;">Frequently asked questions</div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">›</div>
                        </div>
                        
                        <div style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #3498db;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #3498db, #2980b9); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">📞</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">Contact Us</div>
                                <div style="font-size: 12px; color: #7f8c8d; text-align: center;">
                                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                                        <span id="contactNumber">+91 8218864803</span>
                                        <button onclick="copyContactNumber()" style="background: #27ae60; color: white; border: none; padding: 2px 6px; border-radius: 4px; font-size: 10px; cursor: pointer;">Copy</button>
                                    </div>
                                </div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">📋</div>
                        </div>
                        
                        <div onclick="logout()" style="display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; border-left: 4px solid #e74c3c;" onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #e74c3c, #c0392b); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <span style="font-size: 18px;">🚪</span>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 2px;">Logout</div>
                                <div style="font-size: 12px; color: #7f8c8d;">Sign out of your account</div>
                            </div>
                            <div style="color: #bdc3c7; font-size: 18px;">›</div>
                        </div>
                    </div>
                    
                    <!-- Your Delivery Address Display in Profile -->
                    <div id="profileAddressDisplay" style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 12px; border: 1px solid #dee2e6; display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="margin: 0; color: #2c3e50; display: flex; align-items: center; gap: 8px;">
                                <span style="color: #28a745;">📍</span> Your Delivery Address
                            </h3>
                            <button onclick="openAddressModal()" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 8px 16px; border-radius: 20px; font-size: 12px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                ✏️ Edit Address
                            </button>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            <div style="background: white; padding: 10px; border-radius: 8px; border-left: 3px solid #e74c3c;">
                                <div style="font-size: 10px; color: #666; margin-bottom: 3px;">STATE</div>
                                <div id="profileDisplayState" style="font-weight: 600; color: #2c3e50; font-size: 13px;"></div>
                            </div>
                            <div style="background: white; padding: 10px; border-radius: 8px; border-left: 3px solid #f39c12;">
                                <div style="font-size: 10px; color: #666; margin-bottom: 3px;">CITY</div>
                                <div id="profileDisplayCity" style="font-weight: 600; color: #2c3e50; font-size: 13px;"></div>
                            </div>
                            <div style="background: white; padding: 10px; border-radius: 8px; border-left: 3px solid #27ae60;">
                                <div style="font-size: 10px; color: #666; margin-bottom: 3px;">PINCODE</div>
                                <div id="profileDisplayPincode" style="font-weight: 600; color: #2c3e50; font-size: 13px;"></div>
                            </div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 12px; border-left: 3px solid #9b59b6;">
                            <div style="font-size: 10px; color: #666; margin-bottom: 3px;">FULL ADDRESS</div>
                            <div id="profileDisplayAddress" style="font-weight: 600; color: #2c3e50; font-size: 13px; line-height: 1.3;"></div>
                        </div>
                        <div style="background: white; padding: 10px; border-radius: 8px; border-left: 3px solid #1abc9c;">
                            <div style="font-size: 10px; color: #666; margin-bottom: 3px;">NEARBY LOCATION</div>
                            <div id="profileDisplayNearby" style="font-weight: 600; color: #2c3e50; font-size: 13px;"></div>
                        </div>
                        <div style="margin-top: 12px; padding: 10px; background: rgba(40, 167, 69, 0.1); border-radius: 8px; text-align: center;">
                            <div style="font-size: 12px; color: #28a745; font-weight: 500;">✓ This address will be used for all your orders</div>
                        </div>
                    </div>
                    
                    <!-- Address Form Modal -->
                    <div id="addressModal" class="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; justify-content: center; align-items: center;">
                        <div class="login-container" style="display: flex; position: relative; max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; background: white; border-radius: 12px;">
                            <button onclick="closeAddressModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666; z-index: 10;">×</button>
                            
                            <div style="padding: 20px 20px 10px 20px; text-align: center;">
                                <h2 style="margin: 0; color: #2c3e50; font-size: 20px;">Address</h2>
                            </div>
                            
                            <form class="auth-form" id="addressForm" onsubmit="event.preventDefault(); saveUserAddress();" style="display: block !important; padding: 0 20px 20px 20px;">
                                <div class="form-group" style="margin-bottom: 8px;">
                                    <input type="tel" id="userPhone" placeholder="Phone Number (10 digits)" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px;">
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                    <div class="form-group">
                                        <select id="userState" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px;" required>
                                            <option value="">Select State</option>
                                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                                <option value="Assam">Assam</option>
                                                <option value="Bihar">Bihar</option>
                                                <option value="Chhattisgarh">Chhattisgarh</option>
                                                <option value="Goa">Goa</option>
                                                <option value="Gujarat">Gujarat</option>
                                                <option value="Haryana">Haryana</option>
                                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                                <option value="Jharkhand">Jharkhand</option>
                                                <option value="Karnataka">Karnataka</option>
                                                <option value="Kerala">Kerala</option>
                                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                                <option value="Maharashtra">Maharashtra</option>
                                                <option value="Manipur">Manipur</option>
                                                <option value="Meghalaya">Meghalaya</option>
                                                <option value="Mizoram">Mizoram</option>
                                                <option value="Nagaland">Nagaland</option>
                                                <option value="Odisha">Odisha</option>
                                                <option value="Punjab">Punjab</option>
                                                <option value="Rajasthan">Rajasthan</option>
                                                <option value="Sikkim">Sikkim</option>
                                                <option value="Tamil Nadu">Tamil Nadu</option>
                                                <option value="Telangana">Telangana</option>
                                                <option value="Tripura">Tripura</option>
                                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                <option value="Uttarakhand">Uttarakhand</option>
                                                <option value="West Bengal">West Bengal</option>
                                                <option value="Delhi">Delhi</option>
                                                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                                <option value="Ladakh">Ladakh</option>
                                                <option value="Puducherry">Puducherry</option>
                                                <option value="Chandigarh">Chandigarh</option>
                                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                                <option value="Lakshadweep">Lakshadweep</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <select id="userCity" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px;" required>
                                                <option value="">Select City</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 8px;">
                                        <textarea id="userAddress" placeholder="Full Address (House no, Street, Area)" rows="2" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px; resize: none; min-height: 40px;"></textarea>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px;">
                                        <div class="form-group">
                                            <input type="text" id="userPincode" placeholder="Pincode (6 digits)" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px;">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" id="userNearby" placeholder="Nearby Landmark" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px;">
                                        </div>
                                    </div>
                                    <button type="submit" class="auth-btn" style="padding: 8px 16px; font-size: 12px; width: 100%;">Save Address</button>
                                </form>
                                <div id="currentAddressDisplay" style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #e8f5e8, #f0f8ff); border-radius: 10px; border: 1px solid #d4edda; display: none;">
                                    <h4 style="margin: 0 0 12px 0; color: #2c3e50; display: flex; align-items: center; gap: 8px;">
                                        <span style="color: #28a745;">📍</span> Your Current Saved Address
                                    </h4>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                                        <div style="background: white; padding: 8px; border-radius: 6px; border-left: 3px solid #3498db;">
                                            <div style="font-size: 10px; color: #666; margin-bottom: 2px;">STATE</div>
                                            <div id="displayState" style="font-weight: 600; color: #2c3e50; font-size: 12px;"></div>
                                        </div>
                                        <div style="background: white; padding: 8px; border-radius: 6px; border-left: 3px solid #e74c3c;">
                                            <div style="font-size: 10px; color: #666; margin-bottom: 2px;">CITY</div>
                                            <div id="displayCity" style="font-weight: 600; color: #2c3e50; font-size: 12px;"></div>
                                        </div>
                                        <div style="background: white; padding: 8px; border-radius: 6px; border-left: 3px solid #f39c12;">
                                            <div style="font-size: 10px; color: #666; margin-bottom: 2px;">PINCODE</div>
                                            <div id="displayPincode" style="font-weight: 600; color: #2c3e50; font-size: 12px;"></div>
                                        </div>
                                        <div style="background: white; padding: 8px; border-radius: 6px; border-left: 3px solid #27ae60;">
                                            <div style="font-size: 10px; color: #666; margin-bottom: 2px;">PHONE</div>
                                            <div id="displayPhone" style="font-weight: 600; color: #2c3e50; font-size: 12px;"></div>
                                        </div>
                                        <div style="background: white; padding: 8px; border-radius: 6px; border-left: 3px solid #1abc9c;">
                                            <div style="font-size: 10px; color: #666; margin-bottom: 2px;">NEARBY</div>
                                            <div id="displayNearby" style="font-weight: 600; color: #2c3e50; font-size: 12px;"></div>
                                        </div>
                                    </div>
                                    <div style="background: white; padding: 10px; border-radius: 6px; border-left: 3px solid #9b59b6;">
                                        <div style="font-size: 10px; color: #666; margin-bottom: 2px;">FULL ADDRESS</div>
                                        <div id="displayAddress" style="font-weight: 600; color: #2c3e50; font-size: 12px; line-height: 1.3;"></div>
                                    </div>
                                    <div style="margin-top: 10px; padding: 8px; background: rgba(40, 167, 69, 0.1); border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #28a745; font-weight: 500;">✓ You can edit any field above to update your address</div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Terms & Conditions Modal -->
                    <div id="termsModal" class="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; justify-content: center; align-items: center;">
                        <div class="login-container" style="display: flex; position: relative; max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; background: white; border-radius: 12px;">
                            <button onclick="closeTermsModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666; z-index: 1;">×</button>
                            
                            <div class="logo-section">
                                <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
                                <h1>Terms & Conditions</h1>
                                <p>Zupisupi App Terms of Service</p>
                            </div>

                            <div class="auth-form" style="display: block !important; padding: 10px; text-align: left; font-size: 12px; height: 100%; overflow-y: auto;">
                                <div style="color: #2c3e50; line-height: 1.3; padding-bottom: 20px;">
                                    <p style="margin-bottom: 8px; font-weight: 600; font-size: 13px;">Welcome to Zupisupi, an online shopping platform designed to provide you with a smooth and secure shopping experience. By using our app, you agree to the following Terms and Conditions:</p>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #3498db;">
                                        <h5 style="color: #3498db; margin: 0 0 3px 0; font-size: 12px;">1. Acceptance of Terms</h5>
                                        <p style="margin: 0; font-size: 11px;">By accessing or using Zupisupi, you agree to comply with these Terms. If you do not agree, please do not use the app.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e74c3c;">
                                        <h5 style="color: #e74c3c; margin: 0 0 3px 0; font-size: 12px;">2. Account Registration</h5>
                                        <p style="margin: 0; font-size: 11px;">• Users must provide accurate and complete details during registration.<br>• You are responsible for maintaining the confidentiality of your login credentials.<br>• You agree not to share your account with others.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #f39c12;">
                                        <h5 style="color: #f39c12; margin: 0 0 3px 0; font-size: 12px;">3. Eligibility</h5>
                                        <p style="margin: 0; font-size: 11px;">You must be at least 18 years old or have the consent of a legal guardian to use this app.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #27ae60;">
                                        <h5 style="color: #27ae60; margin: 0 0 3px 0; font-size: 12px;">4. Orders and Payments</h5>
                                        <p style="margin: 0; font-size: 11px;">• All orders placed through Zupisupi are subject to availability and confirmation.<br>• Prices listed on the app include all applicable taxes unless stated otherwise.<br>• We accept payments through UPI, Debit/Credit Card, Net Banking, and COD.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #9b59b6;">
                                        <h5 style="color: #9b59b6; margin: 0 0 3px 0; font-size: 12px;">5. Shipping and Delivery</h5>
                                        <p style="margin: 0; font-size: 11px;">• Delivery timelines may vary based on your location.<br>• Delays caused by logistics or unforeseen circumstances are beyond our control.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #1abc9c;">
                                        <h5 style="color: #1abc9c; margin: 0 0 3px 0; font-size: 12px;">6. Returns and Refunds</h5>
                                        <p style="margin: 0; font-size: 11px;">• Returns are accepted only if the product is damaged, defective, or incorrect.<br>• Refunds will be processed as per our Refund Policy within 5-7 business days.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e67e22;">
                                        <h5 style="color: #e67e22; margin: 0 0 3px 0; font-size: 12px;">7. Prohibited Activities</h5>
                                        <p style="margin: 0; font-size: 11px;">You agree not to:<br>• Use the app for any fraudulent activity.<br>• Post harmful or offensive content.<br>• Interfere with the app's security.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #34495e;">
                                        <h5 style="color: #34495e; margin: 0 0 3px 0; font-size: 12px;">8. Limitation of Liability</h5>
                                        <p style="margin: 0; font-size: 11px;">Zupisupi is not liable for any indirect, incidental, or consequential damages arising from the use of our app.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #16a085;">
                                        <h5 style="color: #16a085; margin: 0 0 3px 0; font-size: 12px;">9. Privacy Policy</h5>
                                        <p style="margin: 0; font-size: 11px;">Your personal information will be handled according to our Privacy Policy. We value your privacy and ensure your data is secure.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #8e44ad;">
                                        <h5 style="color: #8e44ad; margin: 0 0 3px 0; font-size: 12px;">10. Changes to Terms</h5>
                                        <p style="margin: 0; font-size: 11px;">We reserve the right to modify these Terms anytime. Users will be notified of major changes.</p>
                                    </div>
                                    
                                    <p style="margin-top: 10px; font-size: 10px; color: #7f8c8d; text-align: center;">Last updated: January 2024<br>For questions, contact us through the app.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Privacy Policy Modal -->
                    <div id="privacyModal" class="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; justify-content: center; align-items: center;">
                        <div class="login-container" style="display: flex; position: relative; max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; background: white; border-radius: 12px;">
                            <button onclick="closePrivacyModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666; z-index: 1;">×</button>
                            
                            <div class="logo-section">
                                <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
                                <h1>Privacy Policy</h1>
                                <p>Data protection and privacy</p>
                            </div>

                            <div class="auth-form" style="display: block !important; padding: 10px; text-align: left; font-size: 12px; height: 100%; overflow-y: auto;">
                                <div style="color: #2c3e50; line-height: 1.3; padding-bottom: 20px;">
                                    <p style="margin-bottom: 8px; font-weight: 600; font-size: 13px;">✅ Privacy Policy for Zupisupi</p>
                                    <p style="margin-bottom: 8px; font-size: 11px;">Last Updated: [Insert Date]</p>
                                    <p style="margin-bottom: 8px; font-size: 11px;">Zupisupi respects your privacy and is committed to protecting your personal information. This Privacy Policy explains how we collect, use, and protect your data when you use our app.</p>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #27ae60;">
                                        <h5 style="color: #27ae60; margin: 0 0 3px 0; font-size: 12px;">1. Information We Collect</h5>
                                        <p style="margin: 0; font-size: 11px;">We may collect:<br>
                                        • Personal Information: Name, email address, phone number, and shipping address (when you place an order).<br>
                                        • Usage Data: App activity, browsing behavior, and device information to improve the user experience.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #3498db;">
                                        <h5 style="color: #3498db; margin: 0 0 3px 0; font-size: 12px;">2. How We Use Your Information</h5>
                                        <p style="margin: 0; font-size: 11px;">We use your information to:<br>
                                        • Process and deliver your orders.<br>
                                        • Provide customer support.<br>
                                        • Improve our services and app experience.<br>
                                        • Send updates, offers, and promotions (only if you allow).</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e74c3c;">
                                        <h5 style="color: #e74c3c; margin: 0 0 3px 0; font-size: 12px;">3. Sharing of Information</h5>
                                        <p style="margin: 0; font-size: 11px;">• We do not sell, rent, or trade your personal information.<br>
                                        • We may share limited data with delivery partners to fulfill your order.<br>
                                        • We may disclose information if required by law.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #f39c12;">
                                        <h5 style="color: #f39c12; margin: 0 0 3px 0; font-size: 12px;">4. Data Security</h5>
                                        <p style="margin: 0; font-size: 11px;">We take reasonable measures to protect your data against unauthorized access, loss, or misuse. However, no method is 100% secure.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #9b59b6;">
                                        <h5 style="color: #9b59b6; margin: 0 0 3px 0; font-size: 12px;">5. Cookies & Tracking</h5>
                                        <p style="margin: 0; font-size: 11px;">We may use cookies or similar technologies to improve app functionality. You can disable them in your device settings.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #1abc9c;">
                                        <h5 style="color: #1abc9c; margin: 0 0 3px 0; font-size: 12px;">6. Your Rights</h5>
                                        <p style="margin: 0; font-size: 11px;">You can:<br>
                                        • Access or update your account details anytime.<br>
                                        • Request account deletion by contacting us.<br>
                                        • Opt out of promotional messages.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #34495e;">
                                        <h5 style="color: #34495e; margin: 0 0 3px 0; font-size: 12px;">7. Third-Party Links</h5>
                                        <p style="margin: 0; font-size: 11px;">Our app may contain links to third-party websites. We are not responsible for their privacy practices.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e67e22;">
                                        <h5 style="color: #e67e22; margin: 0 0 3px 0; font-size: 12px;">8. Policy Updates</h5>
                                        <p style="margin: 0; font-size: 11px;">We may update this Privacy Policy from time to time. Changes will be posted in the app.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- FAQ Modal -->
                    <div id="faqModal" class="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; justify-content: center; align-items: center;">
                        <div class="login-container" style="display: flex; position: relative; max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; background: white; border-radius: 12px;">
                            <button onclick="closeFAQModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666; z-index: 1;">×</button>
                            
                            <div class="logo-section">
                                <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
                                <h1>FAQ</h1>
                                <p>Frequently Asked Questions</p>
                            </div>

                            <div class="auth-form" style="display: block !important; padding: 10px; text-align: left; font-size: 12px; height: 100%; overflow-y: auto;">
                                <div style="color: #2c3e50; line-height: 1.3; padding-bottom: 20px;">
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #3498db;">
                                        <h5 style="color: #3498db; margin: 0 0 3px 0; font-size: 12px;">1. What is Zupisupi?</h5>
                                        <p style="margin: 0; font-size: 11px;">Zupisupi is an online shopping app that offers a wide range of products at affordable prices with easy payment options.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e74c3c;">
                                        <h5 style="color: #e74c3c; margin: 0 0 3px 0; font-size: 12px;">2. How can I place an order?</h5>
                                        <p style="margin: 0; font-size: 11px;">• Browse the products.<br>• Add your favorite items to the cart.<br>• Proceed to checkout and make payment.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #f39c12;">
                                        <h5 style="color: #f39c12; margin: 0 0 3px 0; font-size: 12px;">3. What payment methods do you accept?</h5>
                                        <p style="margin: 0; font-size: 11px;">We currently accept UPI, Debit/Credit Cards, Net Banking, and Cash on Delivery (COD).</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #27ae60;">
                                        <h5 style="color: #27ae60; margin: 0 0 3px 0; font-size: 12px;">4. How long does delivery take?</h5>
                                        <p style="margin: 0; font-size: 11px;">Delivery usually takes 3-7 business days, depending on your location.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #9b59b6;">
                                        <h5 style="color: #9b59b6; margin: 0 0 3px 0; font-size: 12px;">5. Can I return a product?</h5>
                                        <p style="margin: 0; font-size: 11px;">Yes, if:<br>• The product is damaged or defective.<br>• You received the wrong item.<br>Return requests must be raised within 7 days of delivery.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #1abc9c;">
                                        <h5 style="color: #1abc9c; margin: 0 0 3px 0; font-size: 12px;">6. How can I track my order?</h5>
                                        <p style="margin: 0; font-size: 11px;">Go to My Orders section in the app to track your shipment.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #e67e22;">
                                        <h5 style="color: #e67e22; margin: 0 0 3px 0; font-size: 12px;">7. Is my payment secure?</h5>
                                        <p style="margin: 0; font-size: 11px;">Yes! We use secure payment gateways and end-to-end encryption to protect your transactions.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #34495e;">
                                        <h5 style="color: #34495e; margin: 0 0 3px 0; font-size: 12px;">8. Do you offer refunds?</h5>
                                        <p style="margin: 0; font-size: 11px;">Refunds are processed to your original payment method within 5-7 business days after the return is approved.</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #16a085;">
                                        <h5 style="color: #16a085; margin: 0 0 3px 0; font-size: 12px;">9. How can I contact customer support?</h5>
                                        <p style="margin: 0; font-size: 11px;">You can contact us via:<br>• Email: [your email]<br>• Phone/WhatsApp: [your number]<br>• In-app Chat Support</p>
                                    </div>
                                    
                                    <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid #8e44ad;">
                                        <h5 style="color: #8e44ad; margin: 0 0 3px 0; font-size: 12px;">10. Do I need an account to shop?</h5>
                                        <p style="margin: 0; font-size: 11px;">Yes, you need to create an account to place orders, track them, and avail offers.</p>
                                    </div>
                                    
                                    <p style="margin-top: 10px; font-size: 10px; color: #7f8c8d; text-align: center;">Still have questions? Contact our customer support team!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanel" class="admin-modal" style="display: none;">
        <div class="admin-modal-content">
            <div class="admin-header">
                <h2>Admin Panel</h2>
                <button class="close-btn" onclick="closeAdminPanel()">&times;</button>
            </div>
            
            <div class="admin-tabs">
                <button class="tab-btn active" onclick="showTab('slides')">Slides</button>
                <button class="tab-btn" onclick="showTab('categories')">Categories</button>
                <button class="tab-btn" onclick="showTab('products')">Products</button>
                <button class="tab-btn" onclick="showTab('users')">Users</button>
                <button class="tab-btn" onclick="showTab('ordersAdmin')">Orders</button>
            </div>

            <!-- Slides Section -->
            <div id="slidesTab" class="tab-content active">
                <h3>Slideshow Management</h3>
                <div class="slide-form">
                    <input type="text" id="slideTitle" placeholder="Image Title" />
                    <input type="url" id="slideUrl" placeholder="Image Link" />
                    <button onclick="addSlide()">Add Slide</button>
                </div>
                <div class="slides-list" id="slidesList">
                    <!-- Current slides will be populated here -->
                </div>
            </div>

            <!-- Categories Section -->
            <div id="categoriesTab" class="tab-content">
                <h3>Category Management</h3>
                <div class="slide-form">
                    <input type="text" id="categoryName" placeholder="Category Name" />
                    <input type="url" id="categoryImageUrl" placeholder="Category Image URL" />
                    <button onclick="addCategory()">Add Category</button>
                </div>
                <div class="categories-list" id="categoriesAdminList">
                    <!-- Current categories will be populated here -->
                </div>
            </div>

            <!-- Products Section -->
            <div id="productsTab" class="tab-content">
                <h3>Product Management</h3>
                <form class="admin-form" onsubmit="event.preventDefault(); addProduct();">
                    <input type="text" id="productName" placeholder="Product Name" required>
                    <input type="url" id="productImageUrl" placeholder="Product Image URL" required>
                    <textarea id="productDescription" placeholder="Product Description" required></textarea>
                    <input type="number" id="productPrice" placeholder="Base Price (₹)" step="0.01" required>
                    <input type="number" id="deliveryCharge" placeholder="Delivery Charge (₹)" step="0.01" value="0">
                    <input type="text" id="productSubImages" placeholder="Sub Images URLs (comma separated)">
                    <select id="productCategory">
                        <option value="">Select Category</option>
                    </select>
                    <div style="margin: 10px 0;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Available Sizes & Pricing:</label>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; min-width: 60px;"><input type="checkbox" value="S" class="size-checkbox"> S</label>
                                <input type="number" id="priceS" placeholder="Price for S" step="0.01" style="flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; min-width: 60px;"><input type="checkbox" value="M" class="size-checkbox"> M</label>
                                <input type="number" id="priceM" placeholder="Price for M" step="0.01" style="flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; min-width: 60px;"><input type="checkbox" value="L" class="size-checkbox"> L</label>
                                <input type="number" id="priceL" placeholder="Price for L" step="0.01" style="flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; min-width: 60px;"><input type="checkbox" value="XL" class="size-checkbox"> XL</label>
                                <input type="number" id="priceXL" placeholder="Price for XL" step="0.01" style="flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; min-width: 60px;"><input type="checkbox" value="XXL" class="size-checkbox"> XXL</label>
                                <input type="number" id="priceXXL" placeholder="Price for XXL" step="0.01" style="flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn-primary">Add Product</button>
                </form>
                
                <!-- Search Bar for Products -->
                <div class="search-container" style="margin: 20px 0;">
                    <input type="text" id="productSearchInput" placeholder="Search products by name..." 
                           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px;"
                           oninput="searchProducts()">
                </div>
                
                <div class="admin-list" id="productsAdminList">
                    <!-- Products will be populated here -->
                </div>
            </div>

            <!-- Users Section -->
            <div id="usersTab" class="tab-content">
                <h3>User Management</h3>
                <div class="users-list" id="usersList">
                    <!-- Registered users will be populated here -->
                </div>
            </div>

            <!-- Admin Orders Section -->
            <div id="ordersAdminTab" class="tab-content">
                <h3>Order Management</h3>
                
                <!-- Filter and Search Controls -->
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select id="orderStatusFilter" onchange="filterOrders()" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 13px;">
                        <option value="all">All Orders</option>
                        <option value="Pending">Pending Orders</option>
                        <option value="Shipped">Shipped Orders</option>
                    </select>
                    
                    <input type="text" id="orderSearchInput" placeholder="Search by email or phone..." onkeyup="searchOrders()" style="flex: 1; min-width: 200px; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 13px;">
                    
                    <button onclick="clearFilters()" style="padding: 8px 12px; background: #6c757d; color: white; border: none; border-radius: 5px; font-size: 13px; cursor: pointer;">Clear</button>
                </div>
                
                <div class="admin-list" id="adminOrdersList">
                    <!-- Orders will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productModal" class="product-modal">
        <div class="product-modal-content">
            <div class="product-modal-header">
                <h2>Product Details</h2>
                <button class="close-btn" onclick="closeProductModal()">&times;</button>
            </div>
            <div class="product-modal-body" id="productModalBody">
                <!-- Product details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div id="cartOverlay" class="cart-overlay" onclick="closeCart()"></div>
    <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
            <h2>Shopping Cart</h2>
            <button class="cart-close" onclick="closeCart()">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be populated here -->
        </div>
        <div class="cart-total" id="cartTotal" style="display: none;">
            <div class="cart-total-amount" id="cartTotalAmount">Total: ₹0</div>
            <button class="cart-checkout" onclick="checkout()">Checkout</button>
        </div>

        <!-- App Bottom Navigation -->
        <div class="app-bottom-nav">
            <div class="app-nav-item active" onclick="setActiveTab('home')">
                <div class="app-nav-icon">🏠</div>
                <div class="app-nav-label">Home</div>
            </div>
            <div class="app-nav-item" onclick="setActiveTab('search')">
                <div class="app-nav-icon">🔍</div>
                <div class="app-nav-label">Search</div>
            </div>
            <div class="cart-nav-item app-nav-item" onclick="checkAuthAndSetTab('cart')">
                <div class="app-nav-icon">
                    🛒
                    <span class="cart-count" id="cartCountBottom" style="display: none;">0</span>
                </div>
                <div class="app-nav-label">Cart</div>
            </div>
            <div class="app-nav-item" onclick="checkAuthAndSetTab('orders')">
                <div class="app-nav-icon">📦</div>
                <div class="app-nav-label">Orders</div>
            </div>
            <div class="app-nav-item" onclick="checkAuthAndSetTab('profile')">
                <div class="app-nav-icon">👤</div>
                <div class="app-nav-label">Profile</div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot, setDoc, getDoc, updateDoc, query, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA_H9jJwyhfUrFoYCWZERf8R8W1o2TmqO0",
            authDomain: "desi-cart-wuaze.firebaseapp.com",
            projectId: "desi-cart-wuaze",
            storageBucket: "desi-cart-wuaze.firebasestorage.app",
            messagingSenderId: "891883106075",
            appId: "1:891883106075:web:c66fa32fe6fa8e8c36edbe"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        // Login modal functions
        window.showLoginModal = function() {
            if (currentUser) {
                logout();
                return;
            }
            document.getElementById('loginModal').style.display = 'flex';
        };

        window.closeLoginModal = function() {
            document.getElementById('loginModal').style.display = 'none';
        };

        // Form switching functions
        window.switchToRegister = function() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            loginForm.style.setProperty('display', 'none', 'important');
            registerForm.style.setProperty('display', 'block', 'important');
            
            // Clear login form
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
        };

        window.switchToLogin = function() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            registerForm.style.setProperty('display', 'none', 'important');
            loginForm.style.setProperty('display', 'block', 'important');
            
            // Clear register form
            document.getElementById('registerName').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerPhone').value = '';
            document.getElementById('registerPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        };

        // Helper function to check if input is email or phone
        function isEmail(input) {
            return input.includes('@') && input.includes('.');
        }

        // Find user by phone number in Firestore
        async function findUserByPhone(phone) {
            try {
                const usersQuery = query(
                    collection(db, 'users'),
                    where('phone', '==', phone)
                );
                const querySnapshot = await getDocs(usersQuery);
                
                if (!querySnapshot.empty) {
                    const userDoc = querySnapshot.docs[0];
                    return userDoc.data();
                }
                return null;
            } catch (error) {
                console.error('Error finding user by phone:', error);
                return null;
            }
        }

        // Updated login function to handle both email and phone
        window.loginWithEmailOrPhone = async function(emailOrPhone, password) {
            const loginBtn = document.querySelector('#loginForm .auth-btn');
            const originalText = loginBtn.textContent;
            
            try {
                // Show loading state
                loginBtn.textContent = 'Logging in...';
                loginBtn.disabled = true;
                
                let userCredential;
                
                if (isEmail(emailOrPhone)) {
                    // Login with email
                    userCredential = await signInWithEmailAndPassword(auth, emailOrPhone, password);
                } else {
                    // Login with phone - first find the email associated with this phone
                    const userData = await findUserByPhone(emailOrPhone);
                    if (!userData || !userData.email) {
                        throw new Error('No account found with this phone number.');
                    }
                    userCredential = await signInWithEmailAndPassword(auth, userData.email, password);
                }
                
                const user = userCredential.user;
                console.log('User logged in successfully:', user.email);
                
                showNotification(`Welcome back! Loading your data...`, 'success', 1000);
                closeLoginModal();
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
                
            } catch (error) {
                console.error('Login error:', error);
                let errorMessage = 'Login failed. Please check your credentials.';
                
                if (error.message === 'No account found with this phone number.') {
                    errorMessage = error.message;
                } else {
                    switch (error.code) {
                        case 'auth/user-not-found':
                            errorMessage = isEmail(emailOrPhone) ? 'No account found with this email.' : 'No account found with this phone number.';
                            break;
                        case 'auth/wrong-password':
                        case 'auth/invalid-credential':
                            errorMessage = 'Incorrect credentials. Please check your details.';
                            break;
                        case 'auth/invalid-email':
                            errorMessage = 'Invalid email address.';
                            break;
                        case 'auth/too-many-requests':
                            errorMessage = 'Too many failed attempts. Try again later.';
                            break;
                        case 'auth/network-request-failed':
                            errorMessage = 'Network error. Please check your connection.';
                            break;
                    }
                }
                
                showNotification(errorMessage, 'error');
                
                // Reset button
                loginBtn.textContent = originalText;
                loginBtn.disabled = false;
            }
        };

        window.registerWithEmailAndPhone = async function(name, email, phone, password) {
            const registerBtn = document.querySelector('#registerForm .auth-btn');
            const originalText = registerBtn.textContent;
            
            try {
                // Show loading state
                registerBtn.textContent = 'Creating Account...';
                registerBtn.disabled = true;
                
                // Check if phone number already exists
                const existingUser = await findUserByPhone(phone);
                if (existingUser) {
                    throw new Error('An account with this phone number already exists.');
                }
                
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                
                // Update user profile with display name
                await updateProfile(user, {
                    displayName: name
                });
                
                // Save user data to Firestore with phone number
                await setDoc(doc(db, 'users', user.uid), {
                    name: name,
                    email: email,
                    phone: phone,
                    createdAt: new Date(),
                    displayName: name
                });
                
                console.log('User registered successfully:', user.email);
                showNotification(`Welcome ${name}! Account created successfully.`, 'success', 1000);
                closeLoginModal();
                
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
                
            } catch (error) {
                console.error('Registration error:', error);
                let errorMessage = 'Registration failed. Please try again.';
                
                if (error.message === 'An account with this phone number already exists.') {
                    errorMessage = error.message;
                } else {
                    switch (error.code) {
                        case 'auth/email-already-in-use':
                            errorMessage = 'An account with this email already exists.';
                            break;
                        case 'auth/invalid-email':
                            errorMessage = 'Invalid email address.';
                            break;
                        case 'auth/weak-password':
                            errorMessage = 'Password should be at least 6 characters.';
                            break;
                        case 'auth/network-request-failed':
                            errorMessage = 'Network error. Please check your connection.';
                            break;
                    }
                }
                
                showNotification(errorMessage, 'error');
                
                // Reset button
                registerBtn.textContent = originalText;
                registerBtn.disabled = false;
            }
        };

        // Function to completely clear all user data
        function clearAllUserData() {
            // Clear all global variables
            cartItems = [];
            userAddressData = null;
            currentUser = null;
            welcomeMessageShown = false;
            productsData = [];
            categoriesData = [];
            slidesData = [];
            
            // Clear localStorage completely
            localStorage.clear();
            
            // Clear sessionStorage
            sessionStorage.clear();
            
            // Reset UI elements
            const cartCount = document.getElementById('cartCountBottom');
            if (cartCount) {
                cartCount.textContent = '0';
                cartCount.style.display = 'none';
            }
            
            // Clear any cached DOM elements
            const cartItems = document.getElementById('cartItems');
            if (cartItems) cartItems.innerHTML = '';
            
            const cartItemsMain = document.getElementById('cartItemsMain');
            if (cartItemsMain) cartItemsMain.innerHTML = '';
            
            const ordersContent = document.getElementById('ordersContent');
            if (ordersContent) ordersContent.innerHTML = '';
            
            console.log('All user data cleared completely');
        }

        window.logout = async function() {
            try {
                console.log('Starting logout process...');
                
                // Redirect to home page immediately on click
                setActiveTab('home');
                
                // Firebase logout
                await signOut(auth);
                console.log('User signed out successfully');
                
                // Clear all user data
                clearAllUserData();
                
                // Show logout notification
                showNotification('Logged out successfully! 👋', 'success', 1000);
                
                // Reload after 1 second - same as login
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
                
            } catch (error) {
                console.error('Error during sign-out:', error);
                
                // Redirect to home even on error
                setActiveTab('home');
                clearAllUserData();
                showNotification('Logged out! 👋', 'success', 1000);
                
                // Same reload pattern as login
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            }
        };

        // Track if welcome message has been shown
        let welcomeMessageShown = false;

        // Show main app after login
        function showMainApp(user) {
            console.log('showMainApp called with user:', user);
            currentUser = user;
            document.body.style.background = 'white';
            
            // Fix: Use correct element IDs
            const loginContainer = document.getElementById('loginContainer');
            const mainApp = document.querySelector('.main-app');
            
            console.log('loginContainer:', loginContainer);
            console.log('mainApp:', mainApp);
            
            if (loginContainer) {
                loginContainer.style.display = 'none';
            }
            if (mainApp) {
                mainApp.style.display = 'block';
            }
            
            // Show welcome notification only once per session
            if (!welcomeMessageShown) {
                showNotification(`Welcome, ${user.displayName || 'User'}! 🎉<br>You have successfully logged in.`, 'success', 5000);
                welcomeMessageShown = true;
            }
            
            // Update auth button to show "Logout" when user is logged in
            const authBtn = document.getElementById('authBtn');
            if (authBtn) {
                authBtn.textContent = 'Logout';
                authBtn.onclick = logout;
            }
            
            // Bottom navbar is always visible - no need to show/hide
            
            const welcomeMsg = document.querySelector('.welcome-message');
            if (welcomeMsg && user.displayName) {
                welcomeMsg.textContent = `Welcome, ${user.displayName}!`;
            }
            
            // Add user to registered users and update admin visibility
            addRegisteredUser(user);
            updateAdminVisibility(user);
            
            // Initialize slideshow
            initializeSlideshow();
            
            // Load data from Firebase
            loadSlidesFromFirebase();
            loadCategoriesFromFirebase();
            loadProductsFromFirebase();
            
            // Check and schedule existing completed/rejected orders for deletion
            checkAndScheduleExistingOrders();
            
            setTimeout(async () => {
                await loadCartFromFirebase();
                await loadUserAddressFromFirebase();
                
                // Update cart display after loading cart data
                updateCartCount();
                updateCartDisplayMain();
            }, 1000);
        }

        // Show login screen
        function showLoginScreen() {
            document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            
            // Reset welcome message flag when user logs out
            welcomeMessageShown = false;
            
            // Fix: Use correct element IDs
            const loginContainer = document.getElementById('loginContainer');
            const mainApp = document.querySelector('.main-app');
            
            if (loginContainer) {
                loginContainer.style.display = 'flex';
            }
            if (mainApp) {
                mainApp.style.display = 'none';
            }
            
            // Bottom navbar is always visible - no need to hide
        }

        // Listen for authentication state changes
        onAuthStateChanged(auth, (user) => {
            console.log('Auth state changed:', user ? 'User logged in' : 'User logged out');
            if (user) {
                // User is signed in
                console.log('User details:', user.displayName, user.email);
                showMainApp(user);
            } else {
                // User is signed out - but don't show login screen, show main app for guest browsing
                console.log('Guest mode - showing main app without login');
                currentUser = null;
                document.body.style.background = 'white';
                
                const loginContainer = document.getElementById('loginContainer');
                const mainApp = document.querySelector('.main-app');
                
                if (loginContainer) {
                    loginContainer.style.display = 'none';
                }
                if (mainApp) {
                    mainApp.style.display = 'block';
                }
                
                // Update auth button to show "Login"
                const authBtn = document.getElementById('authBtn');
                if (authBtn) {
                    authBtn.textContent = 'Login';
                    authBtn.onclick = showLoginModal;
                }
                
                // Load public data for guest browsing
                setTimeout(async () => {
                    await loadSlidesFromFirebase();
                    await loadCategoriesFromFirebase();
                    await loadProductsFromFirebase();
                }, 500);
            }
        });

        // Slideshow functionality
        let slideIndex = 0;
        let slideInterval;

        function showSlide(index) {
            const slides = document.querySelectorAll('.slides');
            const dots = document.querySelectorAll('.dot');
            
            // Hide all slides and remove active class from dots
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            // Show current slide only if slides exist
            if (slides[index] && slidesData.length > 0) {
                slides[index].classList.add('active');
                if (dots[index]) {
                    dots[index].classList.add('active');
                }
            }
        }

        function nextSlide() {
            if (slidesData.length > 0) {
                slideIndex = (slideIndex + 1) % slidesData.length;
                showSlide(slideIndex);
            }
        }

        function startSlideshow() {
            slideInterval = setInterval(nextSlide, 5000); // Change every 5 seconds
        }

        function stopSlideshow() {
            if (slideInterval) {
                clearInterval(slideInterval);
            }
        }

        // Manual slide navigation
        window.currentSlide = function(index) {
            slideIndex = index - 1; // Convert to 0-based index
            showSlide(slideIndex);
            stopSlideshow();
            startSlideshow(); // Restart auto-scroll
        };

        // Admin and User Management
        let currentUser = null;
        let adminUsers = ['moghaeashu@gmail.com']; // Permanent admin
        let registeredUsers = [];
        let slidesData = [];
        let categoriesData = [];
        let productsData = [];
        let selectedCategory = '';
        let cartItems = [];
        let userAddressData = null;

        // Load data from Firebase and localStorage
        async function loadData() {
            // Load admin and user data from localStorage
            const savedAdmins = localStorage.getItem('adminUsers');
            const savedUsers = localStorage.getItem('registeredUsers');
            
            if (savedAdmins) adminUsers = JSON.parse(savedAdmins);
            if (savedUsers) registeredUsers = JSON.parse(savedUsers);
            
            // Load slides from Firebase Firestore
            await loadSlidesFromFirebase();
            
            // Load categories from Firebase Firestore
            await loadCategoriesFromFirebase();
            
            // Load products from Firebase Firestore
            await loadProductsFromFirebase();
        }

        // Firebase User Address Functions
        async function saveUserAddressToFirebase(addressData) {
            try {
                if (!currentUser) return false;
                
                const userDocRef = doc(db, 'users', currentUser.uid);
                await setDoc(userDocRef, {
                    email: currentUser.email,
                    name: currentUser.displayName,
                    phone: addressData.phone,
                    state: addressData.state,
                    city: addressData.city,
                    address: addressData.address,
                    pincode: addressData.pincode,
                    nearby: addressData.nearby,
                    updatedAt: new Date()
                }, { merge: true });
                
                console.log('User address saved to Firebase');
                return true;
            } catch (error) {
                console.error('Error saving user address:', error);
                return false;
            }
        }

        async function loadUserAddressFromFirebase() {
            try {
                if (!currentUser) return null;
                
                const userDocRef = doc(db, 'users', currentUser.uid);
                const userDoc = await getDoc(userDocRef);
                
                if (userDoc.exists()) {
                    const userData = userDoc.data();
                    userAddressData = {
                        phone: userData.phone || '',
                        state: userData.state || '',
                        city: userData.city || '',
                        address: userData.address || '',
                        pincode: userData.pincode || '',
                        nearby: userData.nearby || ''
                    };
                    return userAddressData;
                }
                return null;
            } catch (error) {
                console.error('Error loading user address:', error);
                return null;
            }
        }

        // Firebase Cart Functions
        async function saveCartToFirebase() {
            try {
                if (!currentUser) return;
                
                const cartDocRef = doc(db, 'carts', currentUser.uid);
                if (cartItems.length === 0) {
                    // If cart is empty, delete the document
                    await deleteDoc(cartDocRef);
                    console.log('Empty cart removed from Firebase');
                } else {
                    await setDoc(cartDocRef, {
                        userId: currentUser.uid,
                        items: cartItems,
                        updatedAt: new Date()
                    });
                    console.log('Cart saved to Firebase');
                }
            } catch (error) {
                console.error('Error saving cart:', error);
            }
        }

        async function loadCartFromFirebase() {
            try {
                if (!currentUser) return;
                
                const cartDocRef = doc(db, 'carts', currentUser.uid);
                const cartDoc = await getDoc(cartDocRef);
                
                if (cartDoc.exists()) {
                    const cartData = cartDoc.data();
                    cartItems = cartData.items || [];
                    updateCartCount();
                    console.log('Cart loaded from Firebase:', cartItems.length, 'items');
                }
            } catch (error) {
                console.error('Error loading cart:', error);
            }
        }

        // Firebase Orders Functions
        async function saveOrderToFirebase(orderData) {
            try {
                if (!currentUser) return false;
                
                const orderDocRef = await addDoc(collection(db, 'orders'), {
                    userId: currentUser.uid,
                    userEmail: currentUser.email,
                    userName: currentUser.displayName,
                    ...orderData,
                    createdAt: new Date()
                });
                
                console.log('Order saved to Firebase with ID:', orderDocRef.id);
                return orderDocRef.id;
            } catch (error) {
                console.error('Error saving order:', error);
                return false;
            }
        }

        async function cancelOrderFromFirebase(orderId) {
            try {
                await deleteDoc(doc(db, 'orders', orderId));
                console.log('Order cancelled and removed from Firebase');
                return true;
            } catch (error) {
                console.error('Error cancelling order:', error);
                return false;
            }
        }

        async function loadOrdersFromFirebase() {
            try {
                if (!currentUser) return [];
                
                const ordersQuery = query(
                    collection(db, 'orders'),
                    where('userId', '==', currentUser.uid)
                );
                
                const querySnapshot = await getDocs(ordersQuery);
                const orders = [];
                
                querySnapshot.forEach((doc) => {
                    orders.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // Sort by creation date (newest first)
                orders.sort((a, b) => b.createdAt.toDate() - a.createdAt.toDate());
                
                console.log('Orders loaded from Firebase:', orders.length, 'orders');
                return orders;
            } catch (error) {
                console.error('Error loading orders:', error);
                return [];
            }
        }

        // Store all orders for filtering
        let allAdminOrders = [];

        // Admin: Load all pending and shipped orders across users
        async function loadPendingOrdersForAdmin() {
            try {
                const adminOrdersList = document.getElementById('adminOrdersList');
                if (!adminOrdersList) return;
                
                adminOrdersList.innerHTML = '<p style="text-align:center; color:#666; padding: 20px;">Loading orders...</p>';
                
                const ordersQuery = query(
                    collection(db, 'orders'),
                    where('status', 'in', ['Pending', 'Shipped'])
                );
                const snapshot = await getDocs(ordersQuery);

                allAdminOrders = [];
                snapshot.forEach(d => allAdminOrders.push({ id: d.id, ...d.data() }));

                // Sort newest first if createdAt exists
                allAdminOrders.sort((a, b) => {
                    const aTime = a.createdAt && a.createdAt.toDate ? a.createdAt.toDate().getTime() : 0;
                    const bTime = b.createdAt && b.createdAt.toDate ? b.createdAt.toDate().getTime() : 0;
                    return bTime - aTime;
                });

                displayFilteredOrders(allAdminOrders);
            } catch (error) {
                console.error('Error loading orders for admin:', error);
                const adminOrdersList = document.getElementById('adminOrdersList');
                if (adminOrdersList) adminOrdersList.innerHTML = '<p style="text-align:center; color:#e74c3c; padding: 20px;">Failed to load orders.</p>';
            }
        }

        // Display filtered orders
        function displayFilteredOrders(orders) {
            const adminOrdersList = document.getElementById('adminOrdersList');
            if (!adminOrdersList) return;

            adminOrdersList.innerHTML = '';
            if (orders.length === 0) {
                adminOrdersList.innerHTML = '<p style="text-align:center; color:#666; padding: 20px;">No orders found.</p>';
                return;
            }

            orders.forEach(order => {
                const el = document.createElement('div');
                el.className = 'admin-item';
                el.style.border = order.status === 'Shipped' ? '2px solid #3498db' : '1px solid #ddd';
                el.innerHTML = `
                    <div style="display:flex; gap:10px; align-items:flex-start;">
                        <img src="${order.productImage || ''}" alt="${order.productName || ''}" style="width:60px;height:60px;object-fit:contain;border-radius:6px;background:#f8f9fa;border:1px solid #e9ecef;" onerror="this.style.display='none'">
                        <div style="flex:1;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                <div style="font-weight:700; color:#2c3e50;">${order.productName || 'Product'}</div>
                                <span style="background: ${order.status === 'Pending' ? '#fff3cd' : '#d1ecf1'}; color: ${order.status === 'Pending' ? '#856404' : '#0c5460'}; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 600;">
                                    ${order.status === 'Pending' ? '⏳' : '🚚'} ${order.status}
                                </span>
                            </div>
                            <div style="font-size:12px; color:#666;">Qty: ${order.quantity || 1} • Total: ₹${(order.totalAmount || 0) + (order.deliveryCharge || 0)}</div>
                            <div style="font-size:12px; color:#666;">User: ${order.userName || ''} (${order.userEmail || ''})</div>
                            <div style="font-size:12px; color:#666;">📞 ${order.userPhone || ''} • 📍 ${order.userAddress || ''}</div>
                            <div style="font-size:12px; color:#666;">ID: <span style="font-family:monospace;">${order.id}</span></div>
                        </div>
                    </div>
                    <div style="display:flex; gap:8px; margin-top:10px;">
                        <button class="btn-invoice" style="flex:1; background:#3498db; border:none; padding:8px; border-radius:5px; color:white; font-size:12px;" onclick="showInvoice('${order.id}')">📄 Invoice</button>
                        ${order.status === 'Pending' ? `
                        <button class="btn-primary" style="flex:1; background:#3498db; border:none; padding:8px; border-radius:5px; color:white; font-size:12px;" onclick="adminShipOrder('${order.id}')">Ship</button>
                        ` : ''}
                        <button class="btn-success" style="flex:1; background:#27ae60; border:none; padding:8px; border-radius:5px; color:white; font-size:12px;" onclick="adminCompleteOrder('${order.id}')">Complete</button>
                        <button class="btn-danger" style="flex:1; background:#e74c3c; border:none; padding:8px; border-radius:5px; color:white; font-size:12px;" onclick="adminRejectOrder('${order.id}')">Reject</button>
                    </div>
                `;
                adminOrdersList.appendChild(el);
            });
        }

        // Filter orders by status
        window.filterOrders = function() {
            const filterValue = document.getElementById('orderStatusFilter').value;
            const searchValue = document.getElementById('orderSearchInput').value.toLowerCase();
            
            let filteredOrders = allAdminOrders;
            
            // Apply status filter
            if (filterValue !== 'all') {
                filteredOrders = filteredOrders.filter(order => order.status === filterValue);
            }
            
            // Apply search filter
            if (searchValue) {
                filteredOrders = filteredOrders.filter(order => 
                    (order.userEmail && order.userEmail.toLowerCase().includes(searchValue)) ||
                    (order.userPhone && order.userPhone.includes(searchValue))
                );
            }
            
            displayFilteredOrders(filteredOrders);
        }

        // Search orders by email or phone
        window.searchOrders = function() {
            filterOrders(); // Use the same filtering logic
        }

        // Clear all filters
        window.clearFilters = function() {
            document.getElementById('orderStatusFilter').value = 'all';
            document.getElementById('orderSearchInput').value = '';
            displayFilteredOrders(allAdminOrders);
        }

        // Admin: update order status to Shipped
        window.adminShipOrder = async function(orderId) {
            try {
                await updateDoc(doc(db, 'orders', orderId), { 
                    status: 'Shipped',
                    shippedAt: new Date()
                });
                
                showNotification('Order marked as shipped! 🚚', 'success');
                
                // Don't schedule deletion for shipped orders - keep them in admin panel
                // Only delete when admin marks as Complete or Reject
                
                loadPendingOrdersForAdmin();
                loadOrdersDataFromFirebase();
            } catch (e) {
                console.error('Error shipping order:', e);
                showNotification('Failed to ship order', 'error');
            }
        }

        // Admin: update order status to Completed
        window.adminCompleteOrder = async function(orderId) {
            try {
                await updateDoc(doc(db, 'orders', orderId), { 
                    status: 'Completed',
                    completedAt: new Date()
                });
                showNotification('Order marked as Completed ✅', 'success');
                
                // Schedule automatic deletion after 30 minutes
                scheduleOrderDeletion(orderId, 30 * 60 * 1000); // 30 minutes in milliseconds
                
                loadPendingOrdersForAdmin();
                // Also refresh user orders if currently viewing
                loadOrdersDataFromFirebase();
            } catch (e) {
                console.error('Error completing order:', e);
                showNotification('Failed to complete order', 'error');
            }
        }

        // Admin: update order status to Rejected
        window.adminRejectOrder = async function(orderId) {
            try {
                await updateDoc(doc(db, 'orders', orderId), { 
                    status: 'Rejected',
                    rejectedAt: new Date()
                });
                showNotification('Order marked as Rejected ❌', 'success');
                
                // Schedule automatic deletion after 30 minutes
                scheduleOrderDeletion(orderId, 30 * 60 * 1000); // 30 minutes in milliseconds
                
                loadPendingOrdersForAdmin();
                loadOrdersDataFromFirebase();
            } catch (e) {
                console.error('Error rejecting order:', e);
                showNotification('Failed to reject order', 'error');
            }
        }

        // Schedule order deletion after specified time
        function scheduleOrderDeletion(orderId, delayMs) {
            console.log(`Scheduling deletion of order ${orderId} in ${delayMs / 1000 / 60} minutes`);
            
            setTimeout(async () => {
                try {
                    await deleteDoc(doc(db, 'orders', orderId));
                    console.log(`Order ${orderId} automatically deleted after completion/rejection`);
                    
                    // Refresh orders display if user is currently viewing orders
                    if (currentUser) {
                        loadOrdersDataFromFirebase();
                    }
                    
                    // Refresh admin orders if admin panel is open
                    loadPendingOrdersForAdmin();
                    
                } catch (error) {
                    console.error(`Error auto-deleting order ${orderId}:`, error);
                }
            }, delayMs);
        }

        // Start countdown timer for order deletion
        function startCountdownTimer(orderId, statusChangeTime) {
            const countdownElement = document.getElementById(`countdown-${orderId}`);
            if (!countdownElement) return;
            
            const statusDate = statusChangeTime?.toDate ? statusChangeTime.toDate() : new Date(statusChangeTime);
            const thirtyMinutes = 30 * 60 * 1000; // 30 minutes in milliseconds
            
            function updateTimer() {
                const now = new Date();
                const timeSinceStatusChange = now.getTime() - statusDate.getTime();
                const remainingTime = thirtyMinutes - timeSinceStatusChange;
                
                if (remainingTime <= 0) {
                    countdownElement.textContent = 'Deleting...';
                    const timerDiv = document.getElementById(`timer-${orderId}`);
                    if (timerDiv) {
                        timerDiv.style.background = '#f8d7da';
                        timerDiv.style.color = '#721c24';
                        timerDiv.innerHTML = '🗑️ Order will be deleted shortly...';
                    }
                    
                    // Actually delete the order when timer reaches 0
                    setTimeout(async () => {
                        try {
                            await deleteDoc(doc(db, 'orders', orderId));
                            console.log(`Order ${orderId} deleted by timer`);
                            
                            // Refresh orders display
                            if (currentUser) {
                                loadOrdersDataFromFirebase();
                            }
                            
                            showNotification('Order automatically deleted 🗑️', 'info', 3000);
                        } catch (error) {
                            console.error(`Error deleting order ${orderId} by timer:`, error);
                        }
                    }, 2000); // Delete after 2 seconds of showing "deleting" message
                    
                    return;
                }
                
                const minutes = Math.floor(remainingTime / (1000 * 60));
                const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
                countdownElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Update immediately
            updateTimer();
            
            // Update every second
            const interval = setInterval(() => {
                updateTimer();
                
                // Stop timer when time is up
                const now = new Date();
                const timeSinceStatusChange = now.getTime() - statusDate.getTime();
                if (timeSinceStatusChange >= thirtyMinutes) {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // Check for existing completed/rejected orders on app load and schedule their deletion
        async function checkAndScheduleExistingOrders() {
            try {
                const completedQuery = query(
                    collection(db, 'orders'),
                    where('status', 'in', ['Completed', 'Rejected', 'Shipped'])
                );
                
                const snapshot = await getDocs(completedQuery);
                
                snapshot.forEach((doc) => {
                    const orderData = doc.data();
                    const completedAt = orderData.completedAt?.toDate();
                    const rejectedAt = orderData.rejectedAt?.toDate();
                    const shippedAt = orderData.shippedAt?.toDate();
                    const statusChangeTime = completedAt || rejectedAt || shippedAt;
                    
                    if (statusChangeTime) {
                        const timeSinceStatusChange = Date.now() - statusChangeTime.getTime();
                        const thirtyMinutes = 30 * 60 * 1000;
                        
                        if (timeSinceStatusChange >= thirtyMinutes) {
                            // Order is already past 30 minutes, delete immediately
                            deleteDoc(doc.ref).then(() => {
                                console.log(`Expired order ${doc.id} deleted immediately`);
                            }).catch(error => {
                                console.error(`Error deleting expired order ${doc.id}:`, error);
                            });
                        } else {
                            // Schedule deletion for remaining time
                            const remainingTime = thirtyMinutes - timeSinceStatusChange;
                            scheduleOrderDeletion(doc.id, remainingTime);
                        }
                    }
                });
            } catch (error) {
                console.error('Error checking existing orders for deletion:', error);
            }
        }

        // Save admin/user data to localStorage
        function saveData() {
            localStorage.setItem('adminUsers', JSON.stringify(adminUsers));
            localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
        }

        // Load slides from Firebase Firestore
        async function loadSlidesFromFirebase() {
            try {
                console.log('Loading slides from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'slides'));
                slidesData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found slide:', doc.id, doc.data());
                    slidesData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort slides by order if available, otherwise by creation time
                slidesData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total slides loaded:', slidesData.length);
                
                // Add fallback slides if no slides found
                if (slidesData.length === 0) {
                    console.log('No slides found, adding fallback slides');
                    slidesData = [
                        {
                            id: 'fallback1',
                            title: 'Welcome to Zupisupi',
                            url: 'https://via.placeholder.com/800x400/3498db/ffffff?text=Welcome+to+Zupisupi',
                            order: 0
                        },
                        {
                            id: 'fallback2', 
                            title: 'Shop Amazing Products',
                            url: 'https://via.placeholder.com/800x400/27ae60/ffffff?text=Shop+Amazing+Products',
                            order: 1
                        }
                    ];
                }
                
                updateSlideshow();
            } catch (error) {
                console.error('Error loading slides from Firebase:', error);
                // Fallback slides for error case
                slidesData = [
                    {
                        id: 'fallback1',
                        title: 'Welcome to Zupisupi',
                        url: 'https://via.placeholder.com/800x400/3498db/ffffff?text=Welcome+to+Zupisupi',
                        order: 0
                    }
                ];
                updateSlideshow();
            }
        }

        // Convert Google Drive sharing URL to direct image URL
        function convertGoogleDriveUrl(url) {
            if (url.includes('drive.google.com/file/d/')) {
                const fileId = url.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
                if (fileId && fileId[1]) {
                    // Try multiple formats for better compatibility
                    return `https://lh3.googleusercontent.com/d/${fileId[1]}=w800-h400-c`;
                }
            }
            return url; // Return original URL if not a Google Drive link
        }

        // Add slide to Firebase Firestore
        async function addSlideToFirebase(title, url) {
            try {
                // Convert Google Drive URL to direct image URL
                const convertedUrl = convertGoogleDriveUrl(url);
                console.log('Original URL:', url);
                console.log('Converted URL:', convertedUrl);
                
                const docRef = await addDoc(collection(db, 'slides'), {
                    title: title,
                    url: convertedUrl,
                    originalUrl: url,
                    order: slidesData.length,
                    createdAt: new Date(),
                    createdBy: currentUser?.email || 'unknown'
                });
                console.log('Slide added with ID: ', docRef.id);
                await loadSlidesFromFirebase(); // Refresh slides
                return true;
            } catch (error) {
                console.error('Error adding slide to Firebase:', error);
                return false;
            }
        }

        // Remove slide from Firebase Firestore
        async function removeSlideFromFirebase(slideId) {
            try {
                await deleteDoc(doc(db, 'slides', slideId));
                console.log('Slide removed from Firebase');
                await loadSlidesFromFirebase(); // Refresh slides
                return true;
            } catch (error) {
                console.error('Error removing slide from Firebase:', error);
                return false;
            }
        }

        // Load categories from Firebase Firestore
        async function loadCategoriesFromFirebase() {
            try {
                console.log('Loading categories from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'categories'));
                categoriesData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found category:', doc.id, doc.data());
                    categoriesData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort categories by order if available, otherwise by creation time
                categoriesData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total categories loaded:', categoriesData.length);
                
                // Add fallback categories if no categories found
                if (categoriesData.length === 0) {
                    console.log('No categories found, adding fallback categories');
                    categoriesData = [
                        {
                            id: 'clothing',
                            name: 'Clothing',
                            imageUrl: 'https://via.placeholder.com/200x150/e74c3c/ffffff?text=Clothing',
                            order: 0
                        },
                        {
                            id: 'footwear',
                            name: 'Footwear',
                            imageUrl: 'https://via.placeholder.com/200x150/3498db/ffffff?text=Footwear',
                            order: 1
                        },
                        {
                            id: 'accessories',
                            name: 'Accessories',
                            imageUrl: 'https://via.placeholder.com/200x150/27ae60/ffffff?text=Accessories',
                            order: 2
                        }
                    ];
                }
                
                updateCategoriesDisplay();
            } catch (error) {
                console.error('Error loading categories from Firebase:', error);
                // Fallback categories for error case
                categoriesData = [
                    {
                        id: 'general',
                        name: 'General',
                        imageUrl: 'https://via.placeholder.com/200x150/95a5a6/ffffff?text=General',
                        order: 0
                    }
                ];
                updateCategoriesDisplay();
            }
        }

        // Add category to Firebase Firestore
        async function addCategoryToFirebase(name, imageUrl) {
            try {
                const convertedUrl = convertGoogleDriveUrl(imageUrl);
                console.log('Adding category:', name, convertedUrl);
                
                const docRef = await addDoc(collection(db, 'categories'), {
                    name: name,
                    imageUrl: convertedUrl,
                    originalImageUrl: imageUrl,
                    order: categoriesData.length,
                    createdAt: new Date(),
                    createdBy: currentUser?.email || 'unknown'
                });
                console.log('Category added with ID: ', docRef.id);
                await loadCategoriesFromFirebase();
                return true;
            } catch (error) {
                console.error('Error adding category to Firebase:', error);
                return false;
            }
        }

        // Remove category from Firebase Firestore
        async function removeCategoryFromFirebase(categoryId) {
            try {
                await deleteDoc(doc(db, 'categories', categoryId));
                console.log('Category removed from Firebase');
                await loadCategoriesFromFirebase();
                return true;
            } catch (error) {
                console.error('Error removing category from Firebase:', error);
                return false;
            }
        }

        // Update categories display on main page
        function updateCategoriesDisplay() {
            const categoriesGrid = document.getElementById('categoriesGrid');
            if (!categoriesGrid) return;
            
            categoriesGrid.innerHTML = '';
            
            categoriesData.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.onclick = () => filterProductsByCategory(category.name);
                categoryItem.innerHTML = `
                    <img src="${category.imageUrl}" alt="${category.name}" class="category-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="category-info">
                        <h3 class="category-name">${category.name}</h3>
                    </div>
                `;
                categoriesGrid.appendChild(categoryItem);
            });
            
            // Update category dropdown in admin panel
            updateCategoryDropdown();
        }

        // Update category dropdown in admin panel
        function updateCategoryDropdown() {
            const categorySelect = document.getElementById('productCategory');
            if (!categorySelect) return;
            
            categorySelect.innerHTML = '<option value="">Select Category</option>';
            categoriesData.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
        }

        // Filter products by category
        function filterProductsByCategory(categoryName) {
            selectedCategory = categoryName;
            updateProductsDisplay();
        }

        // Admin category management functions
        window.addCategory = async function() {
            const name = document.getElementById('categoryName').value;
            const imageUrl = document.getElementById('categoryImageUrl').value;
            
            if (!name || !imageUrl) {
                showNotification('Please fill in both category name and image URL', 'warning');
                return;
            }
            
            if (categoriesData.length >= 10) {
                showNotification('Maximum 10 categories allowed', 'warning');
                return;
            }
            
            const success = await addCategoryToFirebase(name, imageUrl);
            if (success) {
                loadCategoriesAdminData();
                // Clear form
                document.getElementById('categoryName').value = '';
                document.getElementById('categoryImageUrl').value = '';
            } else {
                showNotification('Error adding category. Please try again.', 'error');
            }
        };

        window.removeCategory = async function(categoryId) {
            console.log('Attempting to remove category with ID:', categoryId);
            const success = await removeCategoryFromFirebase(categoryId);
            if (success) {
                loadCategoriesAdminData();
            } else {
                showNotification('Error removing category. Please try again.', 'error');
            }
        }

        function loadCategoriesAdminData() {
            const categoriesAdminList = document.getElementById('categoriesAdminList');
            if (!categoriesAdminList) return;
            
            categoriesAdminList.innerHTML = '';
            
            categoriesData.forEach((category, index) => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'slide-item';
                categoryItem.innerHTML = `
                    <div class="slide-info">
                        <div class="slide-title-admin">${category.name}</div>
                        <div class="slide-url">${category.originalImageUrl || category.imageUrl}</div>
                        <small style="color: #999;">ID: ${category.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeCategory('${category.id}')">Remove</button>
                    </div>
                `;
                categoriesAdminList.appendChild(categoryItem);
            });
        }

        // Load products from Firebase Firestore
        async function loadProductsFromFirebase() {
            try {
                console.log('Loading products from Firebase...');
                const querySnapshot = await getDocs(collection(db, 'products'));
                productsData = [];
                querySnapshot.forEach((doc) => {
                    console.log('Found product:', doc.id, doc.data());
                    productsData.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                // Sort products by order if available, otherwise by creation time
                productsData.sort((a, b) => (a.order || 0) - (b.order || 0));
                console.log('Total products loaded:', productsData.length);
                
                // Add fallback products if no products found
                if (productsData.length === 0) {
                    console.log('No products found, adding fallback products');
                    productsData = [
                        {
                            id: 'sample1',
                            name: 'Sample T-Shirt',
                            price: 299,
                            imageUrl: 'https://via.placeholder.com/300x300/e74c3c/ffffff?text=T-Shirt',
                            description: 'Comfortable cotton t-shirt',
                            category: 'Clothing'
                        },
                        {
                            id: 'sample2',
                            name: 'Sample Jeans',
                            price: 599,
                            imageUrl: 'https://via.placeholder.com/300x300/3498db/ffffff?text=Jeans',
                            description: 'Stylish denim jeans',
                            category: 'Clothing'
                        },
                        {
                            id: 'sample3',
                            name: 'Sample Shoes',
                            price: 899,
                            imageUrl: 'https://via.placeholder.com/300x300/27ae60/ffffff?text=Shoes',
                            description: 'Comfortable running shoes',
                            category: 'Footwear'
                        }
                    ];
                }
                
                updateProductsDisplay();
            } catch (error) {
                console.error('Error loading products from Firebase:', error);
                // Fallback products for error case
                productsData = [
                    {
                        id: 'sample1',
                        name: 'Sample Product',
                        price: 299,
                        imageUrl: 'https://via.placeholder.com/300x300/95a5a6/ffffff?text=Product',
                        description: 'Sample product description',
                        category: 'General'
                    }
                ];
                updateProductsDisplay();
            }
        }

        // Add product to Firebase Firestore
        async function addProductToFirebase(name, imageUrl, description, basePrice, subImages, category, sizes, sizePricing, deliveryCharge) {
            try {
                const convertedUrl = convertGoogleDriveUrl(imageUrl);
                const subImagesArray = subImages ? subImages.split(',').map(url => convertGoogleDriveUrl(url.trim())) : [];
                
                const productData = {
                    name: name,
                    imageUrl: convertedUrl,
                    description: description,
                    price: parseFloat(basePrice),
                    basePrice: parseFloat(basePrice),
                    deliveryCharge: parseFloat(deliveryCharge),
                    subImages: subImagesArray,
                    category: category,
                    sizes: sizes || [],
                    sizePricing: sizePricing || {},
                    createdAt: new Date().toISOString()
                };
                
                const docRef = await addDoc(collection(db, 'products'), productData);
                console.log('Product added with ID:', docRef.id);
                
                // Reload products data
                await loadProductsFromFirebase();
                loadProductsAdminData();
                
                return true;
            } catch (error) {
                console.error('Error adding product:', error);
                return false;
            }
        }

        // Remove product from Firebase Firestore
        async function removeProductFromFirebase(productId) {
            try {
                await deleteDoc(doc(db, 'products', productId));
                console.log('Product removed from Firebase');
                await loadProductsFromFirebase();
                return true;
            } catch (error) {
                console.error('Error removing product from Firebase:', error);
                return false;
            }
        }

        // Update products display on main page
        function updateProductsDisplay() {
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;

            productsGrid.innerHTML = '';

            // Filter products by selected category
            const filteredProducts = selectedCategory 
                ? productsData.filter(product => product.category === selectedCategory)
                : productsData;

            // Show all products in rows of 2
            const displayProducts = filteredProducts;

            displayProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => openProductModal(product.id);
                productCard.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">₹${product.price}</div>
                        <div class="product-buttons">
                            <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                            <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });

            // Show message if no products found for selected category
            if (filteredProducts.length === 0 && selectedCategory) {
                productsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1;">No products found in "${selectedCategory}" category.</p>`;
            }
        }

        // Admin product management functions
        window.addProduct = async function() {
            const name = document.getElementById('productName').value;
            const imageUrl = document.getElementById('productImageUrl').value;
            const description = document.getElementById('productDescription').value;
            const basePrice = document.getElementById('productPrice').value;
            const deliveryCharge = document.getElementById('deliveryCharge').value || 0;
            const subImages = document.getElementById('productSubImages').value;
            const category = document.getElementById('productCategory').value;
            
            // Get selected sizes and their prices
            const sizeCheckboxes = document.querySelectorAll('.size-checkbox:checked');
            const sizes = [];
            const sizePricing = {};
            
            sizeCheckboxes.forEach(checkbox => {
                const size = checkbox.value;
                const priceInput = document.getElementById(`price${size}`);
                const sizePrice = priceInput.value || basePrice;
                
                sizes.push(size);
                sizePricing[size] = parseFloat(sizePrice);
            });
            
            if (!name || !imageUrl || !description || !basePrice) {
                showNotification('Please fill in all required fields (name, image, description, base price)', 'warning');
                return;
            }
            
            if (productsData.length >= 20) {
                showNotification('Maximum 20 products allowed', 'warning');
                return;
            }
            
            if (await addProductToFirebase(name, imageUrl, description, basePrice, subImages, category, sizes, sizePricing, deliveryCharge)) {
                document.getElementById('productName').value = '';
                document.getElementById('productImageUrl').value = '';
                document.getElementById('productDescription').value = '';
                document.getElementById('productPrice').value = '';
                document.getElementById('deliveryCharge').value = '0';
                document.getElementById('productSubImages').value = '';
                document.getElementById('productCategory').value = '';
                // Clear size checkboxes and price inputs
                document.querySelectorAll('.size-checkbox').forEach(cb => cb.checked = false);
                ['S', 'M', 'L', 'XL', 'XXL'].forEach(size => {
                    document.getElementById(`price${size}`).value = '';
                });
                showNotification('Product added successfully! 🎉', 'success');
            } else {
                showNotification('Failed to add product. Please try again.', 'error');
            }
        };

        // Load products admin data with search functionality
        function loadProductsAdminData() {
            const productsAdminList = document.getElementById('productsAdminList');
            if (!productsAdminList) return;
            
            productsAdminList.innerHTML = '';
            
            // Get search term
            const searchInput = document.getElementById('productSearchInput');
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            
            // Filter products based on search term
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm)
            );
            
            filteredProducts.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'admin-item';
                productItem.innerHTML = `
                    <div class="item-info">
                        <strong>${product.name}</strong><br>
                        <span>Price: ₹${product.price}</span><br>
                        <span>Category: ${product.category || 'No category'}</span><br>
                        ${product.sizes && product.sizes.length > 0 ? `<span>Sizes: ${product.sizes.join(', ')}</span><br>` : ''}
                        <small style="color: #999;">ID: ${product.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeProduct('${product.id}')">Remove</button>
                    </div>
                `;
                productsAdminList.appendChild(productItem);
            });
            
            // Show message if no products found
            if (filteredProducts.length === 0 && searchTerm) {
                productsAdminList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No products found matching your search.</p>';
            }
        }

        // Search products function
        window.searchProducts = function() {
            loadProductsAdminData();
        };

        window.removeProduct = async function(productId) {
            console.log('Attempting to remove product with ID:', productId);
            const success = await removeProductFromFirebase(productId);
            if (success) {
                loadProductsAdminData();
            } else {
                showNotification('Error removing product. Please try again.', 'error');
            }
        };

        // Product detail modal functions
        window.openProductModal = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (!product) return;
            
            const modal = document.getElementById('productModal');
            const modalBody = document.getElementById('productModalBody');
            modalBody.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-modal-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik03NSA3NUgxMjVWMTI1SDc1Vjc1WiIgZmlsbD0iI0RERERERCIvPgo8L3N2Zz4K'">
                <h3 class="product-modal-name">${product.name}</h3>
                <div class="product-modal-price" id="price-${product.id}">₹${product.price}</div>
                <p class="product-modal-description">${product.description}</p>
                ${product.category ? `<p><strong>Category:</strong> ${product.category}</p>` : ''}
                ${product.deliveryCharge ? `<p style="color: #27ae60; font-weight: 600;">Delivery Charge: ₹${product.deliveryCharge}</p>` : ''}
                
                ${product.sizes && product.sizes.length > 0 ? `
                <div style="margin: 15px 0;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">Size:</label>
                    <select id="size-${product.id}" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px;" onchange="updatePriceBySize('${product.id}')">
                        <option value="">Select Size</option>
                        ${product.sizes.map(size => `<option value="${size}">${size}</option>`).join('')}
                    </select>
                </div>
                ` : ''}
                
                <div class="product-modal-quantity">
                    <span class="quantity-label">Quantity:</span>
                    <div class="quantity-controls">
                        <button class="quantity-btn" onclick="changeQuantity('${product.id}', -1)">-</button>
                        <input type="number" id="quantity-${product.id}" class="quantity-input" value="1" min="1" max="10" onchange="updateTotalPrice('${product.id}')">
                        <button class="quantity-btn" onclick="changeQuantity('${product.id}', 1)">+</button>
                    </div>
                    <div class="total-price" id="total-${product.id}">Total: ₹${product.price}</div>
                </div>
                
                <div class="product-modal-buttons">
                    <button class="btn-cart" onclick="addToCartWithQuantity('${product.id}')">Add to Cart</button>
                    <button class="btn-order" onclick="orderNowWithQuantity('${product.id}')">Order Now</button>
                </div>
            `;
            
            modal.style.display = 'flex';
        };

        // Open product modal from cart (without Add to Cart button)
        window.openProductModalFromCart = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (!product) return;
            
            // Find the cart item to get its quantity and size
            const cartItem = cartItems.find(item => item.id === productId);
            const quantity = cartItem ? cartItem.quantity : 1;
            const size = cartItem ? cartItem.size : '';
            
            const modal = document.getElementById('productModal');
            const modalBody = document.getElementById('productModalBody');
            // Get size-specific price if available
            let currentPrice = product.price; // base price
            if (size && product.sizePricing && product.sizePricing[size]) {
                currentPrice = product.sizePricing[size];
            }
            
            const deliveryCharge = product.deliveryCharge || 0;
            const totalAmount = (currentPrice * quantity) + deliveryCharge;
            
            modalBody.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-modal-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik03NSA3NUgxMjVWMTI1SDc1Vjc1WiIgZmlsbD0iI0RERERERCIvPgo8L3N2Zz4K'">
                <h3 class="product-modal-name">${product.name}</h3>
                <div class="product-modal-price">₹${currentPrice}</div>
                <p class="product-modal-description">${product.description}</p>
                ${product.category ? `<p><strong>Category:</strong> ${product.category}</p>` : ''}
                ${size ? `<p><strong>Size:</strong> ${size}</p>` : ''}
                <p><strong>Quantity:</strong> ${quantity}</p>
                <p><strong>Unit Price:</strong> ₹${currentPrice}</p>
                ${deliveryCharge > 0 ? `<p style="color: #27ae60; font-weight: 600;"><strong>🚚 Delivery Charge:</strong> ₹${deliveryCharge}</p>` : ''}
                <p style="font-size: 18px; font-weight: 700; color: #27ae60;"><strong>Total Amount:</strong> ₹${totalAmount}</p>
                
                <div class="product-modal-buttons">
                    <button class="btn-order" onclick="orderFromCart('${product.id}')">Order Now</button>
                </div>
            `;
            
            modal.style.display = 'flex';
        };

        window.closeProductModal = function() {
            document.getElementById('productModal').style.display = 'none';
        };

        // Quantity control functions
        // Update price based on selected size
        window.updatePriceBySize = function(productId) {
            const product = productsData.find(p => p.id === productId);
            const sizeSelect = document.getElementById(`size-${productId}`);
            const selectedSize = sizeSelect.value;
            
            let currentPrice = product.price; // base price
            
            // Check if size-specific pricing exists
            if (selectedSize && product.sizePricing && product.sizePricing[selectedSize]) {
                currentPrice = product.sizePricing[selectedSize];
            }
            
            // Update price display
            const priceElement = document.getElementById(`price-${productId}`);
            if (priceElement) {
                priceElement.textContent = `₹${currentPrice}`;
            }
            
            // Update total price
            updateTotalPrice(productId);
        };

        window.changeQuantity = function(productId, change) {
            const quantityInput = document.getElementById(`quantity-${productId}`);
            let currentQuantity = parseInt(quantityInput.value);
            currentQuantity += change;
            
            if (currentQuantity < 1) currentQuantity = 1;
            if (currentQuantity > 10) currentQuantity = 10;
            
            quantityInput.value = currentQuantity;
            updateTotalPrice(productId);
        };

        window.updateTotalPrice = function(productId) {
            const product = productsData.find(p => p.id === productId);
            const quantity = parseInt(document.getElementById(`quantity-${productId}`).value);
            const sizeSelect = document.getElementById(`size-${productId}`);
            
            let currentPrice = product.price; // base price
            
            // Check if size is selected and has specific pricing
            if (sizeSelect && sizeSelect.value && product.sizePricing && product.sizePricing[sizeSelect.value]) {
                currentPrice = product.sizePricing[sizeSelect.value];
            }
            
            const total = currentPrice * quantity;
            const totalElement = document.getElementById(`total-${productId}`);
            if (totalElement) {
                totalElement.textContent = `Total: ₹${total}`;
            }
        };

        // Updated cart and order functions with quantity
        window.addToCartWithQuantity = async function(productId) {
            const product = productsData.find(p => p.id === productId);
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const quantity = parseInt(quantityInput.value) || 1;
            
            // Get selected size if available
            let selectedSize = '';
            const sizeSelect = document.getElementById(`size-${productId}`);
            if (sizeSelect && product.sizes && product.sizes.length > 0) {
                selectedSize = sizeSelect.value;
                if (!selectedSize) {
                    showNotification('Please select a size before adding to cart.', 'warning');
                    return;
                }
            }
            
            if (product) {
                // Get size-specific price
                let currentPrice = product.price; // base price
                if (selectedSize && product.sizePricing && product.sizePricing[selectedSize]) {
                    currentPrice = product.sizePricing[selectedSize];
                }
                
                const existingItem = cartItems.find(item => item.id === productId && item.size === selectedSize);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cartItems.push({
                        id: product.id,
                        name: product.name,
                        price: currentPrice,
                        imageUrl: product.imageUrl,
                        quantity: quantity,
                        size: selectedSize
                    });
                }
                
                updateCartCount();
                await saveCartToFirebase();
                const sizeText = selectedSize ? ` (Size: ${selectedSize})` : '';
                showNotification(`${quantity} x ${product.name}${sizeText} added to cart!`, 'success');
                closeProductModal();
            }
        };

        let orderItems = [];

        // Custom notification system
        function showNotification(message, type = 'success', duration = 4000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            notification.innerHTML = `
                <button class="notification-close" onclick="this.parentElement.remove()">&times;</button>
                ${message}
            `;
            
            container.appendChild(notification);
            
            // Show notification with animation
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto remove after duration
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentElement) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, duration);
        }

        // Order function specifically for cart items (like checkout but for single item)
        window.orderFromCart = async function(productId) {
            const product = productsData.find(p => p.id === productId);
            const cartItem = cartItems.find(item => item.id === productId);
            
            if (!product || !cartItem) {
                showNotification('Product not found in cart.', 'error');
                return;
            }
            
            // Reload user address data to ensure it's current
            await loadUserAddressFromFirebase();
            
            // Check if user has address saved with stricter validation
            if (!userAddressData || 
                !userAddressData.phone || 
                !userAddressData.address || 
                userAddressData.phone.trim() === '' || 
                userAddressData.address.trim() === '') {
                
                showNotification('❌ Order cannot be placed!<br><br>📍 Please add your delivery address first:<br>1. Go to Profile section<br>2. Click "Edit Address"<br>3. Fill phone number and address<br>4. Save and try ordering again', 'error', 8000);
                
                // Automatically switch to profile section
                setTimeout(() => {
                    setActiveTab('profile');
                }, 1000);
                return;
            }
            
            // Use the cart item's price (which already has size-based pricing)
            const deliveryCharge = product.deliveryCharge || 0;
            const orderData = {
                productId: product.id,
                productName: product.name,
                productPrice: cartItem.price,
                productImage: product.imageUrl,
                productSize: cartItem.size || '',
                quantity: cartItem.quantity,
                deliveryCharge: deliveryCharge,
                totalAmount: (cartItem.price * cartItem.quantity) + deliveryCharge,
                userPhone: userAddressData ? userAddressData.phone : 'Not provided',
                userAddress: userAddressData ? userAddressData.address : 'Not provided',
                orderDate: new Date().toLocaleDateString(),
                status: 'Pending',
                orderType: 'Single Item Order'
            };
            
            // Remove item from cart immediately for real-time effect
            const itemIndex = cartItems.findIndex(item => item.id === productId);
            if (itemIndex > -1) {
                cartItems.splice(itemIndex, 1);
                updateCartCount();
                updateCartDisplay();
                updateCartDisplayMain();
            }
            
            // Close modal immediately
            closeProductModal();
            
            try {
                // Save order to Firebase
                const orderId = await saveOrderToFirebase(orderData);
                
                if (orderId) {
                    // Update cart in Firebase
                    await saveCartToFirebase();
                    
                    // Refresh Orders section in real-time
                    await loadOrdersDataFromFirebase();
                    
                    // Show success message
                    showNotification(`Order placed successfully!<br><br>Product: ${product.name}<br>Quantity: ${cartItem.quantity}<br>Total: ₹${orderData.totalAmount}`, 'success');
                    
                    console.log('Order placed:', orderData);
                } else {
                    // If order failed, add item back to cart
                    cartItems.push(cartItem);
                    updateCartCount();
                    updateCartDisplay();
                    updateCartDisplayMain();
                    showNotification('Failed to place order. Please try again.', 'error');
                }
            } catch (error) {
                // If error, add item back to cart
                cartItems.push(cartItem);
                updateCartCount();
                updateCartDisplay();
                updateCartDisplayMain();
                console.error('Order error:', error);
                showNotification('Error placing order. Please try again.', 'error');
            }
        };

        window.orderNowWithQuantity = async function(productId) {
            const product = productsData.find(p => p.id === productId);
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const quantity = parseInt(quantityInput.value) || 1;
            
            // Get selected size if available
            let selectedSize = '';
            const sizeSelect = document.getElementById(`size-${productId}`);
            if (sizeSelect && product.sizes && product.sizes.length > 0) {
                selectedSize = sizeSelect.value;
                if (!selectedSize) {
                    showNotification('Please select a size before placing order.', 'warning');
                    return;
                }
            }
            
            if (product) {
                // Reload user address data to ensure it's current
                await loadUserAddressFromFirebase();
                
                // Check if user has address saved with stricter validation
                if (!userAddressData || 
                    !userAddressData.phone || 
                    !userAddressData.address || 
                    userAddressData.phone.trim() === '' || 
                    userAddressData.address.trim() === '') {
                    
                    showNotification('❌ Order cannot be placed!<br><br>📍 Please add your delivery address first:<br>1. Go to Profile section<br>2. Click "Edit Address"<br>3. Fill phone number and address<br>4. Save and try ordering again', 'error', 8000);
                    
                    // Automatically switch to profile section
                    setTimeout(() => {
                        setActiveTab('profile');
                    }, 1000);
                    return;
                }
                
                // Get size-specific price
                let currentPrice = product.price; // base price
                if (selectedSize && product.sizePricing && product.sizePricing[selectedSize]) {
                    currentPrice = product.sizePricing[selectedSize];
                }
                
                const deliveryCharge = product.deliveryCharge || 0;
                const orderData = {
                    productId: product.id,
                    productName: product.name,
                    productPrice: currentPrice,
                    productImage: product.imageUrl,
                    productSize: selectedSize,
                    quantity: quantity,
                    deliveryCharge: deliveryCharge,
                    totalAmount: (currentPrice * quantity) + deliveryCharge,
                    userPhone: userAddressData.phone,
                    userAddress: `${userAddressData.address}, ${userAddressData.city}, ${userAddressData.state} - ${userAddressData.pincode}${userAddressData.nearby ? ', Near ' + userAddressData.nearby : ''}`,
                    orderDate: new Date().toLocaleDateString(),
                    status: 'Pending'
                };
                
                const orderId = await saveOrderToFirebase(orderData);
                if (orderId) {
                    showNotification(`Order placed successfully! 🎉<br>Order ID: ${orderId}<br>Total: ₹${orderData.totalAmount}`, 'success', 6000);
                    closeProductModal();
                } else {
                    showNotification('Error placing order. Please try again.', 'error');
                }
            }
        };

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('productModal');
            if (event.target === modal) {
                closeProductModal();
            }
        });

        // Show all products when clicking outside categories
        window.showAllProducts = function() {
            selectedCategory = '';
            updateProductsDisplay();
        };

        // Cart functionality
        window.openCart = function() {
            document.getElementById('cartSidebar').classList.add('open');
            document.getElementById('cartOverlay').style.display = 'block';
            updateCartDisplay();
        };

        window.closeCart = function() {
            document.getElementById('cartSidebar').classList.remove('open');
            document.getElementById('cartOverlay').style.display = 'none';
        };

        window.addToCart = async function(productId) {
            if (!currentUser) {
                showNotification('Please login or register to add items to cart! 🔐', 'warning', 4000);
                showLoginModal();
                return;
            }
            
            const product = productsData.find(p => p.id === productId);
            if (product) {
                const existingItem = cartItems.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cartItems.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        imageUrl: product.imageUrl,
                        quantity: 1
                    });
                }
                updateCartCount();
                updateCartDisplay();
                updateCartDisplayMain();
                await saveCartToFirebase();
                showNotification(`${product.name} added to cart! 🛒`, 'success');
            }
        };

        // Cancel Order Function
        window.cancelOrder = async function(orderId) {
            const success = await cancelOrderFromFirebase(orderId);
            if (success) {
                showNotification('Order cancelled successfully! ❌', 'success');
                loadOrdersDataFromFirebase(); // Refresh orders list
            } else {
                showNotification('Error cancelling order. Please try again.', 'error');
            }
        };

        // Address Form Functions
        window.showAddressForm = async function() {
            const modal = document.getElementById('addressModal');
            modal.style.display = 'flex';
            
            // Load user address data in modal
            await loadUserAddressInModal();
        };

        window.closeAddressModal = function() {
            document.getElementById('addressModal').style.display = 'none';
        };


        function updateCartCount() {
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            
            // Update bottom navbar cart count
            const cartCountBottom = document.getElementById('cartCountBottom');
            if (cartCountBottom) {
                cartCountBottom.textContent = totalItems;
                cartCountBottom.style.display = totalItems > 0 ? 'flex' : 'none';
            }
        }

        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartTotalAmount = document.getElementById('cartTotalAmount');
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<div class="cart-empty">Your cart is empty</div>';
                cartTotal.style.display = 'none';
                return;
            }
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cartItems.forEach(item => {
                total += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="cart-item-image" onclick="openProductModalFromCart('${item.id}')" style="cursor: pointer;">
                    <div class="cart-item-info" onclick="openProductModalFromCart('${item.id}')" style="cursor: pointer;">
                        <div class="cart-item-name">${item.name}</div>
                        ${item.size ? `<div style="color: #666; font-size: 12px;">Size: ${item.size}</div>` : ''}
                        <div class="cart-item-price">₹${item.price} x ${item.quantity}</div>
                    </div>
                    <button class="cart-item-remove" onclick="removeFromCart('${item.id}')">Remove</button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalAmount.textContent = `Total: ₹${total}`;
            cartTotal.style.display = 'block';
        }

        // Update cart display for main page section
        function updateCartDisplayMain() {
            const cartItemsContainer = document.getElementById('cartItemsMain');
            const cartTotal = document.getElementById('cartTotalMain');
            const cartTotalAmount = document.getElementById('cartTotalAmountMain');
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = '<div class="cart-empty-main">Your cart is empty<br>Add some products to get started!</div>';
                cartTotal.style.display = 'none';
                return;
            }
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cartItems.forEach(item => {
                total += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item-main';
                cartItem.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.name}" class="cart-item-image-main" onclick="openProductModalFromCart('${item.id}')">
                    <div class="cart-item-info-main" onclick="openProductModalFromCart('${item.id}')">
                        <div class="cart-item-name-main">${item.name}</div>
                        ${item.size ? `<div style="color: #666; font-size: 12px; margin-bottom: 3px;">Size: ${item.size}</div>` : ''}
                        <div class="cart-item-price-main">₹${item.price} x ${item.quantity}</div>
                    </div>
                    <button class="cart-item-remove-main" onclick="removeFromCart('${item.id}')">Remove</button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalAmount.textContent = `Total: ₹${total}`;
            cartTotal.style.display = 'block';
        }

        window.removeFromCart = async function(productId) {
            const removedItem = cartItems.find(item => item.id === productId);
            cartItems = cartItems.filter(item => item.id !== productId);
            updateCartCount();
            updateCartDisplay();
            updateCartDisplayMain();
            await saveCartToFirebase();
            
            // Show removal notification
            if (removedItem) {
                showNotification(`${removedItem.name} removed from cart! 🗑️`, 'success');
            }
        };

        window.checkout = async function() {
            if (cartItems.length === 0) {
                showNotification('Your cart is empty! 🛒', 'warning');
                return;
            }
            
            // Reload user address data to ensure it's current
            await loadUserAddressFromFirebase();
            
            // Check if user has address saved with stricter validation
            if (!userAddressData || 
                !userAddressData.phone || 
                !userAddressData.address || 
                userAddressData.phone.trim() === '' || 
                userAddressData.address.trim() === '') {
                
                showNotification('❌ Order cannot be placed!<br><br>📍 Please add your delivery address first:<br>1. Go to Profile section<br>2. Click "Edit Address"<br>3. Fill phone number and address<br>4. Save and try ordering again', 'error', 8000);
                
                // Automatically switch to profile section
                setTimeout(() => {
                    setActiveTab('profile');
                }, 1000);
                return;
            }
            
            const total = cartItems.reduce((sum, item) => {
                const product = productsData.find(p => p.id === item.id);
                const deliveryCharge = product ? (product.deliveryCharge || 0) : 0;
                return sum + (item.price * item.quantity) + deliveryCharge;
            }, 0);
            
            // Create order for each cart item
            const orderPromises = cartItems.map(item => {
                const product = productsData.find(p => p.id === item.id);
                const deliveryCharge = product ? (product.deliveryCharge || 0) : 0;
                const orderData = {
                    productId: item.id,
                    productName: item.name,
                    productPrice: item.price,
                    productImage: item.imageUrl,
                    productSize: item.size || '',
                    quantity: item.quantity,
                    deliveryCharge: deliveryCharge,
                    totalAmount: (item.price * item.quantity) + deliveryCharge,
                    userPhone: userAddressData.phone,
                    userAddress: `${userAddressData.address}, ${userAddressData.city}, ${userAddressData.state} - ${userAddressData.pincode}${userAddressData.nearby ? ', Near ' + userAddressData.nearby : ''}`,
                    orderDate: new Date().toLocaleDateString(),
                    status: 'Pending',
                    orderType: 'Cart Checkout'
                };
                return saveOrderToFirebase(orderData);
            });
            
            try {
                const orderIds = await Promise.all(orderPromises);
                const successfulOrders = orderIds.filter(id => id);
                
                if (successfulOrders.length === cartItems.length) {
                    showNotification(`Checkout successful! 🎉<br>${successfulOrders.length} orders placed<br>Total amount: ₹${total}`, 'success', 6000);
                    cartItems = [];
                    updateCartCount();
                    updateCartDisplay();
                    updateCartDisplayMain();
                    await saveCartToFirebase(); // Clear cart in Firebase
                    
                    // Refresh Orders section in real-time
                    await loadOrdersDataFromFirebase();
                    
                    closeCart();
                } else {
                    showNotification('Some orders failed to process. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Checkout error:', error);
                showNotification('Error during checkout. Please try again.', 'error');
            }
        };

        window.orderNow = async function(productId) {
            if (!currentUser) {
                showNotification('Please login or register to place orders! 🔐', 'warning', 4000);
                showLoginModal();
                return;
            }
            
            const product = productsData.find(p => p.id === productId);
            if (product) {
                // Reload user address data to ensure it's current
                await loadUserAddressFromFirebase();
                
                // Check if user has address saved with stricter validation
                if (!userAddressData || 
                    !userAddressData.phone || 
                    !userAddressData.address || 
                    userAddressData.phone.trim() === '' || 
                    userAddressData.address.trim() === '') {
                    
                    showNotification('❌ Order cannot be placed!<br><br>📍 Please add your delivery address first:<br>1. Go to Profile section<br>2. Click "Edit Address"<br>3. Fill phone number and address<br>4. Save and try ordering again', 'error', 8000);
                    
                    // Automatically switch to profile section
                    setTimeout(() => {
                        setActiveTab('profile');
                    }, 1000);
                    return;
                }
                
                const orderData = {
                    productId: product.id,
                    productName: product.name,
                    productPrice: product.price,
                    productImage: product.imageUrl,
                    quantity: 1,
                    totalAmount: product.price,
                    userPhone: userAddressData.phone,
                    userAddress: `${userAddressData.address}, ${userAddressData.city}, ${userAddressData.state} - ${userAddressData.pincode}${userAddressData.nearby ? ', Near ' + userAddressData.nearby : ''}`,
                    orderDate: new Date().toLocaleDateString(),
                    status: 'Pending'
                };
                
                const orderId = await saveOrderToFirebase(orderData);
                if (orderId) {
                    showNotification(`Order placed successfully! 🎉<br>Order ID: ${orderId}<br>Total: ₹${orderData.totalAmount}`, 'success', 6000);
                } else {
                    showNotification('Error placing order. Please try again.', 'error');
                }
            }
        };

        // Check authentication before accessing protected features
        window.checkAuthAndSetTab = function(tab) {
            console.log('checkAuthAndSetTab called with:', tab, 'currentUser:', currentUser);
            if (!currentUser) {
                showNotification('Please login or register to use app features! 🔐', 'warning', 4000);
                showLoginModal();
                return;
            }
            console.log('User authenticated, setting tab:', tab);
            setActiveTab(tab);
        };

        // App Navigation functionality
        window.setActiveTab = function(tab) {
            console.log('Setting active tab:', tab);
            
            // Remove active class from all tabs
            document.querySelectorAll('.app-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked tab - find the correct nav item
            const navItems = document.querySelectorAll('.app-nav-item');
            navItems.forEach(item => {
                const label = item.querySelector('.app-nav-label');
                if (label && label.textContent.toLowerCase() === tab.toLowerCase()) {
                    item.classList.add('active');
                }
            });
            
            // Hide all sections
            document.querySelectorAll('.app-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            switch(tab) {
                case 'home':
                    document.getElementById('homeSection').classList.add('active');
                    break;
                case 'search':
                    document.getElementById('searchSection').classList.add('active');
                    loadAllProductsInSearch();
                    break;
                case 'cart':
                    console.log('Activating cart section');
                    const cartSection = document.getElementById('cartSection');
                    if (cartSection) {
                        cartSection.classList.add('active');
                        console.log('Cart section activated, updating display');
                        // Force reload cart data and update display
                        setTimeout(async () => {
                            if (currentUser) {
                                await loadCartFromFirebase();
                            }
                            updateCartDisplayMain();
                            console.log('Cart data reloaded, items count:', cartItems.length);
                        }, 100);
                    } else {
                        console.error('Cart section not found!');
                    }
                    break;
                case 'orders':
                    document.getElementById('ordersSection').classList.add('active');
                    loadOrdersDataFromFirebase();
                    break;
                case 'profile':
                    document.getElementById('profileSection').classList.add('active');
                    updateProfileInfo();
                    loadAddressInProfileSection();
                    break;
            }
        };

        // Search functionality
        window.performSearch = function() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                searchProductsInSection(searchTerm);
            } else {
                loadAllProductsInSearch();
            }
        };

        // Add real-time search
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.trim();
                    if (searchTerm) {
                        searchProductsInSection(searchTerm);
                    } else {
                        loadAllProductsInSearch();
                    }
                });
            }
        });

        function loadAllProductsInSearch() {
            const searchProductsGrid = document.getElementById('searchProductsGrid');
            if (!searchProductsGrid) return;
            
            searchProductsGrid.innerHTML = '';
            
            productsData.forEach(product => {
                const productCard = createProductCard(product);
                searchProductsGrid.appendChild(productCard);
            });
        }

        function searchProductsInSection(searchTerm) {
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                (product.category && product.category.toLowerCase().includes(searchTerm.toLowerCase()))
            );
            
            const searchProductsGrid = document.getElementById('searchProductsGrid');
            if (!searchProductsGrid) return;
            
            searchProductsGrid.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                searchProductsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1; padding: 40px;">No products found for "${searchTerm}".</p>`;
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = createProductCard(product);
                searchProductsGrid.appendChild(productCard);
            });
        }

        function createProductCard(product) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.onclick = () => openProductModal(product.id);
            productCard.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                <div class="product-info">
                    <h3 class="product-name">${product.name}</h3>
                    <div class="product-price">₹${product.price}</div>
                    <div class="product-buttons">
                        <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                        <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                    </div>
                </div>
            `;
            return productCard;
        }

        function updateProfileInfo() {
            if (currentUser) {
                document.getElementById('profileName').textContent = currentUser.displayName || 'User';
                document.getElementById('profileEmail').textContent = currentUser.email || 'user@email.com';
                document.getElementById('profileImage').src = currentUser.photoURL || '';
            }
        }

        // Load and display orders from Firebase
        async function loadOrdersDataFromFirebase() {
            const ordersContent = document.getElementById('ordersContent');
            const noOrdersMessage = document.getElementById('noOrdersMessage');
            
            try {
                const orders = await loadOrdersFromFirebase();
                // Update global orders data for invoice functionality
                globalOrdersData = orders;
                
                if (orders.length === 0) {
                    noOrdersMessage.style.display = 'block';
                    // Clear existing orders
                    const existingOrders = ordersContent.querySelectorAll('.order-item');
                    existingOrders.forEach(order => order.remove());
                    return;
                }
                
                noOrdersMessage.style.display = 'none';
                
                // Clear existing orders except the no orders message
                const existingOrders = ordersContent.querySelectorAll('.order-item');
                existingOrders.forEach(order => order.remove());
                
                orders.forEach(order => {
                    const orderElement = document.createElement('div');
                    orderElement.className = 'order-item';
                    orderElement.style.cssText = `
                        background: white;
                        border-radius: 12px;
                        padding: 15px;
                        margin-bottom: 15px;
                        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
                        border: 1px solid #f0f0f0;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        width: 100%;
                        box-sizing: border-box;
                        overflow: hidden;
                    `;
                    
                    // Add hover effect
                    orderElement.addEventListener('mouseenter', () => {
                        orderElement.style.transform = 'translateY(-1px)';
                        orderElement.style.boxShadow = '0 6px 20px rgba(0, 0, 0, 0.12)';
                    });
                    orderElement.addEventListener('mouseleave', () => {
                        orderElement.style.transform = 'translateY(0)';
                        orderElement.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.08)';
                    });
                    
                    orderElement.innerHTML = `
                        <!-- Top section: Image + Name/Description -->
                        <div style="display: flex; gap: 12px; align-items: flex-start; margin-bottom: 15px;">
                            <div style="flex-shrink: 0;">
                                <img src="${order.productImage}" alt="${order.productName}" 
                                     style="width: 70px; height: 70px; object-fit: contain; border-radius: 8px; background: #f8f9fa; border: 1px solid #e9ecef;"
                                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCA3MCA3MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjcwIiBoZWlnaHQ9IjcwIiBmaWxsPSIjRjhGOUZBIi8+CjxwYXRoIGQ9Ik0yNSAyNUg0NVY0NUgyNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+Cg=='">
                            </div>
                            <div style="flex: 1; min-width: 0;">
                                <h3 style="font-size: 16px; font-weight: 700; color: #2c3e50; margin: 0 0 5px 0; line-height: 1.3; word-break: break-word;">${order.productName}</h3>
                                <div style="font-size: 12px; color: #666; margin-bottom: 3px;">Order ID: <span style="font-family: monospace; background: #f8f9fa; padding: 1px 4px; border-radius: 3px;">${order.id.substring(0, 12)}...</span></div>
                                <div style="font-size: 12px; color: #666;">📅 ${order.orderDate}</div>
                            </div>
                        </div>
                        
                        <!-- Middle section: Half width for quantity/amount/size, Half width for total -->
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <div style="flex: 1; background: #f8f9fa; padding: 10px; border-radius: 6px;">
                                <div style="font-size: 13px; color: #666; margin-bottom: 3px;">Quantity: <strong>${order.quantity}</strong></div>
                                <div style="font-size: 13px; color: #666; margin-bottom: 3px;">Unit Price: ₹${order.productPrice}</div>
                                ${order.productSize ? `<div style="font-size: 13px; color: #666; margin-bottom: 3px;">Size: <strong>${order.productSize}</strong></div>` : ''}
                                ${order.deliveryCharge ? `<div style="font-size: 13px; color: #27ae60; font-weight: 600;">🚚 Delivery: ₹${order.deliveryCharge}</div>` : ''}
                            </div>
                            <div style="flex: 1; background: #e8f5e8; padding: 10px; border-radius: 6px; text-align: center; display: flex; flex-direction: column; justify-content: center;">
                                <div style="font-size: 12px; color: #27ae60; margin-bottom: 2px;">Total Amount</div>
                                <div style="font-size: 18px; font-weight: 700; color: #27ae60;">₹${order.totalAmount + (order.deliveryCharge || 0)}</div>
                            </div>
                        </div>
                        
                        <!-- Status section: Full width -->
                        <div style="width: 100%; margin-bottom: 15px; text-align: center;">
                            <span style="background: ${order.status === 'Pending' ? '#fff3cd' : (order.status === 'Shipped' ? '#d1ecf1' : (order.status === 'Rejected' ? '#f8d7da' : '#d4edda'))}; color: ${order.status === 'Pending' ? '#856404' : (order.status === 'Shipped' ? '#0c5460' : (order.status === 'Rejected' ? '#721c24' : '#155724'))}; padding: 8px 20px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase; display: inline-block;">
                                ${order.status === 'Pending' ? '⏳' : (order.status === 'Shipped' ? '🚚' : (order.status === 'Rejected' ? '❌' : '✅'))} ${order.status}
                            </span>
                        </div>
                        
                        <!-- Delivery info -->
                        <div style="background: #f0f8ff; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 12px; color: #666;">
                            <div style="font-weight: 600; margin-bottom: 5px; color: #2c3e50;">🚚 Delivery Information:</div>
                            <div style="margin-bottom: 3px;">📞 Phone: ${order.userPhone || 'Not provided'}</div>
                            <div>📍 Address: ${order.userAddress || 'Not provided'}</div>
                        </div>
                        
                        <!-- Action buttons -->
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <!-- Invoice button: Show for all orders -->
                            <button onclick="showInvoice('${order.id}')" 
                                    style="flex: 1; background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);"
                                    onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(52, 152, 219, 0.4)'"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(52, 152, 219, 0.3)'">
                                📄 Invoice
                            </button>
                            
                            <!-- Cancel button: Only show for Pending orders -->
                            ${order.status === 'Pending' ? `
                            <button onclick="cancelOrder('${order.id}')" 
                                    style="flex: 1; background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);"
                                    onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(231, 76, 60, 0.4)'"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(231, 76, 60, 0.3)'">
                                ❌ Cancel Order
                            </button>
                            ` : ''}
                        </div>
                        
                        <!-- Status display for non-pending orders -->
                        ${order.status !== 'Pending' ? `
                        <div style="margin-top: 10px;">
                        ${order.status === 'Shipped' ? `
                            <div style="width: 100%; text-align: center; padding: 12px; background: linear-gradient(135deg, #d1ecf1, #bee5eb); border-radius: 8px; color: #0c5460; font-size: 14px; font-weight: 600; border: 1px solid #b8daff;">
                                🚚 Your Order is Shipped!<br>
                                <span style="font-size: 12px; font-weight: 400;">Your order will be delivered shortly</span>
                            </div>
                        ` : order.status === 'Completed' ? `
                            <div style="width: 100%; text-align: center; padding: 12px; background: #d4edda; border-radius: 8px; color: #155724; font-size: 14px; font-weight: 600;">
                                ✅ Order Delivered Successfully!<br>
                                <span style="font-size: 12px; font-weight: 400;">Thank you for your order!</span><br>
                            ⏰ Auto-delete in: <span id="countdown-${order.id}">Loading...</span>
                            </div>
                        ` : `
                            <div style="width: 100%; text-align: center; padding: 12px; background: #f8f9fa; border-radius: 8px; color: #666; font-size: 14px; font-weight: 600;">
                                ❌ Order Cancelled
                            </div>
                        `}
                        </div>
                        ` : ''}
                    `;
                    ordersContent.appendChild(orderElement);
                    
                    // Start countdown timer for completed/rejected/shipped orders
                    if (order.status === 'Completed' || order.status === 'Rejected' || order.status === 'Shipped') {
                        startCountdownTimer(order.id, order.completedAt || order.rejectedAt || order.shippedAt);
                    }
                });
            } catch (error) {
                console.error('Error loading orders:', error);
                noOrdersMessage.textContent = 'Error loading orders. Please try again.';
                noOrdersMessage.style.display = 'block';
            }
        }

        function searchProducts(searchTerm) {
            const filteredProducts = productsData.filter(product => 
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.description.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;
            
            productsGrid.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                productsGrid.innerHTML = `<p style="text-align: center; color: #666; grid-column: 1 / -1;">No products found for "${searchTerm}".</p>`;
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => openProductModal(product.id);
                productCard.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjZjNmNGY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OWFhMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K'">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">₹${product.price}</div>
                        <div class="product-buttons">
                            <button class="btn-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Add to Cart</button>
                            <button class="btn-order" onclick="event.stopPropagation(); orderNow('${product.id}')">Order Now</button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // Check if user is admin
        function isAdmin(email) {
            return adminUsers.includes(email);
        }

        // Show/hide admin button based on user role
        function updateAdminVisibility(user) {
            const adminBtn = document.getElementById('adminBtn');
            if (adminBtn && user && isAdmin(user.email)) {
                adminBtn.style.display = 'block';
            } else if (adminBtn) {
                adminBtn.style.display = 'none';
            }
        }

        // Add user to registered users list
        function addRegisteredUser(user) {
            const existingUser = registeredUsers.find(u => u.email === user.email);
            if (!existingUser) {
                registeredUsers.push({
                    name: user.displayName,
                    email: user.email,
                    isAdmin: isAdmin(user.email)
                });
                saveData();
            }
        }

        // Admin Panel Functions
        window.openAdminPanel = function() {
            document.getElementById('adminPanel').style.display = 'flex';
            loadAdminData();
        };

        window.closeAdminPanel = function() {
            document.getElementById('adminPanel').style.display = 'none';
        };

        window.showTab = function(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'slides') {
                loadSlidesData();
            } else if (tabName === 'categories') {
                loadCategoriesAdminData();
            } else if (tabName === 'products') {
                loadProductsAdminData();
            } else if (tabName === 'users') {
                loadUsersData();
            } else if (tabName === 'ordersAdmin') {
                loadPendingOrdersForAdmin();
            }
        };

        // Slideshow Management
        window.addSlide = async function() {
            const title = document.getElementById('slideTitle').value;
            const url = document.getElementById('slideUrl').value;
            
            if (!title || !url) {
                showNotification('Please fill in both title and URL', 'warning');
                return;
            }
            
            if (slidesData.length >= 5) {
                showNotification('Maximum 5 slides allowed', 'warning');
                return;
            }
            
            // Add to Firebase instead of localStorage
            const success = await addSlideToFirebase(title, url);
            if (success) {
                loadSlidesData();
                // Clear form
                document.getElementById('slideTitle').value = '';
                document.getElementById('slideUrl').value = '';
            } else {
                showNotification('Error adding slide. Please try again.', 'error');
            }
        };

        window.removeSlide = async function(slideId) {
            console.log('Attempting to remove slide with ID:', slideId);
            const success = await removeSlideFromFirebase(slideId);
            if (success) {
                loadSlidesData();
            } else {
                showNotification('Error removing slide. Please try again.', 'error');
            }
        }

        function loadSlidesData() {
            const slidesList = document.getElementById('slidesList');
            slidesList.innerHTML = '';
            
            slidesData.forEach((slide, index) => {
                const slideItem = document.createElement('div');
                slideItem.className = 'slide-item';
                slideItem.innerHTML = `
                    <div class="slide-info">
                        <div class="slide-title-admin">${slide.title}</div>
                        <div class="slide-url">${slide.originalUrl || slide.url}</div>
                        <small style="color: #999;">ID: ${slide.id}</small>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-danger" onclick="removeSlide('${slide.id}')">Remove</button>
                    </div>
                `;
                slidesList.appendChild(slideItem);
            });
        }

        // User Management
        window.toggleAdmin = function(email) {
            if (email === 'moghaeashu@gmail.com') {
                showNotification('Cannot modify permanent admin', 'warning');
                return;
            }
            
            const userIndex = registeredUsers.findIndex(u => u.email === email);
            if (userIndex !== -1) {
                const isCurrentlyAdmin = adminUsers.includes(email);
                
                if (isCurrentlyAdmin) {
                    adminUsers = adminUsers.filter(admin => admin !== email);
                    registeredUsers[userIndex].isAdmin = false;
                } else {
                    adminUsers.push(email);
                    registeredUsers[userIndex].isAdmin = true;
                }
                
                saveData();
                loadUsersData();
            }
        };

        function loadUsersData() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            registeredUsers.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                const isPermanentAdmin = user.email === 'moghaeashu@gmail.com';
                
                userItem.innerHTML = `
                    <div class="user-info">
                        <div class="user-name">${user.name}${user.isAdmin ? '<span class="admin-badge">ADMIN</span>' : ''}</div>
                        <div class="user-email">${user.email}</div>
                    </div>
                    <div class="action-buttons">
                        ${!isPermanentAdmin ? 
                            `<button class="${user.isAdmin ? 'btn-danger' : 'btn-success'}" onclick="toggleAdmin('${user.email}')">
                                ${user.isAdmin ? 'Remove Admin' : 'Make Admin'}
                            </button>` : 
                            '<span style="color: #f39c12; font-size: 12px;">Permanent Admin</span>'
                        }
                    </div>
                `;
                usersList.appendChild(userItem);
            });
        }

        function loadAdminData() {
            loadSlidesData();
            loadUsersData();
        }

        // Update slideshow with current data
        function updateSlideshow() {
            console.log('Updating slideshow with', slidesData.length, 'slides');
            const slideshowContainer = document.querySelector('.slideshow-container');
            const dotsContainer = document.querySelector('.dots-container');
            
            if (!slideshowContainer || !dotsContainer) {
                console.error('Slideshow containers not found');
                return;
            }
            
            // Clear existing slides
            const existingSlides = slideshowContainer.querySelectorAll('.slides');
            existingSlides.forEach(slide => slide.remove());
            
            // Clear existing dots
            dotsContainer.innerHTML = '';
            
            // If no slides, show empty message
            if (slidesData.length === 0) {
                slideshowContainer.innerHTML = '<div style="padding: 50px; text-align: center; color: #666;">No slides added yet. Admin can add slides through the admin panel.</div>';
                console.log('Showing empty state message');
                return;
            }
            
            // Add new slides
            slidesData.forEach((slide, index) => {
                console.log(`Adding slide ${index + 1}:`, slide.title, slide.url);
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slides';
                if (index === 0) slideDiv.classList.add('active');
                
                slideDiv.innerHTML = `
                    <img src="${slide.url}" 
                         alt="${slide.title}" 
                         style="width: 100%; height: 250px; object-fit: cover;"
                         onload="console.log('Image loaded successfully:', this.src)"
                         onerror="
                            console.error('Failed to load image:', this.src);
                            const fileId = '${slide.url}'.match(/\/d\/([a-zA-Z0-9_-]+)/);
                            if (fileId && fileId[1]) {
                                console.log('Trying alternative URL format...');
                                this.src = 'https://drive.google.com/uc?export=view&id=' + fileId[1];
                                this.onerror = function() {
                                    console.log('Alternative format also failed, trying thumbnail...');
                                    this.src = 'https://drive.google.com/thumbnail?id=' + fileId[1] + '&sz=w800-h400';
                                    this.onerror = function() {
                                        console.log('All formats failed, showing placeholder');
                                        this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4=';
                                    };
                                };
                            }
                         ">
                    <div class="slide-content">
                        <div class="slide-title">${slide.title}</div>
                        <div class="slide-description">Discover amazing products and deals</div>
                    </div>
                `;
                
                slideshowContainer.appendChild(slideDiv);
                
                // Add dot
                const dot = document.createElement('span');
                dot.className = 'dot';
                if (index === 0) dot.classList.add('active');
                dot.onclick = () => currentSlide(index + 1);
                dotsContainer.appendChild(dot);
            });
            
            // Reset slideshow
            slideIndex = 0;
            stopSlideshow();
            if (slidesData.length > 1) {
                startSlideshow();
            }
            
            console.log('Slideshow updated successfully');
        }

        // State-City mapping for Indian states
        const stateCityMap = {
            "Andhra Pradesh": ["Visakhapatnam", "Vijayawada", "Guntur", "Nellore", "Kurnool", "Rajahmundry", "Tirupati", "Kadapa", "Anantapur", "Eluru"],
            "Arunachal Pradesh": ["Itanagar", "Naharlagun", "Pasighat", "Tezpur", "Bomdila", "Ziro", "Along", "Changlang", "Tezu", "Khonsa"],
            "Assam": ["Guwahati", "Silchar", "Dibrugarh", "Jorhat", "Nagaon", "Tinsukia", "Tezpur", "Bongaigaon", "Karimganj", "Sivasagar"],
            "Bihar": ["Patna", "Gaya", "Bhagalpur", "Muzaffarpur", "Purnia", "Darbhanga", "Bihar Sharif", "Arrah", "Begusarai", "Katihar"],
            "Chhattisgarh": ["Raipur", "Bhilai", "Korba", "Bilaspur", "Durg", "Rajnandgaon", "Jagdalpur", "Raigarh", "Ambikapur", "Mahasamund"],
            "Goa": ["Panaji", "Margao", "Vasco da Gama", "Mapusa", "Ponda", "Bicholim", "Curchorem", "Sanquelim", "Cuncolim", "Quepem"],
            "Gujarat": ["Ahmedabad", "Surat", "Vadodara", "Rajkot", "Bhavnagar", "Jamnagar", "Junagadh", "Gandhinagar", "Anand", "Navsari", "Morbi", "Mehsana", "Bharuch", "Vapi", "Palanpur", "Godhra", "Bhuj", "Porbandar", "Nadiad", "Surendranagar", "Gandhidham", "Veraval", "Mahesana", "Patan", "Botad", "Amreli", "Deesa", "Jetpur", "Kalol", "Dahod", "Botad", "Khambhat", "Mahuva", "Modasa", "Keshod", "Una", "Sidhpur", "Wankaner", "Limbdi", "Mandvi", "Thangadh", "Vyara", "Padra", "Lunawada", "Rajula", "Radhanpur", "Vijapur"],
            "Haryana": ["Faridabad", "Gurgaon", "Panipat", "Ambala", "Yamunanagar", "Rohtak", "Hisar", "Karnal", "Sonipat", "Panchkula"],
            "Himachal Pradesh": ["Shimla", "Dharamshala", "Solan", "Mandi", "Palampur", "Baddi", "Nahan", "Paonta Sahib", "Sundernagar", "Chamba"],
            "Jharkhand": ["Ranchi", "Jamshedpur", "Dhanbad", "Bokaro", "Deoghar", "Phusro", "Hazaribagh", "Giridih", "Ramgarh", "Medininagar"],
            "Karnataka": ["Bangalore", "Mysore", "Hubli", "Mangalore", "Belgaum", "Gulbarga", "Davanagere", "Bellary", "Bijapur", "Shimoga", "Tumkur", "Raichur", "Bidar", "Hospet", "Gadag", "Udupi", "Bhadravati", "Hassan", "Kolar", "Mandya", "Chikmagalur", "Karwar", "Ranebennuru", "Gangavati", "Chitradurga", "Puttur", "Koppal", "Bagalkot", "Haveri", "Sirsi", "Sindhanur", "Kampli", "Kushtagi", "Bunts", "Kundapura", "Bantwal", "Sullia", "Puttur", "Madikeri", "Kushalnagar", "Virajpet", "Somwarpet", "Chikkaballapur", "Doddaballapur", "Hoskote", "Anekal"],
            "Kerala": ["Thiruvananthapuram", "Kochi", "Kozhikode", "Thrissur", "Kollam", "Palakkad", "Alappuzha", "Malappuram", "Kannur", "Kasaragod"],
            "Madhya Pradesh": ["Bhopal", "Indore", "Gwalior", "Jabalpur", "Ujjain", "Sagar", "Dewas", "Satna", "Ratlam", "Rewa"],
            "Maharashtra": ["Mumbai", "Pune", "Nagpur", "Thane", "Nashik", "Aurangabad", "Solapur", "Amravati", "Kolhapur", "Sangli", "Navi Mumbai", "Kalyan", "Vasai", "Virar", "Bhiwandi", "Ahmednagar", "Latur", "Dhule", "Akola", "Satara", "Chandrapur", "Jalgaon", "Parbhani", "Jalna", "Bhusawal", "Nanded", "Warangal", "Ichalkaranji", "Panvel", "Ambernath", "Malegaon", "Mira-Bhayandar", "Ulhasnagar", "Dombivli", "Raigad", "Baramati", "Osmanabad", "Beed", "Gondia", "Wardha", "Yavatmal", "Buldhana", "Washim", "Hingoli", "Gadchiroli", "Sindhudurg", "Ratnagiri"],
            "Manipur": ["Imphal", "Thoubal", "Bishnupur", "Churachandpur", "Kakching", "Ukhrul", "Senapati", "Tamenglong", "Jiribam", "Pherzawl"],
            "Meghalaya": ["Shillong", "Tura", "Jowai", "Nongpoh", "Baghmara", "Ampati", "Resubelpara", "Nongstoin", "Mawkyrwat", "Williamnagar"],
            "Mizoram": ["Aizawl", "Lunglei", "Saiha", "Champhai", "Kolasib", "Serchhip", "Mamit", "Lawngtlai", "Saitual", "Khawzawl"],
            "Nagaland": ["Kohima", "Dimapur", "Mokokchung", "Tuensang", "Wokha", "Zunheboto", "Phek", "Kiphire", "Longleng", "Peren"],
            "Odisha": ["Bhubaneswar", "Cuttack", "Rourkela", "Berhampur", "Sambalpur", "Puri", "Balasore", "Bhadrak", "Baripada", "Jharsuguda"],
            "Punjab": ["Ludhiana", "Amritsar", "Jalandhar", "Patiala", "Bathinda", "Mohali", "Firozpur", "Batala", "Pathankot", "Moga"],
            "Rajasthan": ["Jaipur", "Jodhpur", "Kota", "Bikaner", "Ajmer", "Udaipur", "Bhilwara", "Alwar", "Bharatpur", "Sikar", "Tonk", "Sawai Madhopur", "Pali", "Barmer", "Jhunjhunu", "Dausa", "Churu", "Ganganagar", "Hanumangarh", "Jaisalmer", "Jalore", "Jhalawar", "Karauli", "Nagaur", "Pratapgarh", "Rajsamand", "Sirohi", "Dungarpur", "Banswara", "Bundi", "Chittorgarh", "Dholpur", "Mount Abu", "Pushkar", "Mandawa", "Neemrana", "Kishangarh", "Makrana", "Didwana", "Ratangarh", "Sujangarh", "Taranagar", "Nokha", "Dungargarh", "Bikaner", "Deshnoke"],
            "Sikkim": ["Gangtok", "Namchi", "Geyzing", "Mangan", "Jorethang", "Nayabazar", "Rangpo", "Singtam", "Rabongla", "Gyalshing"],
            "Tamil Nadu": ["Chennai", "Coimbatore", "Madurai", "Tiruchirappalli", "Salem", "Tirunelveli", "Tiruppur", "Vellore", "Erode", "Thoothukkudi", "Dindigul", "Thanjavur", "Ranipet", "Sivakasi", "Karur", "Udhagamandalam", "Hosur", "Nagercoil", "Kanchipuram", "Kumarakonam", "Pudukkottai", "Ambur", "Pallavaram", "Tambaram", "Avadi", "Tiruvottiyur", "Tiruchengode", "Pollachi", "Rajapalayam", "Gudiyatham", "Vaniyambadi", "Ambattur", "Manachanallur", "Kovilpatti", "Tindivanam", "Tiruvannamalai", "Pollachi", "Karaikudi", "Kumbakonam", "Mayiladuthurai", "Cuddalore", "Chidambaram", "Tiruvarur", "Ramanathapuram", "Virudhunagar", "Aruppukkottai", "Sivaganga"],
            "Telangana": ["Hyderabad", "Warangal", "Nizamabad", "Khammam", "Karimnagar", "Ramagundam", "Mahbubnagar", "Nalgonda", "Adilabad", "Suryapet"],
            "Tripura": ["Agartala", "Dharmanagar", "Udaipur", "Kailashahar", "Belonia", "Khowai", "Pratapgarh", "Ranir Bazar", "Sonamura", "Amarpur"],
            "Uttar Pradesh": ["Lucknow", "Kanpur", "Ghaziabad", "Agra", "Varanasi", "Meerut", "Allahabad", "Bareilly", "Aligarh", "Moradabad", "Saharanpur", "Gorakhpur", "Noida", "Firozabad", "Jhansi", "Muzaffarnagar", "Mathura", "Budaun", "Rampur", "Shahjahanpur", "Farrukhabad", "Mau", "Hapur", "Etawah", "Mirzapur", "Bulandshahr", "Sambhal", "Amroha", "Hardoi", "Fatehpur", "Raebareli", "Orai", "Sitapur", "Bahraich", "Modinagar", "Unnao", "Jaunpur", "Lakhimpur", "Hathras", "Banda", "Pilibhit", "Barabanki", "Khurja", "Gonda", "Mainpuri", "Lalitpur", "Etah", "Deoria", "Ujhani", "Ghazipur", "Sultanpur", "Azamgarh", "Bijnor", "Sahaswan", "Basti", "Chandausi", "Akbarpur", "Ballia", "Tanda", "Greater Noida", "Shikohabad", "Shamli", "Awagarh", "Kasganj"],
            "Uttarakhand": ["Dehradun", "Haridwar", "Roorkee", "Haldwani", "Rudrapur", "Kashipur", "Rishikesh", "Kotdwar", "Ramnagar", "Manglaur"],
            "West Bengal": ["Kolkata", "Howrah", "Durgapur", "Asansol", "Siliguri", "Malda", "Bardhaman", "Baharampur", "Habra", "Kharagpur"],
            "Delhi": ["New Delhi", "Delhi Cantonment", "Narela", "Najafgarh", "Alipur", "Mehrauli", "Karol Bagh", "Dwarka", "Rohini", "Janakpuri"],
            "Jammu and Kashmir": ["Srinagar", "Jammu", "Baramulla", "Anantnag", "Sopore", "KathuaUdhampur", "Punch", "Rajauri", "Kupwara"],
            "Ladakh": ["Leh", "Kargil", "Nubra", "Zanskar", "Drass", "Khaltse", "Nyoma", "Durbuk", "Tangtse", "Chushul"],
            "Puducherry": ["Puducherry", "Karaikal", "Yanam", "Mahe", "Villianur", "Ariyankuppam", "Mannadipet", "Bahour", "Nettapakkam", "Kirumampakkam"],
            "Chandigarh": ["Chandigarh"],
            "Andaman and Nicobar Islands": ["Port Blair", "Bamboo Flat", "Garacharma", "Dignabad", "Ferrargunj", "Rangat", "Mayabunder", "Diglipur", "Car Nicobar", "Nancowry"],
            "Dadra and Nagar Haveli and Daman and Diu": ["Daman", "Diu", "Silvassa", "Naroli", "Dadra", "Nagar Haveli", "Khanvel", "Samarvarni", "Dudhani", "Kilvani"],
            "Lakshadweep": ["Kavaratti", "Agatti", "Minicoy", "Amini", "Andrott", "Kalpeni", "Kadmat", "Kiltan", "Chetlat", "Bitra"]
        };

        // Address Management Functions
        window.openAddressModal = function() {
            document.getElementById('addressModal').style.display = 'flex';
            loadUserAddressInModal();
        }

        window.closeAddressModal = function() {
            document.getElementById('addressModal').style.display = 'none';
        }

        window.openTermsModal = function() {
            console.log('Opening Terms Modal');
            document.getElementById('termsModal').style.display = 'flex';
        }

        window.closeTermsModal = function() {
            console.log('Closing Terms Modal');
            document.getElementById('termsModal').style.display = 'none';
        }

        window.openFAQModal = function() {
            console.log('Opening FAQ Modal');
            document.getElementById('faqModal').style.display = 'flex';
        }

        window.closeFAQModal = function() {
            console.log('Closing FAQ Modal');
            document.getElementById('faqModal').style.display = 'none';
        }

        window.openPrivacyModal = function() {
            console.log('Opening Privacy Modal');
            document.getElementById('privacyModal').style.display = 'flex';
        }

        window.closePrivacyModal = function() {
            console.log('Closing Privacy Modal');
            document.getElementById('privacyModal').style.display = 'none';
        }

        window.copyContactNumber = function() {
            const contactNumber = '+91 8218864803';
            navigator.clipboard.writeText(contactNumber).then(() => {
                showNotification('Contact number copied! 📋', 'success');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showNotification('Failed to copy number', 'error');
            });
        }

        // Function to load user address in modal
        async function loadUserAddressInModal() {
            try {
                await loadUserAddressFromFirebase();
                
                if (userAddressData) {
                    // Fill form fields with saved data
                    document.getElementById('userPhone').value = userAddressData.phone || '';
                    document.getElementById('userState').value = userAddressData.state || '';
                    document.getElementById('userCity').value = userAddressData.city || '';
                    document.getElementById('userAddress').value = userAddressData.address || '';
                    document.getElementById('userPincode').value = userAddressData.pincode || '';
                    document.getElementById('userNearby').value = userAddressData.nearby || '';
                    
                    // Update city options based on selected state
                    if (userAddressData.state) {
                        updateCityOptions(userAddressData.state);
                        // Set city after options are populated
                        setTimeout(() => {
                            document.getElementById('userCity').value = userAddressData.city || '';
                        }, 100);
                    }
                    
                    // Show current address display
                    document.getElementById('displayState').textContent = userAddressData.state || 'Not set';
                    document.getElementById('displayCity').textContent = userAddressData.city || 'Not set';
                    document.getElementById('displayAddress').textContent = userAddressData.address || 'Not set';
                    document.getElementById('displayPincode').textContent = userAddressData.pincode || 'Not set';
                    document.getElementById('displayPhone').textContent = userAddressData.phone || 'Not set';
                    document.getElementById('displayNearby').textContent = userAddressData.nearby || 'Not set';
                    
                    document.getElementById('currentAddressDisplay').style.display = 'block';
                } else {
                    // Hide current address display if no data
                    document.getElementById('currentAddressDisplay').style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading address in modal:', error);
                document.getElementById('currentAddressDisplay').style.display = 'none';
            }
        }

        // Function to load address in profile section
        async function loadAddressInProfileSection() {
            try {
                await loadUserAddressFromFirebase();
                
                // Check if elements exist before updating
                const stateEl = document.getElementById('profileDisplayState');
                const cityEl = document.getElementById('profileDisplayCity');
                const pincodeEl = document.getElementById('profileDisplayPincode');
                const addressEl = document.getElementById('profileDisplayAddress');
                const nearbyEl = document.getElementById('profileDisplayNearby');
                const displayEl = document.getElementById('profileAddressDisplay');
                
                if (!stateEl || !cityEl || !pincodeEl || !addressEl || !nearbyEl || !displayEl) {
                    console.log('Profile address elements not found, skipping update');
                    return;
                }
                
                if (userAddressData) {
                    // Show address details in profile section (without phone)
                    stateEl.textContent = userAddressData.state || 'Not set';
                    cityEl.textContent = userAddressData.city || 'Not set';
                    pincodeEl.textContent = userAddressData.pincode || 'Not set';
                    addressEl.textContent = userAddressData.address || 'Not set';
                    nearbyEl.textContent = userAddressData.nearby || 'Not set';
                    
                    displayEl.style.display = 'block';
                } else {
                    // Hide address display if no data
                    displayEl.style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading address in profile section:', error);
                const displayEl = document.getElementById('profileAddressDisplay');
                if (displayEl) {
                    displayEl.style.display = 'none';
                }
            }
        }

        window.saveUserAddress = async function() {
            const phone = document.getElementById('userPhone').value.trim();
            const state = document.getElementById('userState').value.trim();
            const city = document.getElementById('userCity').value.trim();
            const address = document.getElementById('userAddress').value.trim();
            const pincode = document.getElementById('userPincode').value.trim();
            const nearby = document.getElementById('userNearby').value.trim();
            
            // Validation
            if (!phone || !state || !city || !address || !pincode) {
                showNotification('Please fill in all required fields (Phone, State, City, Address, Pincode)', 'warning');
                return;
            }
            
            // Validate phone number format (10 digits)
            if (!/^\d{10}$/.test(phone)) {
                showNotification('Please enter a valid 10-digit phone number', 'warning');
                return;
            }
            
            // Validate pincode format (6 digits)
            if (!/^\d{6}$/.test(pincode)) {
                showNotification('Please enter a valid 6-digit pincode', 'warning');
                return;
            }
            
            const addressData = {
                phone: phone,
                state: state,
                city: city,
                address: address,
                pincode: pincode,
                nearby: nearby
            };
            
            const success = await saveUserAddressToFirebase(addressData);
            if (success) {
                userAddressData = addressData;
                showNotification('Address saved successfully! 📍', 'success');
                closeAddressModal();
                displayCurrentAddress();
                // Update profile section address display only if profile is active
                setTimeout(() => {
                    loadAddressInProfileSection();
                }, 100);
            } else {
                showNotification('Error saving address. Please try again.', 'error');
            }
        };

        function loadCurrentAddress() {
            if (userAddressData) {
                const stateSelect = document.getElementById('userState');
                const citySelect = document.getElementById('userCity');
                
                document.getElementById('userPhone').value = userAddressData.phone || '';
                stateSelect.value = userAddressData.state || '';
                
                // Load cities for the selected state
                if (userAddressData.state) {
                    updateCityOptions(userAddressData.state);
                    citySelect.value = userAddressData.city || '';
                }
                
                document.getElementById('userAddress').value = userAddressData.address || '';
                document.getElementById('userPincode').value = userAddressData.pincode || '';
                document.getElementById('userNearby').value = userAddressData.nearby || '';
                displayCurrentAddress();
            }
        }

        // Update city options based on selected state
        function updateCityOptions(selectedState) {
            const citySelect = document.getElementById('userCity');
            citySelect.innerHTML = '<option value="">Select City</option>';
            
            if (selectedState && stateCityMap[selectedState]) {
                stateCityMap[selectedState].forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            }
        }

        function displayCurrentAddress() {
            const displayDiv = document.getElementById('currentAddressDisplay');
            const displayPhone = document.getElementById('displayPhone');
            const displayState = document.getElementById('displayState');
            const displayCity = document.getElementById('displayCity');
            const displayAddress = document.getElementById('displayAddress');
            const displayPincode = document.getElementById('displayPincode');
            const displayNearby = document.getElementById('displayNearby');

            // Profile address display
            const profileDisplayDiv = document.getElementById('profileAddressDisplay');
            const profileDisplayPhone = document.getElementById('profileDisplayPhone');
            const profileDisplayState = document.getElementById('profileDisplayState');
            const profileDisplayCity = document.getElementById('profileDisplayCity');
            const profileDisplayAddress = document.getElementById('profileDisplayAddress');
            const profileDisplayPincode = document.getElementById('profileDisplayPincode');
            const profileDisplayNearby = document.getElementById('profileDisplayNearby');

            if (userAddressData && (userAddressData.phone || userAddressData.state || userAddressData.city || userAddressData.address)) {
                // Modal display
                if (displayDiv) {
                    displayDiv.style.display = 'block';
                    if (displayPhone) displayPhone.textContent = `Phone: ${userAddressData.phone || 'Not provided'}`;
                    if (displayState) displayState.textContent = `State: ${userAddressData.state || 'Not provided'}`;
                    if (displayCity) displayCity.textContent = `City: ${userAddressData.city || 'Not provided'}`;
                    if (displayAddress) displayAddress.textContent = `Address: ${userAddressData.address || 'Not provided'}`;
                    if (displayPincode) displayPincode.textContent = `Pincode: ${userAddressData.pincode || 'Not provided'}`;
                    if (displayNearby) displayNearby.textContent = `Nearby: ${userAddressData.nearby || 'Not provided'}`;
                }

                // Profile display
                if (profileDisplayDiv) {
                    profileDisplayDiv.style.display = 'block';
                    if (profileDisplayPhone) profileDisplayPhone.textContent = userAddressData.phone || 'Not provided';
                    if (profileDisplayState) profileDisplayState.textContent = userAddressData.state || 'Not provided';
                    if (profileDisplayCity) profileDisplayCity.textContent = userAddressData.city || 'Not provided';
                    if (profileDisplayAddress) profileDisplayAddress.textContent = userAddressData.address || 'Not provided';
                    if (profileDisplayPincode) profileDisplayPincode.textContent = userAddressData.pincode || 'Not provided';
                    if (profileDisplayNearby) profileDisplayNearby.textContent = userAddressData.nearby || 'Not provided';
                }
            } else {
                if (displayDiv) displayDiv.style.display = 'none';
                if (profileDisplayDiv) profileDisplayDiv.style.display = 'none';
            }
        }

        // Cart functionality and form handlers
        document.addEventListener('DOMContentLoaded', async function() {
            await loadData(); // Load data from Firebase and localStorage
            
            // Add event listener for state selection
            const stateSelect = document.getElementById('userState');
            if (stateSelect) {
                stateSelect.addEventListener('change', function() {
                    const selectedState = this.value;
                    updateCityOptions(selectedState);
                });
            }
            
            const cartBtn = document.querySelector('.cart-btn');
            if (cartBtn) {
                cartBtn.addEventListener('click', function() {
                    showNotification('Cart functionality is already implemented! 🛒', 'info');
                });
            }
            
            // Add form event listeners
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            if (loginForm) {
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const emailOrPhone = document.getElementById('loginEmailOrPhone').value.trim();
                    const password = document.getElementById('loginPassword').value;
                    
                    if (!emailOrPhone || !password) {
                        showNotification('Please fill in all fields', 'error');
                        return;
                    }
                    
                    await loginWithEmailOrPhone(emailOrPhone, password);
                });
            }
            
            if (registerForm) {
                registerForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const name = document.getElementById('registerName').value.trim();
                    const email = document.getElementById('registerEmail').value.trim();
                    const phone = document.getElementById('registerPhone').value.trim();
                    const password = document.getElementById('registerPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    // Validation
                    if (!name || !email || !phone || !password || !confirmPassword) {
                        showNotification('Please fill in all fields', 'error');
                        return;
                    }
                    
                    if (password.length < 6) {
                        showNotification('Password must be at least 6 characters', 'error');
                        return;
                    }
                    
                    if (password !== confirmPassword) {
                        showNotification('Passwords do not match', 'error');
                        return;
                    }
                    
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(email)) {
                        showNotification('Please enter a valid email address', 'error');
                        return;
                    }
                    
                    const phoneRegex = /^[0-9]{10}$/;
                    if (!phoneRegex.test(phone)) {
                        showNotification('Please enter a valid 10-digit phone number', 'error');
                        return;
                    }
                    
                    await registerWithEmailAndPhone(name, email, phone, password);
                });
            }
            
            // Initialize slideshow when page loads
            setTimeout(() => {
                updateSlideshow();
            }, 500);
        });
        // Global orders data
        let globalOrdersData = [];
        
        // Invoice Modal Functions
        window.showInvoice = async function(orderId) {
            // If no orders loaded, try to load them first
            if (globalOrdersData.length === 0) {
                try {
                    const orders = await loadOrdersFromFirebase();
                    globalOrdersData = orders;
                } catch (error) {
                    console.error('Error loading orders:', error);
                    alert('Error loading order data');
                    return;
                }
            }
            
            const order = globalOrdersData.find(o => o.id === orderId);
            if (!order) {
                alert('Order not found');
                return;
            }
            
            const invoiceModal = document.getElementById('invoiceModal');
            const invoiceContent = document.getElementById('invoiceContent');
            const printBtn = document.getElementById('printInvoiceBtn');
            
            // Generate invoice content
            invoiceContent.innerHTML = generateInvoiceHTML(order);
            
            // Show print button only on desktop (screen width > 768px)
            if (window.innerWidth > 768) {
                printBtn.style.display = 'block';
            } else {
                printBtn.style.display = 'none';
            }
            
            // Show modal
            invoiceModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        };
        
        window.closeInvoice = function() {
            const invoiceModal = document.getElementById('invoiceModal');
            invoiceModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        };
        
        window.printInvoice = function() {
            const printContent = document.getElementById('invoiceContent').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = `
                <div style="padding: 20px; font-family: Arial, sans-serif;">
                    ${printContent}
                </div>
            `;
            
            window.print();
            location.reload();
        };

        function generateInvoiceHTML(order) {
            // Fix date handling - use current date if timestamp is invalid
            let orderDate;
            try {
                if (order.timestamp) {
                    orderDate = new Date(order.timestamp).toLocaleDateString('en-IN', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                } else {
                    orderDate = new Date().toLocaleDateString('en-IN', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }
            } catch (error) {
                orderDate = new Date().toLocaleDateString('en-IN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            
            let itemsHTML = '';
            let totalAmount = 0;
            
            // Handle different order data structures
            const orderItems = order.items || order.products || [];
            
            if (orderItems.length === 0) {
                // If no items array, try to create from single product data
                if (order.productName || order.name) {
                    const singleItem = {
                        name: order.productName || order.name || 'Product',
                        price: order.productPrice || order.price || order.totalAmount || 0,
                        quantity: order.quantity || 1,
                        image: order.productImage || order.image || null
                    };
                    orderItems.push(singleItem);
                }
            }
            
            orderItems.forEach(item => {
                const itemPrice = item.price || item.productPrice || 0;
                const itemQuantity = item.quantity || 1;
                const itemTotal = itemPrice * itemQuantity;
                totalAmount += itemTotal;
                
                // Handle product image with better fallback
                let productImageHTML = '';
                const productImage = item.image || item.productImage;
                
                if (productImage && productImage !== 'null' && productImage !== '') {
                    productImageHTML = `<img src="${productImage}" alt="Product" style="width: 30px; height: 30px; border-radius: 4px; object-fit: cover; margin-right: 8px;" onerror="this.style.display='none'">`;
                }
                
                itemsHTML += `
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: left; font-size: 13px;">
                            <div style="display: flex; align-items: center;">
                                ${productImageHTML}
                                <span>${item.name || item.productName || 'Product'}</span>
                            </div>
                        </td>
                        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center; font-size: 13px;">₹${itemPrice}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center; font-size: 13px;">${itemQuantity}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: right; font-weight: 600; font-size: 13px;">₹${itemTotal}</td>
                    </tr>
                `;
            });
            
            // Fallback to order total if items calculation fails
            if (totalAmount === 0 && order.totalAmount) {
                totalAmount = order.totalAmount;
            }
            
            // Use the same delivery charge field as shown in order card
            let deliveryCharges = 'FREE';
            let deliveryAmount = 0;
            
            // Match the exact field used in order card display: order.deliveryCharge
            // Multiply by quantity like in order card
            if (order.deliveryCharge && order.deliveryCharge !== 'FREE' && order.deliveryCharge !== 0) {
                const baseDeliveryCharge = parseFloat(order.deliveryCharge);
                const quantity = order.quantity || 1;
                deliveryAmount = baseDeliveryCharge * quantity;
                deliveryCharges = deliveryAmount;
            }
            
            const finalTotal = totalAmount + deliveryAmount;
            
            return `
                <div style="background: white; padding: 20px; max-width: 600px; margin: 0 auto;">
                    <!-- Header with Logo -->
                    <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 15px;">
                        <img src="logo.png" alt="Zupisupi Logo" style="height: 50px; width: auto; margin-bottom: 10px;" onerror="this.style.display='none'">
                        <h1 style="color: #2c3e50; margin: 0; font-size: 24px; font-weight: 700;">INVOICE BILL</h1>
                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 14px;">Zupisupi E-commerce</p>
                    </div>
                    
                    <!-- Invoice Details -->
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <h3 style="color: #2c3e50; margin: 0 0 8px 0; font-size: 16px;">Invoice Details</h3>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Invoice #:</strong> INV-${order.id.substring(0, 8).toUpperCase()}</p>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Order ID:</strong> ${order.id}</p>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Date:</strong> ${orderDate}</p>
                        </div>
                        
                        <div style="flex: 1; min-width: 200px; text-align: right;">
                            <h3 style="color: #2c3e50; margin: 0 0 8px 0; font-size: 16px;">Customer Details</h3>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Name:</strong> ${order.userName || 'N/A'}</p>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Email:</strong> ${order.userEmail || 'N/A'}</p>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Phone:</strong> ${order.userPhone || 'N/A'}</p>
                            <p style="margin: 3px 0; color: #555; font-size: 13px;"><strong>Address:</strong> ${order.userAddress || 'N/A'}</p>
                        </div>
                    </div>
                    
                    <!-- Items Table -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #2c3e50; margin: 0 0 10px 0; font-size: 16px;">Order Items</h3>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; border-radius: 6px; overflow: hidden;">
                            <thead>
                                <tr style="background: #f8f9fa;">
                                    <th style="padding: 10px; text-align: left; color: #2c3e50; font-weight: 600; border-bottom: 1px solid #ddd; font-size: 13px;">Item</th>
                                    <th style="padding: 10px; text-align: center; color: #2c3e50; font-weight: 600; border-bottom: 1px solid #ddd; font-size: 13px;">Price</th>
                                    <th style="padding: 10px; text-align: center; color: #2c3e50; font-weight: 600; border-bottom: 1px solid #ddd; font-size: 13px;">Qty</th>
                                    <th style="padding: 10px; text-align: right; color: #2c3e50; font-weight: 600; border-bottom: 1px solid #ddd; font-size: 13px;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${itemsHTML}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Total Section -->
                    <div style="text-align: right; margin-bottom: 20px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; display: inline-block; min-width: 200px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #555; font-size: 13px;">Subtotal:</span>
                                <span style="font-weight: 600; color: #2c3e50; font-size: 13px;">₹${totalAmount}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #555; font-size: 13px;">Delivery Charges:</span>
                                <span style="font-weight: 600; color: #27ae60; font-size: 13px;">${deliveryCharges === 'FREE' ? 'FREE' : '₹' + deliveryCharges}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding-top: 8px; border-top: 1px solid #3498db;">
                                <span style="font-size: 15px; font-weight: 700; color: #2c3e50;">Grand Total:</span>
                                <span style="font-size: 15px; font-weight: 700; color: #27ae60;">₹${finalTotal}</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Footer -->
                    <div style="text-align: center; padding-top: 15px; border-top: 1px solid #ecf0f1; color: #7f8c8d;">
                        <p style="margin: 3px 0; font-size: 12px;">Thank you for shopping with Zupisupi!</p>
                        <p style="margin: 3px 0; font-size: 11px;">For any queries, contact us at support@zupisupi.com</p>
                        <p style="margin: 10px 0 0 0; font-size: 9px; color: #bdc3c7;">This is a computer generated invoice and does not require signature.</p>
                    </div>
                </div>
            `;
        }
    </script>
    
    <!-- Invoice Modal -->
    <div id="invoiceModal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); z-index: 10000; align-items: center; justify-content: center; padding: 0; box-sizing: border-box;">
        <div style="position: relative; background: white; width: 100%; height: 100%; overflow-y: auto;">
            <!-- Modal Header -->
            <div style="position: sticky; top: 0; background: white; padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; z-index: 1;">
                <h2 style="margin: 0; color: #2c3e50; font-size: 20px;">Invoice Bill</h2>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <!-- Print button - only visible on desktop -->
                    <button id="printInvoiceBtn" onclick="printInvoice()" style="background: #27ae60; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; display: none;">
                        🖨️ Print
                    </button>
                    <button onclick="closeInvoice()" style="background: #e74c3c; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600; transition: all 0.3s ease;">
                        ✕
                    </button>
                </div>
            </div>
            
            <!-- Modal Content -->
            <div id="invoiceContent" style="padding: 20px; height: calc(100vh - 70px); overflow-y: auto;">
                <!-- Invoice content will be generated here -->
            </div>
        </div>
    </div>
</body>
</html>
